1448023202c694c927b3790ebfc8f64c
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = testSaga;

var _lodash = _interopRequireDefault(require("lodash.isequal"));

var _objectAssign = _interopRequireDefault(require("object-assign"));

var effects = _interopRequireWildcard(require("redux-saga/effects"));

var _reduxSaga = require("redux-saga");

var _historyTypes = require("./historyTypes");

var _keys = require("../shared/keys");

var _SagaTestError = _interopRequireDefault(require("../shared/SagaTestError"));

var _createErrorMessage = _interopRequireDefault(require("./createErrorMessage"));

var _assertSameEffect = _interopRequireDefault(require("./assertSameEffect"));

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function testSaga(saga) {
  var api = {
    next: next,
    back: back,
    finish: finish,
    restart: restart,
    save: save,
    restore: restore,
    throw: throwError
  };
  var savePoints = {};
  var history = [];

  for (var _len = arguments.length, sagaArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    sagaArgs[_key - 1] = arguments[_key];
  }

  var finalSagaArgs = sagaArgs;
  var iterator = createIterator();

  function createEffectTester(name, key, effect) {
    var isForkedEffect = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    return function (yieldedValue) {
      return function () {
        (0, _assertSameEffect.default)(_reduxSaga.eventChannel, name, key, isForkedEffect, yieldedValue, effect.apply(void 0, arguments), history.length);
        return api;
      };
    };
  }

  function createEffectTesterFromEffects(name, key) {
    return createEffectTester(name, key, effects[name]);
  }

  function createEffectTesterFromHelperEffect(name) {
    return createEffectTester(name, undefined, effects[name], true);
  }

  var effectsTestersCreators = {
    actionChannel: createEffectTesterFromEffects('actionChannel', _keys.ACTION_CHANNEL),
    all: createEffectTesterFromEffects('all', _keys.ALL),
    apply: createEffectTesterFromEffects('apply', _keys.CALL),
    call: createEffectTesterFromEffects('call', _keys.CALL),
    cancel: createEffectTesterFromEffects('cancel', _keys.CANCEL),
    cancelled: createEffectTesterFromEffects('cancelled', _keys.CANCELLED),
    cps: createEffectTesterFromEffects('cps', _keys.CPS),
    debounce: createEffectTesterFromHelperEffect('debounce'),
    delay: createEffectTesterFromEffects('delay', _keys.CALL),
    flush: createEffectTesterFromEffects('flush', _keys.FLUSH),
    fork: createEffectTesterFromEffects('fork', _keys.FORK),
    getContext: createEffectTesterFromEffects('getContext', _keys.GET_CONTEXT),
    join: createEffectTesterFromEffects('join', _keys.JOIN),
    put: createEffectTesterFromEffects('put', _keys.PUT),
    putResolve: createEffectTesterFromEffects('putResolve', _keys.PUT),
    race: createEffectTesterFromEffects('race', _keys.RACE),
    select: createEffectTesterFromEffects('select', _keys.SELECT),
    setContext: createEffectTesterFromEffects('setContext', _keys.SET_CONTEXT),
    spawn: createEffectTesterFromEffects('spawn', _keys.FORK),
    take: createEffectTesterFromEffects('take', _keys.TAKE),
    takeEvery: createEffectTesterFromHelperEffect('takeEvery'),
    takeLatest: createEffectTesterFromHelperEffect('takeLatest'),
    takeLeading: createEffectTesterFromHelperEffect('takeLeading'),
    takeMaybe: createEffectTesterFromEffects('takeMaybe', _keys.TAKE),
    throttle: createEffectTesterFromHelperEffect('throttle'),
    retry: createEffectTesterFromHelperEffect('retry'),
    isDone: function isDone(done) {
      return function () {
        if (!done) {
          throw new _SagaTestError.default('saga not done');
        }

        return api;
      };
    },
    is: function is(value) {
      return function (arg) {
        if (!(0, _lodash.default)(arg, value)) {
          var errorMessage = (0, _createErrorMessage.default)('yielded values do not match', history.length, value, arg);
          throw new _SagaTestError.default(errorMessage);
        }

        return api;
      };
    },
    inspect: function inspect(value) {
      return function (fn) {
        fn(value);
        return api;
      };
    },
    returns: function returns(value, done) {
      return function (arg) {
        if (!done) {
          throw new _SagaTestError.default('saga not done');
        }

        if (!(0, _lodash.default)(arg, value)) {
          var errorMessage = (0, _createErrorMessage.default)('returned values do not match', history.length, value, arg);
          throw new _SagaTestError.default(errorMessage);
        }

        return api;
      };
    }
  };

  function createIterator() {
    return saga.apply(void 0, (0, _toConsumableArray2.default)(finalSagaArgs));
  }

  function apiWithEffectsTesters(_ref) {
    var value = _ref.value,
        done = _ref.done;
    var newApi = (0, _objectAssign.default)({}, api, {
      actionChannel: effectsTestersCreators.actionChannel(value),
      all: effectsTestersCreators.all(value),
      apply: effectsTestersCreators.apply(value),
      call: effectsTestersCreators.call(value),
      cancel: effectsTestersCreators.cancel(value),
      cancelled: effectsTestersCreators.cancelled(value),
      cps: effectsTestersCreators.cps(value),
      debounce: effectsTestersCreators.debounce(value),
      delay: effectsTestersCreators.delay(value),
      flush: effectsTestersCreators.flush(value),
      fork: effectsTestersCreators.fork(value),
      getContext: effectsTestersCreators.getContext(value),
      join: effectsTestersCreators.join(value),
      put: effectsTestersCreators.put(value),
      putResolve: effectsTestersCreators.putResolve(value),
      race: effectsTestersCreators.race(value),
      select: effectsTestersCreators.select(value),
      setContext: effectsTestersCreators.setContext(value),
      spawn: effectsTestersCreators.spawn(value),
      take: effectsTestersCreators.take(value),
      takeEvery: effectsTestersCreators.takeEvery(value),
      takeLatest: effectsTestersCreators.takeLatest(value),
      takeLeading: effectsTestersCreators.takeLeading(value),
      takeMaybe: effectsTestersCreators.takeMaybe(value),
      throttle: effectsTestersCreators.throttle(value),
      retry: effectsTestersCreators.retry(value),
      is: effectsTestersCreators.is(value),
      inspect: effectsTestersCreators.inspect(value),
      isDone: effectsTestersCreators.isDone(done),
      returns: effectsTestersCreators.returns(value, done)
    });
    return newApi;
  }

  function restart() {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    if (args.length > 0) {
      finalSagaArgs = args;
    }

    history = [];
    iterator = createIterator();
    return api;
  }

  function next() {
    var arg = arguments.length <= 0 ? undefined : arguments[0];
    var result;

    if (arguments.length === 0) {
      history.push({
        type: _historyTypes.NONE
      });
      result = iterator.next();
    } else {
      history.push({
        type: _historyTypes.ARGUMENT,
        value: arg
      });
      result = iterator.next(arg);
    }

    return apiWithEffectsTesters(result);
  }

  function finish() {
    var arg = arguments.length <= 0 ? undefined : arguments[0];
    var result;

    if (arguments.length === 0) {
      history.push({
        type: _historyTypes.FINISH
      });
      result = iterator.return();
    } else {
      history.push({
        type: _historyTypes.FINISH_ARGUMENT,
        value: arg
      });
      result = iterator.return(arg);
    }

    return apiWithEffectsTesters(result);
  }

  function throwError(error) {
    history.push({
      type: _historyTypes.ERROR,
      value: error
    });
    var result = iterator.throw(error);
    return apiWithEffectsTesters(result);
  }

  function restore(name) {
    if (!savePoints[name]) {
      throw new Error("No such save point " + name);
    }

    iterator = createIterator();
    history = savePoints[name];
    return applyHistory();
  }

  function back() {
    var n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

    if (n > history.length) {
      throw new Error('Cannot go back any further');
    }

    var m = n;

    while (m--) {
      history.pop();
    }

    iterator = createIterator();
    return applyHistory();
  }

  function save(name) {
    savePoints[name] = history.slice(0);
    return api;
  }

  function applyHistory() {
    for (var i = 0, l = history.length; i < l; i++) {
      var arg = history[i];

      switch (arg.type) {
        case _historyTypes.NONE:
          iterator.next();
          break;

        case _historyTypes.ARGUMENT:
          iterator.next(arg.value);
          break;

        case _historyTypes.ERROR:
          iterator.throw(arg.value);
          break;

        case _historyTypes.FINISH:
          iterator.return();
          break;

        case _historyTypes.FINISH_ARGUMENT:
          iterator.return(arg.value);
          break;
      }
    }

    return api;
  }

  return api;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZGVmYXVsdCIsInRlc3RTYWdhIiwiX2xvZGFzaCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX29iamVjdEFzc2lnbiIsImVmZmVjdHMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl9yZWR1eFNhZ2EiLCJfaGlzdG9yeVR5cGVzIiwiX2tleXMiLCJfU2FnYVRlc3RFcnJvciIsIl9jcmVhdGVFcnJvck1lc3NhZ2UiLCJfYXNzZXJ0U2FtZUVmZmVjdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIldlYWtNYXAiLCJjYWNoZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJoYXMiLCJnZXQiLCJuZXdPYmoiLCJoYXNQcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkZXNjIiwic2V0Iiwic2FnYSIsImFwaSIsIm5leHQiLCJiYWNrIiwiZmluaXNoIiwicmVzdGFydCIsInNhdmUiLCJyZXN0b3JlIiwidGhyb3ciLCJ0aHJvd0Vycm9yIiwic2F2ZVBvaW50cyIsImhpc3RvcnkiLCJzYWdhQXJncyIsImZpbmFsU2FnYUFyZ3MiLCJpdGVyYXRvciIsImNyZWF0ZUl0ZXJhdG9yIiwiY3JlYXRlRWZmZWN0VGVzdGVyIiwibmFtZSIsImVmZmVjdCIsImlzRm9ya2VkRWZmZWN0IiwieWllbGRlZFZhbHVlIiwiZXZlbnRDaGFubmVsIiwibGVuZ3RoIiwiY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMiLCJjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tSGVscGVyRWZmZWN0IiwidW5kZWZpbmVkIiwiZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycyIsImFjdGlvbkNoYW5uZWwiLCJBQ1RJT05fQ0hBTk5FTCIsImFsbCIsIkFMTCIsImFwcGx5IiwiQ0FMTCIsImNhbmNlbCIsIkNBTkNFTCIsImNhbmNlbGxlZCIsIkNBTkNFTExFRCIsImNwcyIsIkNQUyIsImRlYm91bmNlIiwiZGVsYXkiLCJmbHVzaCIsIkZMVVNIIiwiZm9yayIsIkZPUksiLCJnZXRDb250ZXh0IiwiR0VUX0NPTlRFWFQiLCJqb2luIiwiSk9JTiIsInB1dCIsIlBVVCIsInB1dFJlc29sdmUiLCJyYWNlIiwiUkFDRSIsInNlbGVjdCIsIlNFTEVDVCIsInNldENvbnRleHQiLCJTRVRfQ09OVEVYVCIsInNwYXduIiwidGFrZSIsIlRBS0UiLCJ0YWtlRXZlcnkiLCJ0YWtlTGF0ZXN0IiwidGFrZUxlYWRpbmciLCJ0YWtlTWF5YmUiLCJ0aHJvdHRsZSIsInJldHJ5IiwiaXNEb25lIiwiZG9uZSIsImlzIiwiYXJnIiwiZXJyb3JNZXNzYWdlIiwiaW5zcGVjdCIsImZuIiwicmV0dXJucyIsImFwaVdpdGhFZmZlY3RzVGVzdGVycyIsIm5ld0FwaSIsImFyZ3MiLCJyZXN1bHQiLCJwdXNoIiwidHlwZSIsIk5PTkUiLCJBUkdVTUVOVCIsIkZJTklTSCIsInJldHVybiIsIkZJTklTSF9BUkdVTUVOVCIsImVycm9yIiwiRVJST1IiLCJFcnJvciIsImFwcGx5SGlzdG9yeSIsIm4iLCJtIiwicG9wIiwic2xpY2UiLCJpIiwibCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztBQUVBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQzNDQyxFQUFBQSxLQUFLLEVBQUU7QUFEb0MsQ0FBN0M7QUFHQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCQyxRQUFsQjs7QUFFQSxJQUFJQyxPQUFPLEdBQUdDLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsZ0JBQUQsQ0FBUixDQUFwQzs7QUFFQSxJQUFJQyxhQUFhLEdBQUdGLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsZUFBRCxDQUFSLENBQTFDOztBQUVBLElBQUlFLE9BQU8sR0FBR0MsdUJBQXVCLENBQUNILE9BQU8s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LCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB0ZXN0U2FnYTtcblxudmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2guaXNlcXVhbFwiKSk7XG5cbnZhciBfb2JqZWN0QXNzaWduID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwib2JqZWN0LWFzc2lnblwiKSk7XG5cbnZhciBlZmZlY3RzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcInJlZHV4LXNhZ2EvZWZmZWN0c1wiKSk7XG5cbnZhciBfcmVkdXhTYWdhID0gcmVxdWlyZShcInJlZHV4LXNhZ2FcIik7XG5cbnZhciBfaGlzdG9yeVR5cGVzID0gcmVxdWlyZShcIi4vaGlzdG9yeVR5cGVzXCIpO1xuXG52YXIgX2tleXMgPSByZXF1aXJlKFwiLi4vc2hhcmVkL2tleXNcIik7XG5cbnZhciBfU2FnYVRlc3RFcnJvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL3NoYXJlZC9TYWdhVGVzdEVycm9yXCIpKTtcblxudmFyIF9jcmVhdGVFcnJvck1lc3NhZ2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2NyZWF0ZUVycm9yTWVzc2FnZVwiKSk7XG5cbnZhciBfYXNzZXJ0U2FtZUVmZmVjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYXNzZXJ0U2FtZUVmZmVjdFwiKSk7XG5cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSgpIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGUgPSBuZXcgV2Vha01hcCgpOyBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWNoZTsgfTsgcmV0dXJuIGNhY2hlOyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDsgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgaWYgKGNhY2hlKSB7IGNhY2hlLnNldChvYmosIG5ld09iaik7IH0gcmV0dXJuIG5ld09iajsgfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiB0ZXN0U2FnYShzYWdhLCAuLi5zYWdhQXJncykge1xuICBjb25zdCBhcGkgPSB7XG4gICAgbmV4dCxcbiAgICBiYWNrLFxuICAgIGZpbmlzaCxcbiAgICByZXN0YXJ0LFxuICAgIHNhdmUsXG4gICAgcmVzdG9yZSxcbiAgICB0aHJvdzogdGhyb3dFcnJvclxuICB9O1xuICBjb25zdCBzYXZlUG9pbnRzID0ge307XG4gIGxldCBoaXN0b3J5ID0gW107XG4gIGxldCBmaW5hbFNhZ2FBcmdzID0gc2FnYUFyZ3M7XG4gIGxldCBpdGVyYXRvciA9IGNyZWF0ZUl0ZXJhdG9yKCk7XG5cbiAgZnVuY3Rpb24gY3JlYXRlRWZmZWN0VGVzdGVyKG5hbWUsIGtleSwgZWZmZWN0LCBpc0ZvcmtlZEVmZmVjdCA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIHlpZWxkZWRWYWx1ZSA9PiAoLi4uYXJncykgPT4ge1xuICAgICAgKDAsIF9hc3NlcnRTYW1lRWZmZWN0LmRlZmF1bHQpKF9yZWR1eFNhZ2EuZXZlbnRDaGFubmVsLCBuYW1lLCBrZXksIGlzRm9ya2VkRWZmZWN0LCB5aWVsZGVkVmFsdWUsIGVmZmVjdCguLi5hcmdzKSwgaGlzdG9yeS5sZW5ndGgpO1xuICAgICAgcmV0dXJuIGFwaTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMobmFtZSwga2V5KSB7XG4gICAgcmV0dXJuIGNyZWF0ZUVmZmVjdFRlc3RlcihuYW1lLCBrZXksIGVmZmVjdHNbbmFtZV0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUhlbHBlckVmZmVjdChuYW1lKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUVmZmVjdFRlc3RlcihuYW1lLCB1bmRlZmluZWQsIGVmZmVjdHNbbmFtZV0sIHRydWUpO1xuICB9XG5cbiAgY29uc3QgZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycyA9IHtcbiAgICBhY3Rpb25DaGFubmVsOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygnYWN0aW9uQ2hhbm5lbCcsIF9rZXlzLkFDVElPTl9DSEFOTkVMKSxcbiAgICBhbGw6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdhbGwnLCBfa2V5cy5BTEwpLFxuICAgIGFwcGx5OiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygnYXBwbHknLCBfa2V5cy5DQUxMKSxcbiAgICBjYWxsOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygnY2FsbCcsIF9rZXlzLkNBTEwpLFxuICAgIGNhbmNlbDogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ2NhbmNlbCcsIF9rZXlzLkNBTkNFTCksXG4gICAgY2FuY2VsbGVkOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygnY2FuY2VsbGVkJywgX2tleXMuQ0FOQ0VMTEVEKSxcbiAgICBjcHM6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdjcHMnLCBfa2V5cy5DUFMpLFxuICAgIGRlYm91bmNlOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tSGVscGVyRWZmZWN0KCdkZWJvdW5jZScpLFxuICAgIGRlbGF5OiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygnZGVsYXknLCBfa2V5cy5DQUxMKSxcbiAgICBmbHVzaDogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ2ZsdXNoJywgX2tleXMuRkxVU0gpLFxuICAgIGZvcms6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdmb3JrJywgX2tleXMuRk9SSyksXG4gICAgZ2V0Q29udGV4dDogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ2dldENvbnRleHQnLCBfa2V5cy5HRVRfQ09OVEVYVCksXG4gICAgam9pbjogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ2pvaW4nLCBfa2V5cy5KT0lOKSxcbiAgICBwdXQ6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdwdXQnLCBfa2V5cy5QVVQpLFxuICAgIHB1dFJlc29sdmU6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdwdXRSZXNvbHZlJywgX2tleXMuUFVUKSxcbiAgICByYWNlOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygncmFjZScsIF9rZXlzLlJBQ0UpLFxuICAgIHNlbGVjdDogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ3NlbGVjdCcsIF9rZXlzLlNFTEVDVCksXG4gICAgc2V0Q29udGV4dDogY3JlYXRlRWZmZWN0VGVzdGVyRnJvbUVmZmVjdHMoJ3NldENvbnRleHQnLCBfa2V5cy5TRVRfQ09OVEVYVCksXG4gICAgc3Bhd246IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCdzcGF3bicsIF9rZXlzLkZPUkspLFxuICAgIHRha2U6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21FZmZlY3RzKCd0YWtlJywgX2tleXMuVEFLRSksXG4gICAgdGFrZUV2ZXJ5OiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tSGVscGVyRWZmZWN0KCd0YWtlRXZlcnknKSxcbiAgICB0YWtlTGF0ZXN0OiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tSGVscGVyRWZmZWN0KCd0YWtlTGF0ZXN0JyksXG4gICAgdGFrZUxlYWRpbmc6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21IZWxwZXJFZmZlY3QoJ3Rha2VMZWFkaW5nJyksXG4gICAgdGFrZU1heWJlOiBjcmVhdGVFZmZlY3RUZXN0ZXJGcm9tRWZmZWN0cygndGFrZU1heWJlJywgX2tleXMuVEFLRSksXG4gICAgdGhyb3R0bGU6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21IZWxwZXJFZmZlY3QoJ3Rocm90dGxlJyksXG4gICAgcmV0cnk6IGNyZWF0ZUVmZmVjdFRlc3RlckZyb21IZWxwZXJFZmZlY3QoJ3JldHJ5JyksXG4gICAgaXNEb25lOiBkb25lID0+ICgpID0+IHtcbiAgICAgIGlmICghZG9uZSkge1xuICAgICAgICB0aHJvdyBuZXcgX1NhZ2FUZXN0RXJyb3IuZGVmYXVsdCgnc2FnYSBub3QgZG9uZScpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXBpO1xuICAgIH0sXG4gICAgaXM6IHZhbHVlID0+IGFyZyA9PiB7XG4gICAgICBpZiAoISgwLCBfbG9kYXNoLmRlZmF1bHQpKGFyZywgdmFsdWUpKSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9ICgwLCBfY3JlYXRlRXJyb3JNZXNzYWdlLmRlZmF1bHQpKCd5aWVsZGVkIHZhbHVlcyBkbyBub3QgbWF0Y2gnLCBoaXN0b3J5Lmxlbmd0aCwgdmFsdWUsIGFyZyk7XG4gICAgICAgIHRocm93IG5ldyBfU2FnYVRlc3RFcnJvci5kZWZhdWx0KGVycm9yTWVzc2FnZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhcGk7XG4gICAgfSxcbiAgICBpbnNwZWN0OiB2YWx1ZSA9PiBmbiA9PiB7XG4gICAgICBmbih2YWx1ZSk7XG4gICAgICByZXR1cm4gYXBpO1xuICAgIH0sXG4gICAgcmV0dXJuczogKHZhbHVlLCBkb25lKSA9PiBhcmcgPT4ge1xuICAgICAgaWYgKCFkb25lKSB7XG4gICAgICAgIHRocm93IG5ldyBfU2FnYVRlc3RFcnJvci5kZWZhdWx0KCdzYWdhIG5vdCBkb25lJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghKDAsIF9sb2Rhc2guZGVmYXVsdCkoYXJnLCB2YWx1ZSkpIHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gKDAsIF9jcmVhdGVFcnJvck1lc3NhZ2UuZGVmYXVsdCkoJ3JldHVybmVkIHZhbHVlcyBkbyBub3QgbWF0Y2gnLCBoaXN0b3J5Lmxlbmd0aCwgdmFsdWUsIGFyZyk7XG4gICAgICAgIHRocm93IG5ldyBfU2FnYVRlc3RFcnJvci5kZWZhdWx0KGVycm9yTWVzc2FnZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUl0ZXJhdG9yKCkge1xuICAgIHJldHVybiBzYWdhKC4uLmZpbmFsU2FnYUFyZ3MpO1xuICB9XG5cbiAgZnVuY3Rpb24gYXBpV2l0aEVmZmVjdHNUZXN0ZXJzKHtcbiAgICB2YWx1ZSxcbiAgICBkb25lXG4gIH0pIHtcbiAgICBjb25zdCBuZXdBcGkgPSAoMCwgX29iamVjdEFzc2lnbi5kZWZhdWx0KSh7fSwgYXBpLCB7XG4gICAgICBhY3Rpb25DaGFubmVsOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmFjdGlvbkNoYW5uZWwodmFsdWUpLFxuICAgICAgYWxsOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmFsbCh2YWx1ZSksXG4gICAgICBhcHBseTogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5hcHBseSh2YWx1ZSksXG4gICAgICBjYWxsOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmNhbGwodmFsdWUpLFxuICAgICAgY2FuY2VsOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmNhbmNlbCh2YWx1ZSksXG4gICAgICBjYW5jZWxsZWQ6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuY2FuY2VsbGVkKHZhbHVlKSxcbiAgICAgIGNwczogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5jcHModmFsdWUpLFxuICAgICAgZGVib3VuY2U6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuZGVib3VuY2UodmFsdWUpLFxuICAgICAgZGVsYXk6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuZGVsYXkodmFsdWUpLFxuICAgICAgZmx1c2g6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuZmx1c2godmFsdWUpLFxuICAgICAgZm9yazogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5mb3JrKHZhbHVlKSxcbiAgICAgIGdldENvbnRleHQ6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuZ2V0Q29udGV4dCh2YWx1ZSksXG4gICAgICBqb2luOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmpvaW4odmFsdWUpLFxuICAgICAgcHV0OiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLnB1dCh2YWx1ZSksXG4gICAgICBwdXRSZXNvbHZlOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLnB1dFJlc29sdmUodmFsdWUpLFxuICAgICAgcmFjZTogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5yYWNlKHZhbHVlKSxcbiAgICAgIHNlbGVjdDogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5zZWxlY3QodmFsdWUpLFxuICAgICAgc2V0Q29udGV4dDogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5zZXRDb250ZXh0KHZhbHVlKSxcbiAgICAgIHNwYXduOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLnNwYXduKHZhbHVlKSxcbiAgICAgIHRha2U6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMudGFrZSh2YWx1ZSksXG4gICAgICB0YWtlRXZlcnk6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMudGFrZUV2ZXJ5KHZhbHVlKSxcbiAgICAgIHRha2VMYXRlc3Q6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMudGFrZUxhdGVzdCh2YWx1ZSksXG4gICAgICB0YWtlTGVhZGluZzogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy50YWtlTGVhZGluZyh2YWx1ZSksXG4gICAgICB0YWtlTWF5YmU6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMudGFrZU1heWJlKHZhbHVlKSxcbiAgICAgIHRocm90dGxlOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLnRocm90dGxlKHZhbHVlKSxcbiAgICAgIHJldHJ5OiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLnJldHJ5KHZhbHVlKSxcbiAgICAgIGlzOiBlZmZlY3RzVGVzdGVyc0NyZWF0b3JzLmlzKHZhbHVlKSxcbiAgICAgIGluc3BlY3Q6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuaW5zcGVjdCh2YWx1ZSksXG4gICAgICBpc0RvbmU6IGVmZmVjdHNUZXN0ZXJzQ3JlYXRvcnMuaXNEb25lKGRvbmUpLFxuICAgICAgcmV0dXJuczogZWZmZWN0c1Rlc3RlcnNDcmVhdG9ycy5yZXR1cm5zKHZhbHVlLCBkb25lKVxuICAgIH0pO1xuICAgIHJldHVybiBuZXdBcGk7XG4gIH1cblxuICBmdW5jdGlvbiByZXN0YXJ0KC4uLmFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPiAwKSB7XG4gICAgICBmaW5hbFNhZ2FBcmdzID0gYXJncztcbiAgICB9XG5cbiAgICBoaXN0b3J5ID0gW107XG4gICAgaXRlcmF0b3IgPSBjcmVhdGVJdGVyYXRvcigpO1xuICAgIHJldHVybiBhcGk7XG4gIH1cblxuICBmdW5jdGlvbiBuZXh0KC4uLmFyZ3MpIHtcbiAgICBjb25zdCBhcmcgPSBhcmdzWzBdO1xuICAgIGxldCByZXN1bHQ7XG5cbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHtcbiAgICAgIGhpc3RvcnkucHVzaCh7XG4gICAgICAgIHR5cGU6IF9oaXN0b3J5VHlwZXMuTk9ORVxuICAgICAgfSk7XG4gICAgICByZXN1bHQgPSBpdGVyYXRvci5uZXh0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhpc3RvcnkucHVzaCh7XG4gICAgICAgIHR5cGU6IF9oaXN0b3J5VHlwZXMuQVJHVU1FTlQsXG4gICAgICAgIHZhbHVlOiBhcmdcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0ID0gaXRlcmF0b3IubmV4dChhcmcpO1xuICAgIH1cblxuICAgIHJldHVybiBhcGlXaXRoRWZmZWN0c1Rlc3RlcnMocmVzdWx0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmlzaCguLi5hcmdzKSB7XG4gICAgY29uc3QgYXJnID0gYXJnc1swXTtcbiAgICBsZXQgcmVzdWx0O1xuXG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBoaXN0b3J5LnB1c2goe1xuICAgICAgICB0eXBlOiBfaGlzdG9yeVR5cGVzLkZJTklTSFxuICAgICAgfSk7XG4gICAgICByZXN1bHQgPSBpdGVyYXRvci5yZXR1cm4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGlzdG9yeS5wdXNoKHtcbiAgICAgICAgdHlwZTogX2hpc3RvcnlUeXBlcy5GSU5JU0hfQVJHVU1FTlQsXG4gICAgICAgIHZhbHVlOiBhcmdcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0ID0gaXRlcmF0b3IucmV0dXJuKGFyZyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFwaVdpdGhFZmZlY3RzVGVzdGVycyhyZXN1bHQpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGhyb3dFcnJvcihlcnJvcikge1xuICAgIGhpc3RvcnkucHVzaCh7XG4gICAgICB0eXBlOiBfaGlzdG9yeVR5cGVzLkVSUk9SLFxuICAgICAgdmFsdWU6IGVycm9yXG4gICAgfSk7XG4gICAgY29uc3QgcmVzdWx0ID0gaXRlcmF0b3IudGhyb3coZXJyb3IpO1xuICAgIHJldHVybiBhcGlXaXRoRWZmZWN0c1Rlc3RlcnMocmVzdWx0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc3RvcmUobmFtZSkge1xuICAgIGlmICghc2F2ZVBvaW50c1tuYW1lXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIHNhdmUgcG9pbnQgJHtuYW1lfWApO1xuICAgIH1cblxuICAgIGl0ZXJhdG9yID0gY3JlYXRlSXRlcmF0b3IoKTtcbiAgICBoaXN0b3J5ID0gc2F2ZVBvaW50c1tuYW1lXTtcbiAgICByZXR1cm4gYXBwbHlIaXN0b3J5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBiYWNrKG4gPSAxKSB7XG4gICAgaWYgKG4gPiBoaXN0b3J5Lmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZ28gYmFjayBhbnkgZnVydGhlcicpO1xuICAgIH1cblxuICAgIGxldCBtID0gbjtcblxuICAgIHdoaWxlIChtLS0pIHtcbiAgICAgIGhpc3RvcnkucG9wKCk7XG4gICAgfVxuXG4gICAgaXRlcmF0b3IgPSBjcmVhdGVJdGVyYXRvcigpO1xuICAgIHJldHVybiBhcHBseUhpc3RvcnkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNhdmUobmFtZSkge1xuICAgIHNhdmVQb2ludHNbbmFtZV0gPSBoaXN0b3J5LnNsaWNlKDApO1xuICAgIHJldHVybiBhcGk7XG4gIH1cblxuICBmdW5jdGlvbiBhcHBseUhpc3RvcnkoKSB7XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBoaXN0b3J5Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgY29uc3QgYXJnID0gaGlzdG9yeVtpXTtcblxuICAgICAgc3dpdGNoIChhcmcudHlwZSkge1xuICAgICAgICBjYXNlIF9oaXN0b3J5VHlwZXMuTk9ORTpcbiAgICAgICAgICBpdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBfaGlzdG9yeVR5cGVzLkFSR1VNRU5UOlxuICAgICAgICAgIGl0ZXJhdG9yLm5leHQoYXJnLnZhbHVlKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIF9oaXN0b3J5VHlwZXMuRVJST1I6XG4gICAgICAgICAgaXRlcmF0b3IudGhyb3coYXJnLnZhbHVlKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIF9oaXN0b3J5VHlwZXMuRklOSVNIOlxuICAgICAgICAgIGl0ZXJhdG9yLnJldHVybigpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgX2hpc3RvcnlUeXBlcy5GSU5JU0hfQVJHVU1FTlQ6XG4gICAgICAgICAgaXRlcmF0b3IucmV0dXJuKGFyZy52YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIG5vIGRlZmF1bHRcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYXBpO1xuICB9XG5cbiAgcmV0dXJuIGFwaTtcbn0iXX0=