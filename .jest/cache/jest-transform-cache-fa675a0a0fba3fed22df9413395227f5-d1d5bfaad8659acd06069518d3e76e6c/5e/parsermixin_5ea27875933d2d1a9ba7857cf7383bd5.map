{"version":3,"sources":["parser-mixin.js"],"names":["Mixin","require","Tokenizer","LocationInfoTokenizerMixin","LocationInfoOpenElementStackMixin","HTML","$","TAG_NAMES","LocationInfoParserMixin","parser","treeAdapter","posTracker","lastStartTagToken","lastFosterParentingLocation","currentToken","element","loc","location","startTag","setNodeSourceCodeLocation","closingToken","getNodeSourceCodeLocation","ctLoc","tn","getTagName","isClosingEndTag","type","END_TAG_TOKEN","tagName","endLoc","endTag","endLine","endCol","endOffset","startLine","startCol","startOffset","updateNodeSourceCodeLocation","mxn","orig","_bootstrap","document","fragmentContext","call","tokenizerMixin","install","tokenizer","openElements","onItemPop","_setEndLocation","_runParsingLoop","scriptHandler","i","stackTop","items","_processTokenInForeignContent","token","_processToken","requireExplicitUpdate","BODY","hasInScope","_setDocumentType","documentChildren","getChildNodes","cnLength","length","node","isDocumentTypeNode","_attachElementToTree","_setStartLocation","_appendElement","namespaceURI","_insertElement","_insertTemplate","tmplContent","getTemplateContent","current","_insertFakeRootElement","_appendCommentNode","parent","children","commentNode","_findFosterParentingLocation","_insertCharacters","hasFosterParent","_shouldFosterParentOnInsertion","currentTmplContent","siblings","textNodeIdx","beforeElement","indexOf","textNode","tnLoc","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst Mixin = require('../../utils/mixin');\nconst Tokenizer = require('../../tokenizer');\nconst LocationInfoTokenizerMixin = require('./tokenizer-mixin');\nconst LocationInfoOpenElementStackMixin = require('./open-element-stack-mixin');\nconst HTML = require('../../common/html');\n\n//Aliases\nconst $ = HTML.TAG_NAMES;\n\nclass LocationInfoParserMixin extends Mixin {\n    constructor(parser) {\n        super(parser);\n\n        this.parser = parser;\n        this.treeAdapter = this.parser.treeAdapter;\n        this.posTracker = null;\n        this.lastStartTagToken = null;\n        this.lastFosterParentingLocation = null;\n        this.currentToken = null;\n    }\n\n    _setStartLocation(element) {\n        let loc = null;\n\n        if (this.lastStartTagToken) {\n            loc = Object.assign({}, this.lastStartTagToken.location);\n            loc.startTag = this.lastStartTagToken.location;\n        }\n\n        this.treeAdapter.setNodeSourceCodeLocation(element, loc);\n    }\n\n    _setEndLocation(element, closingToken) {\n        const loc = this.treeAdapter.getNodeSourceCodeLocation(element);\n\n        if (loc) {\n            if (closingToken.location) {\n                const ctLoc = closingToken.location;\n                const tn = this.treeAdapter.getTagName(element);\n\n                // NOTE: For cases like <p> <p> </p> - First 'p' closes without a closing\n                // tag and for cases like <td> <p> </td> - 'p' closes without a closing tag.\n                const isClosingEndTag = closingToken.type === Tokenizer.END_TAG_TOKEN && tn === closingToken.tagName;\n                const endLoc = {};\n                if (isClosingEndTag) {\n                    endLoc.endTag = Object.assign({}, ctLoc);\n                    endLoc.endLine = ctLoc.endLine;\n                    endLoc.endCol = ctLoc.endCol;\n                    endLoc.endOffset = ctLoc.endOffset;\n                } else {\n                    endLoc.endLine = ctLoc.startLine;\n                    endLoc.endCol = ctLoc.startCol;\n                    endLoc.endOffset = ctLoc.startOffset;\n                }\n\n                this.treeAdapter.updateNodeSourceCodeLocation(element, endLoc);\n            }\n        }\n    }\n\n    _getOverriddenMethods(mxn, orig) {\n        return {\n            _bootstrap(document, fragmentContext) {\n                orig._bootstrap.call(this, document, fragmentContext);\n\n                mxn.lastStartTagToken = null;\n                mxn.lastFosterParentingLocation = null;\n                mxn.currentToken = null;\n\n                const tokenizerMixin = Mixin.install(this.tokenizer, LocationInfoTokenizerMixin);\n\n                mxn.posTracker = tokenizerMixin.posTracker;\n\n                Mixin.install(this.openElements, LocationInfoOpenElementStackMixin, {\n                    onItemPop: function(element) {\n                        mxn._setEndLocation(element, mxn.currentToken);\n                    }\n                });\n            },\n\n            _runParsingLoop(scriptHandler) {\n                orig._runParsingLoop.call(this, scriptHandler);\n\n                // NOTE: generate location info for elements\n                // that remains on open element stack\n                for (let i = this.openElements.stackTop; i >= 0; i--) {\n                    mxn._setEndLocation(this.openElements.items[i], mxn.currentToken);\n                }\n            },\n\n            //Token processing\n            _processTokenInForeignContent(token) {\n                mxn.currentToken = token;\n                orig._processTokenInForeignContent.call(this, token);\n            },\n\n            _processToken(token) {\n                mxn.currentToken = token;\n                orig._processToken.call(this, token);\n\n                //NOTE: <body> and <html> are never popped from the stack, so we need to updated\n                //their end location explicitly.\n                const requireExplicitUpdate =\n                    token.type === Tokenizer.END_TAG_TOKEN &&\n                    (token.tagName === $.HTML || (token.tagName === $.BODY && this.openElements.hasInScope($.BODY)));\n\n                if (requireExplicitUpdate) {\n                    for (let i = this.openElements.stackTop; i >= 0; i--) {\n                        const element = this.openElements.items[i];\n\n                        if (this.treeAdapter.getTagName(element) === token.tagName) {\n                            mxn._setEndLocation(element, token);\n                            break;\n                        }\n                    }\n                }\n            },\n\n            //Doctype\n            _setDocumentType(token) {\n                orig._setDocumentType.call(this, token);\n\n                const documentChildren = this.treeAdapter.getChildNodes(this.document);\n                const cnLength = documentChildren.length;\n\n                for (let i = 0; i < cnLength; i++) {\n                    const node = documentChildren[i];\n\n                    if (this.treeAdapter.isDocumentTypeNode(node)) {\n                        this.treeAdapter.setNodeSourceCodeLocation(node, token.location);\n                        break;\n                    }\n                }\n            },\n\n            //Elements\n            _attachElementToTree(element) {\n                //NOTE: _attachElementToTree is called from _appendElement, _insertElement and _insertTemplate methods.\n                //So we will use token location stored in this methods for the element.\n                mxn._setStartLocation(element);\n                mxn.lastStartTagToken = null;\n                orig._attachElementToTree.call(this, element);\n            },\n\n            _appendElement(token, namespaceURI) {\n                mxn.lastStartTagToken = token;\n                orig._appendElement.call(this, token, namespaceURI);\n            },\n\n            _insertElement(token, namespaceURI) {\n                mxn.lastStartTagToken = token;\n                orig._insertElement.call(this, token, namespaceURI);\n            },\n\n            _insertTemplate(token) {\n                mxn.lastStartTagToken = token;\n                orig._insertTemplate.call(this, token);\n\n                const tmplContent = this.treeAdapter.getTemplateContent(this.openElements.current);\n\n                this.treeAdapter.setNodeSourceCodeLocation(tmplContent, null);\n            },\n\n            _insertFakeRootElement() {\n                orig._insertFakeRootElement.call(this);\n                this.treeAdapter.setNodeSourceCodeLocation(this.openElements.current, null);\n            },\n\n            //Comments\n            _appendCommentNode(token, parent) {\n                orig._appendCommentNode.call(this, token, parent);\n\n                const children = this.treeAdapter.getChildNodes(parent);\n                const commentNode = children[children.length - 1];\n\n                this.treeAdapter.setNodeSourceCodeLocation(commentNode, token.location);\n            },\n\n            //Text\n            _findFosterParentingLocation() {\n                //NOTE: store last foster parenting location, so we will be able to find inserted text\n                //in case of foster parenting\n                mxn.lastFosterParentingLocation = orig._findFosterParentingLocation.call(this);\n\n                return mxn.lastFosterParentingLocation;\n            },\n\n            _insertCharacters(token) {\n                orig._insertCharacters.call(this, token);\n\n                const hasFosterParent = this._shouldFosterParentOnInsertion();\n\n                const parent =\n                    (hasFosterParent && mxn.lastFosterParentingLocation.parent) ||\n                    this.openElements.currentTmplContent ||\n                    this.openElements.current;\n\n                const siblings = this.treeAdapter.getChildNodes(parent);\n\n                const textNodeIdx =\n                    hasFosterParent && mxn.lastFosterParentingLocation.beforeElement\n                        ? siblings.indexOf(mxn.lastFosterParentingLocation.beforeElement) - 1\n                        : siblings.length - 1;\n\n                const textNode = siblings[textNodeIdx];\n\n                //NOTE: if we have location assigned by another token, then just update end position\n                const tnLoc = this.treeAdapter.getNodeSourceCodeLocation(textNode);\n\n                if (tnLoc) {\n                    const { endLine, endCol, endOffset } = token.location;\n                    this.treeAdapter.updateNodeSourceCodeLocation(textNode, { endLine, endCol, endOffset });\n                } else {\n                    this.treeAdapter.setNodeSourceCodeLocation(textNode, token.location);\n                }\n            }\n        };\n    }\n}\n\nmodule.exports = LocationInfoParserMixin;\n"]}