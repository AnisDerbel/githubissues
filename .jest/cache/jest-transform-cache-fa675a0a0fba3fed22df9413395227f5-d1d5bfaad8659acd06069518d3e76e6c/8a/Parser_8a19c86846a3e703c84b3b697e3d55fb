4c0b33159823f0999ef981aae41b564d
"use strict";

var __importDefault = this && this.__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Parser = void 0;

var Tokenizer_1 = __importDefault(require("./Tokenizer"));

var formTags = new Set(["input", "option", "optgroup", "select", "button", "datalist", "textarea"]);
var pTag = new Set(["p"]);
var openImpliesClose = {
  tr: new Set(["tr", "th", "td"]),
  th: new Set(["th"]),
  td: new Set(["thead", "th", "td"]),
  body: new Set(["head", "link", "script"]),
  li: new Set(["li"]),
  p: pTag,
  h1: pTag,
  h2: pTag,
  h3: pTag,
  h4: pTag,
  h5: pTag,
  h6: pTag,
  select: formTags,
  input: formTags,
  output: formTags,
  button: formTags,
  datalist: formTags,
  textarea: formTags,
  option: new Set(["option"]),
  optgroup: new Set(["optgroup", "option"]),
  dd: new Set(["dt", "dd"]),
  dt: new Set(["dt", "dd"]),
  address: pTag,
  article: pTag,
  aside: pTag,
  blockquote: pTag,
  details: pTag,
  div: pTag,
  dl: pTag,
  fieldset: pTag,
  figcaption: pTag,
  figure: pTag,
  footer: pTag,
  form: pTag,
  header: pTag,
  hr: pTag,
  main: pTag,
  nav: pTag,
  ol: pTag,
  pre: pTag,
  section: pTag,
  table: pTag,
  ul: pTag,
  rt: new Set(["rt", "rp"]),
  rp: new Set(["rt", "rp"]),
  tbody: new Set(["thead", "tbody"]),
  tfoot: new Set(["thead", "tbody"])
};
var voidElements = new Set(["area", "base", "basefont", "br", "col", "command", "embed", "frame", "hr", "img", "input", "isindex", "keygen", "link", "meta", "param", "source", "track", "wbr"]);
var foreignContextElements = new Set(["math", "svg"]);
var htmlIntegrationElements = new Set(["mi", "mo", "mn", "ms", "mtext", "annotation-xml", "foreignObject", "desc", "title"]);
var reNameEnd = /\s|\//;

var Parser = function () {
  function Parser(cbs, options) {
    if (options === void 0) {
      options = {};
    }

    var _a, _b, _c, _d, _e;

    this.startIndex = 0;
    this.endIndex = null;
    this.tagname = "";
    this.attribname = "";
    this.attribvalue = "";
    this.attribs = null;
    this.stack = [];
    this.foreignContext = [];
    this.options = options;
    this.cbs = cbs !== null && cbs !== void 0 ? cbs : {};
    this.lowerCaseTagNames = (_a = options.lowerCaseTags) !== null && _a !== void 0 ? _a : !options.xmlMode;
    this.lowerCaseAttributeNames = (_b = options.lowerCaseAttributeNames) !== null && _b !== void 0 ? _b : !options.xmlMode;
    this.tokenizer = new ((_c = options.Tokenizer) !== null && _c !== void 0 ? _c : Tokenizer_1.default)(this.options, this);
    (_e = (_d = this.cbs).onparserinit) === null || _e === void 0 ? void 0 : _e.call(_d, this);
  }

  Parser.prototype.updatePosition = function (initialOffset) {
    if (this.endIndex === null) {
      if (this.tokenizer.sectionStart <= initialOffset) {
        this.startIndex = 0;
      } else {
        this.startIndex = this.tokenizer.sectionStart - initialOffset;
      }
    } else {
      this.startIndex = this.endIndex + 1;
    }

    this.endIndex = this.tokenizer.getAbsoluteIndex();
  };

  Parser.prototype.ontext = function (data) {
    var _a, _b;

    this.updatePosition(1);
    this.endIndex--;
    (_b = (_a = this.cbs).ontext) === null || _b === void 0 ? void 0 : _b.call(_a, data);
  };

  Parser.prototype.onopentagname = function (name) {
    var _a, _b;

    if (this.lowerCaseTagNames) {
      name = name.toLowerCase();
    }

    this.tagname = name;

    if (!this.options.xmlMode && Object.prototype.hasOwnProperty.call(openImpliesClose, name)) {
      var el = void 0;

      while (this.stack.length > 0 && openImpliesClose[name].has(el = this.stack[this.stack.length - 1])) {
        this.onclosetag(el);
      }
    }

    if (this.options.xmlMode || !voidElements.has(name)) {
      this.stack.push(name);

      if (foreignContextElements.has(name)) {
        this.foreignContext.push(true);
      } else if (htmlIntegrationElements.has(name)) {
        this.foreignContext.push(false);
      }
    }

    (_b = (_a = this.cbs).onopentagname) === null || _b === void 0 ? void 0 : _b.call(_a, name);
    if (this.cbs.onopentag) this.attribs = {};
  };

  Parser.prototype.onopentagend = function () {
    var _a, _b;

    this.updatePosition(1);

    if (this.attribs) {
      (_b = (_a = this.cbs).onopentag) === null || _b === void 0 ? void 0 : _b.call(_a, this.tagname, this.attribs);
      this.attribs = null;
    }

    if (!this.options.xmlMode && this.cbs.onclosetag && voidElements.has(this.tagname)) {
      this.cbs.onclosetag(this.tagname);
    }

    this.tagname = "";
  };

  Parser.prototype.onclosetag = function (name) {
    this.updatePosition(1);

    if (this.lowerCaseTagNames) {
      name = name.toLowerCase();
    }

    if (foreignContextElements.has(name) || htmlIntegrationElements.has(name)) {
      this.foreignContext.pop();
    }

    if (this.stack.length && (this.options.xmlMode || !voidElements.has(name))) {
      var pos = this.stack.lastIndexOf(name);

      if (pos !== -1) {
        if (this.cbs.onclosetag) {
          pos = this.stack.length - pos;

          while (pos--) {
            this.cbs.onclosetag(this.stack.pop());
          }
        } else this.stack.length = pos;
      } else if (name === "p" && !this.options.xmlMode) {
        this.onopentagname(name);
        this.closeCurrentTag();
      }
    } else if (!this.options.xmlMode && (name === "br" || name === "p")) {
      this.onopentagname(name);
      this.closeCurrentTag();
    }
  };

  Parser.prototype.onselfclosingtag = function () {
    if (this.options.xmlMode || this.options.recognizeSelfClosing || this.foreignContext[this.foreignContext.length - 1]) {
      this.closeCurrentTag();
    } else {
      this.onopentagend();
    }
  };

  Parser.prototype.closeCurrentTag = function () {
    var _a, _b;

    var name = this.tagname;
    this.onopentagend();

    if (this.stack[this.stack.length - 1] === name) {
      (_b = (_a = this.cbs).onclosetag) === null || _b === void 0 ? void 0 : _b.call(_a, name);
      this.stack.pop();
    }
  };

  Parser.prototype.onattribname = function (name) {
    if (this.lowerCaseAttributeNames) {
      name = name.toLowerCase();
    }

    this.attribname = name;
  };

  Parser.prototype.onattribdata = function (value) {
    this.attribvalue += value;
  };

  Parser.prototype.onattribend = function (quote) {
    var _a, _b;

    (_b = (_a = this.cbs).onattribute) === null || _b === void 0 ? void 0 : _b.call(_a, this.attribname, this.attribvalue, quote);

    if (this.attribs && !Object.prototype.hasOwnProperty.call(this.attribs, this.attribname)) {
      this.attribs[this.attribname] = this.attribvalue;
    }

    this.attribname = "";
    this.attribvalue = "";
  };

  Parser.prototype.getInstructionName = function (value) {
    var idx = value.search(reNameEnd);
    var name = idx < 0 ? value : value.substr(0, idx);

    if (this.lowerCaseTagNames) {
      name = name.toLowerCase();
    }

    return name;
  };

  Parser.prototype.ondeclaration = function (value) {
    if (this.cbs.onprocessinginstruction) {
      var name_1 = this.getInstructionName(value);
      this.cbs.onprocessinginstruction("!" + name_1, "!" + value);
    }
  };

  Parser.prototype.onprocessinginstruction = function (value) {
    if (this.cbs.onprocessinginstruction) {
      var name_2 = this.getInstructionName(value);
      this.cbs.onprocessinginstruction("?" + name_2, "?" + value);
    }
  };

  Parser.prototype.oncomment = function (value) {
    var _a, _b, _c, _d;

    this.updatePosition(4);
    (_b = (_a = this.cbs).oncomment) === null || _b === void 0 ? void 0 : _b.call(_a, value);
    (_d = (_c = this.cbs).oncommentend) === null || _d === void 0 ? void 0 : _d.call(_c);
  };

  Parser.prototype.oncdata = function (value) {
    var _a, _b, _c, _d, _e, _f;

    this.updatePosition(1);

    if (this.options.xmlMode || this.options.recognizeCDATA) {
      (_b = (_a = this.cbs).oncdatastart) === null || _b === void 0 ? void 0 : _b.call(_a);
      (_d = (_c = this.cbs).ontext) === null || _d === void 0 ? void 0 : _d.call(_c, value);
      (_f = (_e = this.cbs).oncdataend) === null || _f === void 0 ? void 0 : _f.call(_e);
    } else {
      this.oncomment("[CDATA[" + value + "]]");
    }
  };

  Parser.prototype.onerror = function (err) {
    var _a, _b;

    (_b = (_a = this.cbs).onerror) === null || _b === void 0 ? void 0 : _b.call(_a, err);
  };

  Parser.prototype.onend = function () {
    var _a, _b;

    if (this.cbs.onclosetag) {
      for (var i = this.stack.length; i > 0; this.cbs.onclosetag(this.stack[--i])) {
        ;
      }
    }

    (_b = (_a = this.cbs).onend) === null || _b === void 0 ? void 0 : _b.call(_a);
  };

  Parser.prototype.reset = function () {
    var _a, _b, _c, _d;

    (_b = (_a = this.cbs).onreset) === null || _b === void 0 ? void 0 : _b.call(_a);
    this.tokenizer.reset();
    this.tagname = "";
    this.attribname = "";
    this.attribs = null;
    this.stack = [];
    (_d = (_c = this.cbs).onparserinit) === null || _d === void 0 ? void 0 : _d.call(_c, this);
  };

  Parser.prototype.parseComplete = function (data) {
    this.reset();
    this.end(data);
  };

  Parser.prototype.write = function (chunk) {
    this.tokenizer.write(chunk);
  };

  Parser.prototype.end = function (chunk) {
    this.tokenizer.end(chunk);
  };

  Parser.prototype.pause = function () {
    this.tokenizer.pause();
  };

  Parser.prototype.resume = function () {
    this.tokenizer.resume();
  };

  Parser.prototype.parseChunk = function (chunk) {
    this.write(chunk);
  };

  Parser.prototype.done = function (chunk) {
    this.end(chunk);
  };

  return Parser;
}();

exports.Parser = Parser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBhcnNlci5qcyJdLCJuYW1lcyI6WyJfX2ltcG9ydERlZmF1bHQiLCJtb2QiLCJfX2VzTW9kdWxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJQYXJzZXIiLCJUb2tlbml6ZXJfMSIsInJlcXVpcmUiLCJmb3JtVGFncyIsIlNldCIsInBUYWciLCJvcGVuSW1wbGllc0Nsb3NlIiwidHIiLCJ0aCIsInRkIiwiYm9keSIsImxpIiwicCIsImgxIiwiaDIiLCJoMyIsImg0IiwiaDUiLCJoNiIsInNlbGVjdCIsImlucHV0Iiwib3V0cHV0IiwiYnV0dG9uIiwiZGF0YWxpc3QiLCJ0ZXh0YXJlYSIsIm9wdGlvbiIsIm9wdGdyb3VwIiwiZGQiLCJkdCIsImFkZHJlc3MiLCJhcnRpY2xlIiwiYXNpZGUiLCJibG9ja3F1b3RlIiwiZGV0YWlscyIsImRpdiIsImRsIiwiZmllbGRzZXQiLCJmaWdjYXB0aW9uIiwiZmlndXJlIiwiZm9vdGVyIiwiZm9ybSIsImhlYWRlciIsImhyIiwibWFpbiIsIm5hdiIsIm9sIiwicHJlIiwic2VjdGlvbiIsInRhYmxlIiwidWwiLCJydCIsInJwIiwidGJvZHkiLCJ0Zm9vdCIsInZvaWRFbGVtZW50cyIsImZvcmVpZ25Db250ZXh0RWxlbWVudHMiLCJodG1sSW50ZWdyYXRpb25FbGVtZW50cyIsInJlTmFtZUVuZCIsImNicyIsIm9wdGlvbnMiLCJfYSIsIl9iIiwiX2MiLCJfZCIsIl9lIiwic3RhcnRJbmRleCIsImVuZEluZGV4IiwidGFnbmFtZSIsImF0dHJpYm5hbWUiLCJhdHRyaWJ2YWx1ZSIsImF0dHJpYnMiLCJzdGFjayIsImZvcmVpZ25Db250ZXh0IiwibG93ZXJDYXNlVGFnTmFtZXMiLCJsb3dlckNhc2VUYWdzIiwieG1sTW9kZSIsImxvd2VyQ2FzZUF0dHJpYnV0ZU5hbWVzIiwidG9rZW5pemVyIiwiVG9rZW5pemVyIiwiZGVmYXVsdCIsIm9ucGFyc2VyaW5pdCIsImNhbGwiLCJwcm90b3R5cGUiLCJ1cGRhdGVQb3NpdGlvbiIsImluaXRpYWxPZmZzZXQiLCJzZWN0aW9uU3RhcnQiLCJnZXRBYnNvbHV0ZUluZGV4Iiwib250ZXh0IiwiZGF0YSIsIm9ub3BlbnRhZ25hbWUiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJoYXNPd25Qcm9wZXJ0eSIsImVsIiwibGVuZ3RoIiwiaGFzIiwib25jbG9zZXRhZyIsInB1c2giLCJvbm9wZW50YWciLCJvbm9wZW50YWdlbmQiLCJwb3AiLCJwb3MiLCJsYXN0SW5kZXhPZiIsImNsb3NlQ3VycmVudFRhZyIsIm9uc2VsZmNsb3Npbmd0YWciLCJyZWNvZ25pemVTZWxmQ2xvc2luZyIsIm9uYXR0cmlibmFtZSIsIm9uYXR0cmliZGF0YSIsIm9uYXR0cmliZW5kIiwicXVvdGUiLCJvbmF0dHJpYnV0ZSIsImdldEluc3RydWN0aW9uTmFtZSIsImlkeCIsInNlYXJjaCIsInN1YnN0ciIsIm9uZGVjbGFyYXRpb24iLCJvbnByb2Nlc3NpbmdpbnN0cnVjdGlvbiIsIm5hbWVfMSIsIm5hbWVfMiIsIm9uY29tbWVudCIsIm9uY29tbWVudGVuZCIsIm9uY2RhdGEiLCJfZiIsInJlY29nbml6ZUNEQVRBIiwib25jZGF0YXN0YXJ0Iiwib25jZGF0YWVuZCIsIm9uZXJyb3IiLCJlcnIiLCJvbmVuZCIsImkiLCJyZXNldCIsIm9ucmVzZXQiLCJwYXJzZUNvbXBsZXRlIiwiZW5kIiwid3JpdGUiLCJjaHVuayIsInBhdXNlIiwicmVzdW1lIiwicGFyc2VDaHVuayIsImRvbmUiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBLElBQUlBLGVBQWUsR0FBSSxRQUFRLEtBQUtBLGVBQWQsSUFBa0MsVUFBVUMsR0FBVixFQUFlO0FBQ25FLFNBQVFBLEdBQUcsSUFBSUEsR0FBRyxDQUFDQyxVQUFaLEdBQTBCRCxHQUExQixHQUFnQztBQUFFLGVBQVdBO0FBQWIsR0FBdkM7QUFDSCxDQUZEOztBQUdBRSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQUVD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R0FGRDs7QUFHQSxTQUFPdkksTUFBUDtBQUNILENBdlIyQixFQUE1Qjs7QUF3UkFGLE9BQU8sQ0FBQ0UsTUFBUixHQUFpQkEsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUGFyc2VyID0gdm9pZCAwO1xudmFyIFRva2VuaXplcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL1Rva2VuaXplclwiKSk7XG52YXIgZm9ybVRhZ3MgPSBuZXcgU2V0KFtcbiAgICBcImlucHV0XCIsXG4gICAgXCJvcHRpb25cIixcbiAgICBcIm9wdGdyb3VwXCIsXG4gICAgXCJzZWxlY3RcIixcbiAgICBcImJ1dHRvblwiLFxuICAgIFwiZGF0YWxpc3RcIixcbiAgICBcInRleHRhcmVhXCIsXG5dKTtcbnZhciBwVGFnID0gbmV3IFNldChbXCJwXCJdKTtcbnZhciBvcGVuSW1wbGllc0Nsb3NlID0ge1xuICAgIHRyOiBuZXcgU2V0KFtcInRyXCIsIFwidGhcIiwgXCJ0ZFwiXSksXG4gICAgdGg6IG5ldyBTZXQoW1widGhcIl0pLFxuICAgIHRkOiBuZXcgU2V0KFtcInRoZWFkXCIsIFwidGhcIiwgXCJ0ZFwiXSksXG4gICAgYm9keTogbmV3IFNldChbXCJoZWFkXCIsIFwibGlua1wiLCBcInNjcmlwdFwiXSksXG4gICAgbGk6IG5ldyBTZXQoW1wibGlcIl0pLFxuICAgIHA6IHBUYWcsXG4gICAgaDE6IHBUYWcsXG4gICAgaDI6IHBUYWcsXG4gICAgaDM6IHBUYWcsXG4gICAgaDQ6IHBUYWcsXG4gICAgaDU6IHBUYWcsXG4gICAgaDY6IHBUYWcsXG4gICAgc2VsZWN0OiBmb3JtVGFncyxcbiAgICBpbnB1dDogZm9ybVRhZ3MsXG4gICAgb3V0cHV0OiBmb3JtVGFncyxcbiAgICBidXR0b246IGZvcm1UYWdzLFxuICAgIGRhdGFsaXN0OiBmb3JtVGFncyxcbiAgICB0ZXh0YXJlYTogZm9ybVRhZ3MsXG4gICAgb3B0aW9uOiBuZXcgU2V0KFtcIm9wdGlvblwiXSksXG4gICAgb3B0Z3JvdXA6IG5ldyBTZXQoW1wib3B0Z3JvdXBcIiwgXCJvcHRpb25cIl0pLFxuICAgIGRkOiBuZXcgU2V0KFtcImR0XCIsIFwiZGRcIl0pLFxuICAgIGR0OiBuZXcgU2V0KFtcImR0XCIsIFwiZGRcIl0pLFxuICAgIGFkZHJlc3M6IHBUYWcsXG4gICAgYXJ0aWNsZTogcFRhZyxcbiAgICBhc2lkZTogcFRhZyxcbiAgICBibG9ja3F1b3RlOiBwVGFnLFxuICAgIGRldGFpbHM6IHBUYWcsXG4gICAgZGl2OiBwVGFnLFxuICAgIGRsOiBwVGFnLFxuICAgIGZpZWxkc2V0OiBwVGFnLFxuICAgIGZpZ2NhcHRpb246IHBUYWcsXG4gICAgZmlndXJlOiBwVGFnLFxuICAgIGZvb3RlcjogcFRhZyxcbiAgICBmb3JtOiBwVGFnLFxuICAgIGhlYWRlcjogcFRhZyxcbiAgICBocjogcFRhZyxcbiAgICBtYWluOiBwVGFnLFxuICAgIG5hdjogcFRhZyxcbiAgICBvbDogcFRhZyxcbiAgICBwcmU6IHBUYWcsXG4gICAgc2VjdGlvbjogcFRhZyxcbiAgICB0YWJsZTogcFRhZyxcbiAgICB1bDogcFRhZyxcbiAgICBydDogbmV3IFNldChbXCJydFwiLCBcInJwXCJdKSxcbiAgICBycDogbmV3IFNldChbXCJydFwiLCBcInJwXCJdKSxcbiAgICB0Ym9keTogbmV3IFNldChbXCJ0aGVhZFwiLCBcInRib2R5XCJdKSxcbiAgICB0Zm9vdDogbmV3IFNldChbXCJ0aGVhZFwiLCBcInRib2R5XCJdKSxcbn07XG52YXIgdm9pZEVsZW1lbnRzID0gbmV3IFNldChbXG4gICAgXCJhcmVhXCIsXG4gICAgXCJiYXNlXCIsXG4gICAgXCJiYXNlZm9udFwiLFxuICAgIFwiYnJcIixcbiAgICBcImNvbFwiLFxuICAgIFwiY29tbWFuZFwiLFxuICAgIFwiZW1iZWRcIixcbiAgICBcImZyYW1lXCIsXG4gICAgXCJoclwiLFxuICAgIFwiaW1nXCIsXG4gICAgXCJpbnB1dFwiLFxuICAgIFwiaXNpbmRleFwiLFxuICAgIFwia2V5Z2VuXCIsXG4gICAgXCJsaW5rXCIsXG4gICAgXCJtZXRhXCIsXG4gICAgXCJwYXJhbVwiLFxuICAgIFwic291cmNlXCIsXG4gICAgXCJ0cmFja1wiLFxuICAgIFwid2JyXCIsXG5dKTtcbnZhciBmb3JlaWduQ29udGV4dEVsZW1lbnRzID0gbmV3IFNldChbXCJtYXRoXCIsIFwic3ZnXCJdKTtcbnZhciBodG1sSW50ZWdyYXRpb25FbGVtZW50cyA9IG5ldyBTZXQoW1xuICAgIFwibWlcIixcbiAgICBcIm1vXCIsXG4gICAgXCJtblwiLFxuICAgIFwibXNcIixcbiAgICBcIm10ZXh0XCIsXG4gICAgXCJhbm5vdGF0aW9uLXhtbFwiLFxuICAgIFwiZm9yZWlnbk9iamVjdFwiLFxuICAgIFwiZGVzY1wiLFxuICAgIFwidGl0bGVcIixcbl0pO1xudmFyIHJlTmFtZUVuZCA9IC9cXHN8XFwvLztcbnZhciBQYXJzZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGFyc2VyKGNicywgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lO1xuICAgICAgICAvKiogVGhlIHN0YXJ0IGluZGV4IG9mIHRoZSBsYXN0IGV2ZW50LiAqL1xuICAgICAgICB0aGlzLnN0YXJ0SW5kZXggPSAwO1xuICAgICAgICAvKiogVGhlIGVuZCBpbmRleCBvZiB0aGUgbGFzdCBldmVudC4gKi9cbiAgICAgICAgdGhpcy5lbmRJbmRleCA9IG51bGw7XG4gICAgICAgIHRoaXMudGFnbmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlibmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlidmFsdWUgPSBcIlwiO1xuICAgICAgICB0aGlzLmF0dHJpYnMgPSBudWxsO1xuICAgICAgICB0aGlzLnN0YWNrID0gW107XG4gICAgICAgIHRoaXMuZm9yZWlnbkNvbnRleHQgPSBbXTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5jYnMgPSBjYnMgIT09IG51bGwgJiYgY2JzICE9PSB2b2lkIDAgPyBjYnMgOiB7fTtcbiAgICAgICAgdGhpcy5sb3dlckNhc2VUYWdOYW1lcyA9IChfYSA9IG9wdGlvbnMubG93ZXJDYXNlVGFncykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogIW9wdGlvbnMueG1sTW9kZTtcbiAgICAgICAgdGhpcy5sb3dlckNhc2VBdHRyaWJ1dGVOYW1lcyA9XG4gICAgICAgICAgICAoX2IgPSBvcHRpb25zLmxvd2VyQ2FzZUF0dHJpYnV0ZU5hbWVzKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAhb3B0aW9ucy54bWxNb2RlO1xuICAgICAgICB0aGlzLnRva2VuaXplciA9IG5ldyAoKF9jID0gb3B0aW9ucy5Ub2tlbml6ZXIpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IFRva2VuaXplcl8xLmRlZmF1bHQpKHRoaXMub3B0aW9ucywgdGhpcyk7XG4gICAgICAgIChfZSA9IChfZCA9IHRoaXMuY2JzKS5vbnBhcnNlcmluaXQpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5jYWxsKF9kLCB0aGlzKTtcbiAgICB9XG4gICAgUGFyc2VyLnByb3RvdHlwZS51cGRhdGVQb3NpdGlvbiA9IGZ1bmN0aW9uIChpbml0aWFsT2Zmc2V0KSB7XG4gICAgICAgIGlmICh0aGlzLmVuZEluZGV4ID09PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50b2tlbml6ZXIuc2VjdGlvblN0YXJ0IDw9IGluaXRpYWxPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0SW5kZXggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEluZGV4ID0gdGhpcy50b2tlbml6ZXIuc2VjdGlvblN0YXJ0IC0gaW5pdGlhbE9mZnNldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRJbmRleCA9IHRoaXMuZW5kSW5kZXggKyAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5kSW5kZXggPSB0aGlzLnRva2VuaXplci5nZXRBYnNvbHV0ZUluZGV4KCk7XG4gICAgfTtcbiAgICAvLyBUb2tlbml6ZXIgZXZlbnQgaGFuZGxlcnNcbiAgICBQYXJzZXIucHJvdG90eXBlLm9udGV4dCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oMSk7XG4gICAgICAgIHRoaXMuZW5kSW5kZXgtLTtcbiAgICAgICAgKF9iID0gKF9hID0gdGhpcy5jYnMpLm9udGV4dCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIGRhdGEpO1xuICAgIH07XG4gICAgUGFyc2VyLnByb3RvdHlwZS5vbm9wZW50YWduYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgaWYgKHRoaXMubG93ZXJDYXNlVGFnTmFtZXMpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWduYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMueG1sTW9kZSAmJlxuICAgICAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9wZW5JbXBsaWVzQ2xvc2UsIG5hbWUpKSB7XG4gICAgICAgICAgICB2YXIgZWwgPSB2b2lkIDA7XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5zdGFjay5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgICAgb3BlbkltcGxpZXNDbG9zZVtuYW1lXS5oYXMoKGVsID0gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDFdKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uY2xvc2V0YWcoZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMueG1sTW9kZSB8fCAhdm9pZEVsZW1lbnRzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKG5hbWUpO1xuICAgICAgICAgICAgaWYgKGZvcmVpZ25Db250ZXh0RWxlbWVudHMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JlaWduQ29udGV4dC5wdXNoKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaHRtbEludGVncmF0aW9uRWxlbWVudHMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JlaWduQ29udGV4dC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLmNicykub25vcGVudGFnbmFtZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIG5hbWUpO1xuICAgICAgICBpZiAodGhpcy5jYnMub25vcGVudGFnKVxuICAgICAgICAgICAgdGhpcy5hdHRyaWJzID0ge307XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLm9ub3BlbnRhZ2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigxKTtcbiAgICAgICAgaWYgKHRoaXMuYXR0cmlicykge1xuICAgICAgICAgICAgKF9iID0gKF9hID0gdGhpcy5jYnMpLm9ub3BlbnRhZykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIHRoaXMudGFnbmFtZSwgdGhpcy5hdHRyaWJzKTtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlicyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMueG1sTW9kZSAmJlxuICAgICAgICAgICAgdGhpcy5jYnMub25jbG9zZXRhZyAmJlxuICAgICAgICAgICAgdm9pZEVsZW1lbnRzLmhhcyh0aGlzLnRhZ25hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLmNicy5vbmNsb3NldGFnKHRoaXMudGFnbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWduYW1lID0gXCJcIjtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25jbG9zZXRhZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oMSk7XG4gICAgICAgIGlmICh0aGlzLmxvd2VyQ2FzZVRhZ05hbWVzKSB7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmb3JlaWduQ29udGV4dEVsZW1lbnRzLmhhcyhuYW1lKSB8fFxuICAgICAgICAgICAgaHRtbEludGVncmF0aW9uRWxlbWVudHMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLmZvcmVpZ25Db250ZXh0LnBvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCAmJlxuICAgICAgICAgICAgKHRoaXMub3B0aW9ucy54bWxNb2RlIHx8ICF2b2lkRWxlbWVudHMuaGFzKG5hbWUpKSkge1xuICAgICAgICAgICAgdmFyIHBvcyA9IHRoaXMuc3RhY2subGFzdEluZGV4T2YobmFtZSk7XG4gICAgICAgICAgICBpZiAocG9zICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNicy5vbmNsb3NldGFnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcyA9IHRoaXMuc3RhY2subGVuZ3RoIC0gcG9zO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAocG9zLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgdGhlIHN0YWNrIGhhcyBzdWZmaWNpZW50IGVsZW1lbnRzLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYnMub25jbG9zZXRhZyh0aGlzLnN0YWNrLnBvcCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhY2subGVuZ3RoID0gcG9zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gXCJwXCIgJiYgIXRoaXMub3B0aW9ucy54bWxNb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbm9wZW50YWduYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VDdXJyZW50VGFnKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXRoaXMub3B0aW9ucy54bWxNb2RlICYmIChuYW1lID09PSBcImJyXCIgfHwgbmFtZSA9PT0gXCJwXCIpKSB7XG4gICAgICAgICAgICB0aGlzLm9ub3BlbnRhZ25hbWUobmFtZSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlQ3VycmVudFRhZygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLm9uc2VsZmNsb3Npbmd0YWcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMueG1sTW9kZSB8fFxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnJlY29nbml6ZVNlbGZDbG9zaW5nIHx8XG4gICAgICAgICAgICB0aGlzLmZvcmVpZ25Db250ZXh0W3RoaXMuZm9yZWlnbkNvbnRleHQubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VDdXJyZW50VGFnKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9ub3BlbnRhZ2VuZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLmNsb3NlQ3VycmVudFRhZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLnRhZ25hbWU7XG4gICAgICAgIHRoaXMub25vcGVudGFnZW5kKCk7XG4gICAgICAgIC8qXG4gICAgICAgICAqIFNlbGYtY2xvc2luZyB0YWdzIHdpbGwgYmUgb24gdGhlIHRvcCBvZiB0aGUgc3RhY2tcbiAgICAgICAgICogKGNoZWFwZXIgY2hlY2sgdGhhbiBpbiBvbmNsb3NldGFnKVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSAxXSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgKF9iID0gKF9hID0gdGhpcy5jYnMpLm9uY2xvc2V0YWcpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBuYW1lKTtcbiAgICAgICAgICAgIHRoaXMuc3RhY2sucG9wKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25hdHRyaWJuYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMubG93ZXJDYXNlQXR0cmlidXRlTmFtZXMpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hdHRyaWJuYW1lID0gbmFtZTtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25hdHRyaWJkYXRhID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidmFsdWUgKz0gdmFsdWU7XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLm9uYXR0cmliZW5kID0gZnVuY3Rpb24gKHF1b3RlKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIChfYiA9IChfYSA9IHRoaXMuY2JzKS5vbmF0dHJpYnV0ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIHRoaXMuYXR0cmlibmFtZSwgdGhpcy5hdHRyaWJ2YWx1ZSwgcXVvdGUpO1xuICAgICAgICBpZiAodGhpcy5hdHRyaWJzICYmXG4gICAgICAgICAgICAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuYXR0cmlicywgdGhpcy5hdHRyaWJuYW1lKSkge1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJzW3RoaXMuYXR0cmlibmFtZV0gPSB0aGlzLmF0dHJpYnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXR0cmlibmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlidmFsdWUgPSBcIlwiO1xuICAgIH07XG4gICAgUGFyc2VyLnByb3RvdHlwZS5nZXRJbnN0cnVjdGlvbk5hbWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGlkeCA9IHZhbHVlLnNlYXJjaChyZU5hbWVFbmQpO1xuICAgICAgICB2YXIgbmFtZSA9IGlkeCA8IDAgPyB2YWx1ZSA6IHZhbHVlLnN1YnN0cigwLCBpZHgpO1xuICAgICAgICBpZiAodGhpcy5sb3dlckNhc2VUYWdOYW1lcykge1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25kZWNsYXJhdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5jYnMub25wcm9jZXNzaW5naW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSB0aGlzLmdldEluc3RydWN0aW9uTmFtZSh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmNicy5vbnByb2Nlc3NpbmdpbnN0cnVjdGlvbihcIiFcIiArIG5hbWVfMSwgXCIhXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25wcm9jZXNzaW5naW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuY2JzLm9ucHJvY2Vzc2luZ2luc3RydWN0aW9uKSB7XG4gICAgICAgICAgICB2YXIgbmFtZV8yID0gdGhpcy5nZXRJbnN0cnVjdGlvbk5hbWUodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5jYnMub25wcm9jZXNzaW5naW5zdHJ1Y3Rpb24oXCI/XCIgKyBuYW1lXzIsIFwiP1wiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLm9uY29tbWVudCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oNCk7XG4gICAgICAgIChfYiA9IChfYSA9IHRoaXMuY2JzKS5vbmNvbW1lbnQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCB2YWx1ZSk7XG4gICAgICAgIChfZCA9IChfYyA9IHRoaXMuY2JzKS5vbmNvbW1lbnRlbmQpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5jYWxsKF9jKTtcbiAgICB9O1xuICAgIFBhcnNlci5wcm90b3R5cGUub25jZGF0YSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigxKTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy54bWxNb2RlIHx8IHRoaXMub3B0aW9ucy5yZWNvZ25pemVDREFUQSkge1xuICAgICAgICAgICAgKF9iID0gKF9hID0gdGhpcy5jYnMpLm9uY2RhdGFzdGFydCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EpO1xuICAgICAgICAgICAgKF9kID0gKF9jID0gdGhpcy5jYnMpLm9udGV4dCkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmNhbGwoX2MsIHZhbHVlKTtcbiAgICAgICAgICAgIChfZiA9IChfZSA9IHRoaXMuY2JzKS5vbmNkYXRhZW5kKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YuY2FsbChfZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9uY29tbWVudChcIltDREFUQVtcIiArIHZhbHVlICsgXCJdXVwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFyc2VyLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLmNicykub25lcnJvcikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIGVycik7XG4gICAgfTtcbiAgICBQYXJzZXIucHJvdG90eXBlLm9uZW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBpZiAodGhpcy5jYnMub25jbG9zZXRhZykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuc3RhY2subGVuZ3RoOyBpID4gMDsgdGhpcy5jYnMub25jbG9zZXRhZyh0aGlzLnN0YWNrWy0taV0pKVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgfVxuICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLmNicykub25lbmQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgcGFyc2VyIHRvIGEgYmxhbmsgc3RhdGUsIHJlYWR5IHRvIHBhcnNlIGEgbmV3IEhUTUwgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBQYXJzZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIChfYiA9IChfYSA9IHRoaXMuY2JzKS5vbnJlc2V0KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSk7XG4gICAgICAgIHRoaXMudG9rZW5pemVyLnJlc2V0KCk7XG4gICAgICAgIHRoaXMudGFnbmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlibmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlicyA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RhY2sgPSBbXTtcbiAgICAgICAgKF9kID0gKF9jID0gdGhpcy5jYnMpLm9ucGFyc2VyaW5pdCkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmNhbGwoX2MsIHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBwYXJzZXIsIHRoZW4gcGFyc2VzIGEgY29tcGxldGUgZG9jdW1lbnQgYW5kXG4gICAgICogcHVzaGVzIGl0IHRvIHRoZSBoYW5kbGVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGEgRG9jdW1lbnQgdG8gcGFyc2UuXG4gICAgICovXG4gICAgUGFyc2VyLnByb3RvdHlwZS5wYXJzZUNvbXBsZXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB0aGlzLmVuZChkYXRhKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIGNodW5rIG9mIGRhdGEgYW5kIGNhbGxzIHRoZSBjb3JyZXNwb25kaW5nIGNhbGxiYWNrcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjaHVuayBDaHVuayB0byBwYXJzZS5cbiAgICAgKi9cbiAgICBQYXJzZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGNodW5rKSB7XG4gICAgICAgIHRoaXMudG9rZW5pemVyLndyaXRlKGNodW5rKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFBhcnNlcyB0aGUgZW5kIG9mIHRoZSBidWZmZXIgYW5kIGNsZWFycyB0aGUgc3RhY2ssIGNhbGxzIG9uZW5kLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNodW5rIE9wdGlvbmFsIGZpbmFsIGNodW5rIHRvIHBhcnNlLlxuICAgICAqL1xuICAgIFBhcnNlci5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGNodW5rKSB7XG4gICAgICAgIHRoaXMudG9rZW5pemVyLmVuZChjaHVuayk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBQYXVzZXMgcGFyc2luZy4gVGhlIHBhcnNlciB3b24ndCBlbWl0IGV2ZW50cyB1bnRpbCBgcmVzdW1lYCBpcyBjYWxsZWQuXG4gICAgICovXG4gICAgUGFyc2VyLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b2tlbml6ZXIucGF1c2UoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlc3VtZXMgcGFyc2luZyBhZnRlciBgcGF1c2VgIHdhcyBjYWxsZWQuXG4gICAgICovXG4gICAgUGFyc2VyLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudG9rZW5pemVyLnJlc3VtZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWxpYXMgb2YgYHdyaXRlYCwgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGNodW5rIENodW5rIHRvIHBhcnNlLlxuICAgICAqIEBkZXByZWNhdGVkXG4gICAgICovXG4gICAgUGFyc2VyLnByb3RvdHlwZS5wYXJzZUNodW5rID0gZnVuY3Rpb24gKGNodW5rKSB7XG4gICAgICAgIHRoaXMud3JpdGUoY2h1bmspO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWxpYXMgb2YgYGVuZGAsIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjaHVuayBPcHRpb25hbCBmaW5hbCBjaHVuayB0byBwYXJzZS5cbiAgICAgKiBAZGVwcmVjYXRlZFxuICAgICAqL1xuICAgIFBhcnNlci5wcm90b3R5cGUuZG9uZSA9IGZ1bmN0aW9uIChjaHVuaykge1xuICAgICAgICB0aGlzLmVuZChjaHVuayk7XG4gICAgfTtcbiAgICByZXR1cm4gUGFyc2VyO1xufSgpKTtcbmV4cG9ydHMuUGFyc2VyID0gUGFyc2VyO1xuIl19