{"version":3,"sources":["Tokenizer.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","decode_codepoint_1","require","entities_json_1","legacy_json_1","xml_json_1","whitespace","c","isASCIIAlpha","ifElseState","upper","SUCCESS","FAILURE","lower","toLowerCase","t","_state","_index","consumeSpecialNameChar","NEXT_STATE","stateBeforeCdata1","stateBeforeCdata2","stateBeforeCdata3","stateBeforeCdata4","stateBeforeCdata5","stateBeforeScript1","stateBeforeScript2","stateBeforeScript3","stateBeforeScript4","stateAfterScript1","stateAfterScript2","stateAfterScript3","stateAfterScript4","stateBeforeStyle1","stateBeforeStyle2","stateBeforeStyle3","stateAfterStyle1","stateAfterStyle2","stateAfterStyle3","stateBeforeSpecialT","stateBeforeTitle1","stateBeforeTitle2","stateBeforeTitle3","stateAfterSpecialTEnd","stateAfterTitle1","stateAfterTitle2","stateAfterTitle3","stateBeforeEntity","stateBeforeNumericEntity","Tokenizer","options","cbs","_a","buffer","sectionStart","bufferOffset","baseState","special","running","ended","xmlMode","decodeEntities","prototype","reset","write","chunk","onerror","Error","parse","end","finish","pause","resume","length","getAbsoluteIndex","stateText","ontext","getSection","stateBeforeTagName","stateInTagName","emitToken","stateBeforeClosingTagName","stateInClosingTagName","stateAfterClosingTagName","stateBeforeAttributeName","onopentagend","stateInSelfClosingTag","onselfclosingtag","stateInAttributeName","onattribname","stateAfterAttributeName","onattribend","undefined","stateBeforeAttributeValue","handleInAttributeValue","quote","stateInAttributeValueDoubleQuotes","stateInAttributeValueSingleQuotes","stateInAttributeValueNoQuotes","stateBeforeDeclaration","stateInDeclaration","ondeclaration","stateInProcessingInstruction","onprocessinginstruction","stateBeforeComment","stateInComment","stateInSpecialComment","oncomment","substring","stateAfterComment1","stateAfterComment2","stateBeforeCdata6","stateInCdata","stateAfterCdata1","stateAfterCdata2","oncdata","stateBeforeSpecialS","stateBeforeSpecialSEnd","stateBeforeSpecialLast","stateAfterSpecialLast","sectionStartOffset","parseFixedEntity","map","default","entity","hasOwnProperty","call","emitPartial","parseLegacyEntity","start","limit","Math","min","substr","stateInNamedEntity","decodeNumericEntity","offset","base","strict","parsed","parseInt","stateInNumericEntity","stateInHexEntity","cleanup","charAt","handleTrailingData","onend","data","name","onattribdata"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\nfunction whitespace(c) {\n    return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\nfunction isASCIIAlpha(c) {\n    return (c >= \"a\" && c <= \"z\") || (c >= \"A\" && c <= \"Z\");\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n    var lower = upper.toLowerCase();\n    if (upper === lower) {\n        return function (t, c) {\n            if (c === lower) {\n                t._state = SUCCESS;\n            }\n            else {\n                t._state = FAILURE;\n                t._index--;\n            }\n        };\n    }\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = SUCCESS;\n        }\n        else {\n            t._state = FAILURE;\n            t._index--;\n        }\n    };\n}\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n    var lower = upper.toLowerCase();\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = NEXT_STATE;\n        }\n        else {\n            t._state = 3 /* InTagName */;\n            t._index--; // Consume the token again\n        }\n    };\n}\nvar stateBeforeCdata1 = ifElseState(\"C\", 24 /* BeforeCdata2 */, 16 /* InDeclaration */);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25 /* BeforeCdata3 */, 16 /* InDeclaration */);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26 /* BeforeCdata4 */, 16 /* InDeclaration */);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27 /* BeforeCdata5 */, 16 /* InDeclaration */);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28 /* BeforeCdata6 */, 16 /* InDeclaration */);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 35 /* BeforeScript2 */);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 36 /* BeforeScript3 */);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 37 /* BeforeScript4 */);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 38 /* BeforeScript5 */);\nvar stateAfterScript1 = ifElseState(\"R\", 40 /* AfterScript2 */, 1 /* Text */);\nvar stateAfterScript2 = ifElseState(\"I\", 41 /* AfterScript3 */, 1 /* Text */);\nvar stateAfterScript3 = ifElseState(\"P\", 42 /* AfterScript4 */, 1 /* Text */);\nvar stateAfterScript4 = ifElseState(\"T\", 43 /* AfterScript5 */, 1 /* Text */);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 45 /* BeforeStyle2 */);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 46 /* BeforeStyle3 */);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 47 /* BeforeStyle4 */);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49 /* AfterStyle2 */, 1 /* Text */);\nvar stateAfterStyle2 = ifElseState(\"L\", 50 /* AfterStyle3 */, 1 /* Text */);\nvar stateAfterStyle3 = ifElseState(\"E\", 51 /* AfterStyle4 */, 1 /* Text */);\nvar stateBeforeSpecialT = consumeSpecialNameChar(\"I\", 54 /* BeforeTitle1 */);\nvar stateBeforeTitle1 = consumeSpecialNameChar(\"T\", 55 /* BeforeTitle2 */);\nvar stateBeforeTitle2 = consumeSpecialNameChar(\"L\", 56 /* BeforeTitle3 */);\nvar stateBeforeTitle3 = consumeSpecialNameChar(\"E\", 57 /* BeforeTitle4 */);\nvar stateAfterSpecialTEnd = ifElseState(\"I\", 58 /* AfterTitle1 */, 1 /* Text */);\nvar stateAfterTitle1 = ifElseState(\"T\", 59 /* AfterTitle2 */, 1 /* Text */);\nvar stateAfterTitle2 = ifElseState(\"L\", 60 /* AfterTitle3 */, 1 /* Text */);\nvar stateAfterTitle3 = ifElseState(\"E\", 61 /* AfterTitle4 */, 1 /* Text */);\nvar stateBeforeEntity = ifElseState(\"#\", 63 /* BeforeNumericEntity */, 64 /* InNamedEntity */);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66 /* InHexEntity */, 65 /* InNumericEntity */);\nvar Tokenizer = /** @class */ (function () {\n    function Tokenizer(options, cbs) {\n        var _a;\n        /** The current state the tokenizer is in. */\n        this._state = 1 /* Text */;\n        /** The read buffer. */\n        this.buffer = \"\";\n        /** The beginning of the section that is currently being read. */\n        this.sectionStart = 0;\n        /** The index within the buffer that we are currently looking at. */\n        this._index = 0;\n        /**\n         * Data that has already been processed will be removed from the buffer occasionally.\n         * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n         */\n        this.bufferOffset = 0;\n        /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n        this.baseState = 1 /* Text */;\n        /** For special parsing behavior inside of script and style tags. */\n        this.special = 1 /* None */;\n        /** Indicates whether the tokenizer has been paused. */\n        this.running = true;\n        /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n        this.ended = false;\n        this.cbs = cbs;\n        this.xmlMode = !!(options === null || options === void 0 ? void 0 : options.xmlMode);\n        this.decodeEntities = (_a = options === null || options === void 0 ? void 0 : options.decodeEntities) !== null && _a !== void 0 ? _a : true;\n    }\n    Tokenizer.prototype.reset = function () {\n        this._state = 1 /* Text */;\n        this.buffer = \"\";\n        this.sectionStart = 0;\n        this._index = 0;\n        this.bufferOffset = 0;\n        this.baseState = 1 /* Text */;\n        this.special = 1 /* None */;\n        this.running = true;\n        this.ended = false;\n    };\n    Tokenizer.prototype.write = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".write() after done!\"));\n        this.buffer += chunk;\n        this.parse();\n    };\n    Tokenizer.prototype.end = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".end() after done!\"));\n        if (chunk)\n            this.write(chunk);\n        this.ended = true;\n        if (this.running)\n            this.finish();\n    };\n    Tokenizer.prototype.pause = function () {\n        this.running = false;\n    };\n    Tokenizer.prototype.resume = function () {\n        this.running = true;\n        if (this._index < this.buffer.length) {\n            this.parse();\n        }\n        if (this.ended) {\n            this.finish();\n        }\n    };\n    /**\n     * The current index within all of the written data.\n     */\n    Tokenizer.prototype.getAbsoluteIndex = function () {\n        return this.bufferOffset + this._index;\n    };\n    Tokenizer.prototype.stateText = function (c) {\n        if (c === \"<\") {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this._state = 2 /* BeforeTagName */;\n            this.sectionStart = this._index;\n        }\n        else if (this.decodeEntities &&\n            c === \"&\" &&\n            (this.special === 1 /* None */ || this.special === 4 /* Title */)) {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this.baseState = 1 /* Text */;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeTagName = function (c) {\n        if (c === \"/\") {\n            this._state = 5 /* BeforeClosingTagName */;\n        }\n        else if (c === \"<\") {\n            this.cbs.ontext(this.getSection());\n            this.sectionStart = this._index;\n        }\n        else if (c === \">\" ||\n            this.special !== 1 /* None */ ||\n            whitespace(c)) {\n            this._state = 1 /* Text */;\n        }\n        else if (c === \"!\") {\n            this._state = 15 /* BeforeDeclaration */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"?\") {\n            this._state = 17 /* InProcessingInstruction */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!isASCIIAlpha(c)) {\n            this._state = 1 /* Text */;\n        }\n        else {\n            this._state =\n                !this.xmlMode && (c === \"s\" || c === \"S\")\n                    ? 32 /* BeforeSpecialS */\n                    : !this.xmlMode && (c === \"t\" || c === \"T\")\n                        ? 52 /* BeforeSpecialT */\n                        : 3 /* InTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInTagName = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.emitToken(\"onopentagname\");\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n        if (whitespace(c)) {\n            // Ignore\n        }\n        else if (c === \">\") {\n            this._state = 1 /* Text */;\n        }\n        else if (this.special !== 1 /* None */) {\n            if (this.special !== 4 /* Title */ && (c === \"s\" || c === \"S\")) {\n                this._state = 33 /* BeforeSpecialSEnd */;\n            }\n            else if (this.special === 4 /* Title */ &&\n                (c === \"t\" || c === \"T\")) {\n                this._state = 53 /* BeforeSpecialTEnd */;\n            }\n            else {\n                this._state = 1 /* Text */;\n                this._index--;\n            }\n        }\n        else if (!isASCIIAlpha(c)) {\n            this._state = 20 /* InSpecialComment */;\n            this.sectionStart = this._index;\n        }\n        else {\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInClosingTagName = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this.emitToken(\"onclosetag\");\n            this._state = 7 /* AfterClosingTagName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n        // Skip everything until \">\"\n        if (c === \">\") {\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n        if (c === \">\") {\n            this.cbs.onopentagend();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"/\") {\n            this._state = 4 /* InSelfClosingTag */;\n        }\n        else if (!whitespace(c)) {\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n        if (c === \">\") {\n            this.cbs.onselfclosingtag();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n            this.special = 1 /* None */; // Reset special state, in case of self-closing special tags\n        }\n        else if (!whitespace(c)) {\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeName = function (c) {\n        if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n            this.cbs.onattribname(this.getSection());\n            this.sectionStart = -1;\n            this._state = 10 /* AfterAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterAttributeName = function (c) {\n        if (c === \"=\") {\n            this._state = 11 /* BeforeAttributeValue */;\n        }\n        else if (c === \"/\" || c === \">\") {\n            this.cbs.onattribend(undefined);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (!whitespace(c)) {\n            this.cbs.onattribend(undefined);\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n        if (c === '\"') {\n            this._state = 12 /* InAttributeValueDq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"'\") {\n            this._state = 13 /* InAttributeValueSq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this._state = 14 /* InAttributeValueNq */;\n            this.sectionStart = this._index;\n            this._index--; // Reconsume token\n        }\n    };\n    Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n        if (c === quote) {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(quote);\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n        this.handleInAttributeValue(c, '\"');\n    };\n    Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n        this.handleInAttributeValue(c, \"'\");\n    };\n    Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n        if (whitespace(c) || c === \">\") {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(null);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n        this._state =\n            c === \"[\"\n                ? 23 /* BeforeCdata1 */\n                : c === \"-\"\n                    ? 18 /* BeforeComment */\n                    : 16 /* InDeclaration */;\n    };\n    Tokenizer.prototype.stateInDeclaration = function (c) {\n        if (c === \">\") {\n            this.cbs.ondeclaration(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n        if (c === \">\") {\n            this.cbs.onprocessinginstruction(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeComment = function (c) {\n        if (c === \"-\") {\n            this._state = 19 /* InComment */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n        }\n    };\n    Tokenizer.prototype.stateInComment = function (c) {\n        if (c === \"-\")\n            this._state = 21 /* AfterComment1 */;\n    };\n    Tokenizer.prototype.stateInSpecialComment = function (c) {\n        if (c === \">\") {\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment1 = function (c) {\n        if (c === \"-\") {\n            this._state = 22 /* AfterComment2 */;\n        }\n        else {\n            this._state = 19 /* InComment */;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"-\") {\n            this._state = 19 /* InComment */;\n        }\n        // Else: stay in AFTER_COMMENT_2 (`--->`)\n    };\n    Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n        if (c === \"[\") {\n            this._state = 29 /* InCdata */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInCdata = function (c) {\n        if (c === \"]\")\n            this._state = 30 /* AfterCdata1 */;\n    };\n    Tokenizer.prototype.stateAfterCdata1 = function (c) {\n        if (c === \"]\")\n            this._state = 31 /* AfterCdata2 */;\n        else\n            this._state = 29 /* InCdata */;\n    };\n    Tokenizer.prototype.stateAfterCdata2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"]\") {\n            this._state = 29 /* InCdata */;\n        }\n        // Else: stay in AFTER_CDATA_2 (`]]]>`)\n    };\n    Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n        if (c === \"c\" || c === \"C\") {\n            this._state = 34 /* BeforeScript1 */;\n        }\n        else if (c === \"t\" || c === \"T\") {\n            this._state = 44 /* BeforeStyle1 */;\n        }\n        else {\n            this._state = 3 /* InTagName */;\n            this._index--; // Consume the token again\n        }\n    };\n    Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n        if (this.special === 2 /* Script */ && (c === \"c\" || c === \"C\")) {\n            this._state = 39 /* AfterScript1 */;\n        }\n        else if (this.special === 3 /* Style */ && (c === \"t\" || c === \"T\")) {\n            this._state = 48 /* AfterStyle1 */;\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.special = special;\n        }\n        this._state = 3 /* InTagName */;\n        this._index--; // Consume the token again\n    };\n    Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n        if (c === \">\" || whitespace(c)) {\n            this.special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index - sectionStartOffset;\n            this._index--; // Reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    // For entities terminated with a semicolon\n    Tokenizer.prototype.parseFixedEntity = function (map) {\n        if (map === void 0) { map = this.xmlMode ? xml_json_1.default : entities_json_1.default; }\n        // Offset = 1\n        if (this.sectionStart + 1 < this._index) {\n            var entity = this.buffer.substring(this.sectionStart + 1, this._index);\n            if (Object.prototype.hasOwnProperty.call(map, entity)) {\n                this.emitPartial(map[entity]);\n                this.sectionStart = this._index + 1;\n            }\n        }\n    };\n    // Parses legacy entities (without trailing semicolon)\n    Tokenizer.prototype.parseLegacyEntity = function () {\n        var start = this.sectionStart + 1;\n        // The max length of legacy entities is 6\n        var limit = Math.min(this._index - start, 6);\n        while (limit >= 2) {\n            // The min length of legacy entities is 2\n            var entity = this.buffer.substr(start, limit);\n            if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n                this.emitPartial(legacy_json_1.default[entity]);\n                this.sectionStart += limit + 1;\n                return;\n            }\n            limit--;\n        }\n    };\n    Tokenizer.prototype.stateInNamedEntity = function (c) {\n        if (c === \";\") {\n            this.parseFixedEntity();\n            // Retry as legacy entity if entity wasn't parsed\n            if (this.baseState === 1 /* Text */ &&\n                this.sectionStart + 1 < this._index &&\n                !this.xmlMode) {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n        }\n        else if ((c < \"0\" || c > \"9\") && !isASCIIAlpha(c)) {\n            if (this.xmlMode || this.sectionStart + 1 === this._index) {\n                // Ignore\n            }\n            else if (this.baseState !== 1 /* Text */) {\n                if (c !== \"=\") {\n                    // Parse as legacy entity, without allowing additional characters.\n                    this.parseFixedEntity(legacy_json_1.default);\n                }\n            }\n            else {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.decodeNumericEntity = function (offset, base, strict) {\n        var sectionStart = this.sectionStart + offset;\n        if (sectionStart !== this._index) {\n            // Parse entity\n            var entity = this.buffer.substring(sectionStart, this._index);\n            var parsed = parseInt(entity, base);\n            this.emitPartial(decode_codepoint_1.default(parsed));\n            this.sectionStart = strict ? this._index + 1 : this._index;\n        }\n        this._state = this.baseState;\n    };\n    Tokenizer.prototype.stateInNumericEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(2, 10, true);\n        }\n        else if (c < \"0\" || c > \"9\") {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(2, 10, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInHexEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(3, 16, true);\n        }\n        else if ((c < \"a\" || c > \"f\") &&\n            (c < \"A\" || c > \"F\") &&\n            (c < \"0\" || c > \"9\")) {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(3, 16, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.cleanup = function () {\n        if (this.sectionStart < 0) {\n            this.buffer = \"\";\n            this.bufferOffset += this._index;\n            this._index = 0;\n        }\n        else if (this.running) {\n            if (this._state === 1 /* Text */) {\n                if (this.sectionStart !== this._index) {\n                    this.cbs.ontext(this.buffer.substr(this.sectionStart));\n                }\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else if (this.sectionStart === this._index) {\n                // The section just started\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else {\n                // Remove everything unnecessary\n                this.buffer = this.buffer.substr(this.sectionStart);\n                this._index -= this.sectionStart;\n                this.bufferOffset += this.sectionStart;\n            }\n            this.sectionStart = 0;\n        }\n    };\n    /**\n     * Iterates through the buffer, calling the function corresponding to the current state.\n     *\n     * States that are more likely to be hit are higher up, as a performance improvement.\n     */\n    Tokenizer.prototype.parse = function () {\n        while (this._index < this.buffer.length && this.running) {\n            var c = this.buffer.charAt(this._index);\n            if (this._state === 1 /* Text */) {\n                this.stateText(c);\n            }\n            else if (this._state === 12 /* InAttributeValueDq */) {\n                this.stateInAttributeValueDoubleQuotes(c);\n            }\n            else if (this._state === 9 /* InAttributeName */) {\n                this.stateInAttributeName(c);\n            }\n            else if (this._state === 19 /* InComment */) {\n                this.stateInComment(c);\n            }\n            else if (this._state === 20 /* InSpecialComment */) {\n                this.stateInSpecialComment(c);\n            }\n            else if (this._state === 8 /* BeforeAttributeName */) {\n                this.stateBeforeAttributeName(c);\n            }\n            else if (this._state === 3 /* InTagName */) {\n                this.stateInTagName(c);\n            }\n            else if (this._state === 6 /* InClosingTagName */) {\n                this.stateInClosingTagName(c);\n            }\n            else if (this._state === 2 /* BeforeTagName */) {\n                this.stateBeforeTagName(c);\n            }\n            else if (this._state === 10 /* AfterAttributeName */) {\n                this.stateAfterAttributeName(c);\n            }\n            else if (this._state === 13 /* InAttributeValueSq */) {\n                this.stateInAttributeValueSingleQuotes(c);\n            }\n            else if (this._state === 11 /* BeforeAttributeValue */) {\n                this.stateBeforeAttributeValue(c);\n            }\n            else if (this._state === 5 /* BeforeClosingTagName */) {\n                this.stateBeforeClosingTagName(c);\n            }\n            else if (this._state === 7 /* AfterClosingTagName */) {\n                this.stateAfterClosingTagName(c);\n            }\n            else if (this._state === 32 /* BeforeSpecialS */) {\n                this.stateBeforeSpecialS(c);\n            }\n            else if (this._state === 21 /* AfterComment1 */) {\n                this.stateAfterComment1(c);\n            }\n            else if (this._state === 14 /* InAttributeValueNq */) {\n                this.stateInAttributeValueNoQuotes(c);\n            }\n            else if (this._state === 4 /* InSelfClosingTag */) {\n                this.stateInSelfClosingTag(c);\n            }\n            else if (this._state === 16 /* InDeclaration */) {\n                this.stateInDeclaration(c);\n            }\n            else if (this._state === 15 /* BeforeDeclaration */) {\n                this.stateBeforeDeclaration(c);\n            }\n            else if (this._state === 22 /* AfterComment2 */) {\n                this.stateAfterComment2(c);\n            }\n            else if (this._state === 18 /* BeforeComment */) {\n                this.stateBeforeComment(c);\n            }\n            else if (this._state === 33 /* BeforeSpecialSEnd */) {\n                this.stateBeforeSpecialSEnd(c);\n            }\n            else if (this._state === 53 /* BeforeSpecialTEnd */) {\n                stateAfterSpecialTEnd(this, c);\n            }\n            else if (this._state === 39 /* AfterScript1 */) {\n                stateAfterScript1(this, c);\n            }\n            else if (this._state === 40 /* AfterScript2 */) {\n                stateAfterScript2(this, c);\n            }\n            else if (this._state === 41 /* AfterScript3 */) {\n                stateAfterScript3(this, c);\n            }\n            else if (this._state === 34 /* BeforeScript1 */) {\n                stateBeforeScript1(this, c);\n            }\n            else if (this._state === 35 /* BeforeScript2 */) {\n                stateBeforeScript2(this, c);\n            }\n            else if (this._state === 36 /* BeforeScript3 */) {\n                stateBeforeScript3(this, c);\n            }\n            else if (this._state === 37 /* BeforeScript4 */) {\n                stateBeforeScript4(this, c);\n            }\n            else if (this._state === 38 /* BeforeScript5 */) {\n                this.stateBeforeSpecialLast(c, 2 /* Script */);\n            }\n            else if (this._state === 42 /* AfterScript4 */) {\n                stateAfterScript4(this, c);\n            }\n            else if (this._state === 43 /* AfterScript5 */) {\n                this.stateAfterSpecialLast(c, 6);\n            }\n            else if (this._state === 44 /* BeforeStyle1 */) {\n                stateBeforeStyle1(this, c);\n            }\n            else if (this._state === 29 /* InCdata */) {\n                this.stateInCdata(c);\n            }\n            else if (this._state === 45 /* BeforeStyle2 */) {\n                stateBeforeStyle2(this, c);\n            }\n            else if (this._state === 46 /* BeforeStyle3 */) {\n                stateBeforeStyle3(this, c);\n            }\n            else if (this._state === 47 /* BeforeStyle4 */) {\n                this.stateBeforeSpecialLast(c, 3 /* Style */);\n            }\n            else if (this._state === 48 /* AfterStyle1 */) {\n                stateAfterStyle1(this, c);\n            }\n            else if (this._state === 49 /* AfterStyle2 */) {\n                stateAfterStyle2(this, c);\n            }\n            else if (this._state === 50 /* AfterStyle3 */) {\n                stateAfterStyle3(this, c);\n            }\n            else if (this._state === 51 /* AfterStyle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 52 /* BeforeSpecialT */) {\n                stateBeforeSpecialT(this, c);\n            }\n            else if (this._state === 54 /* BeforeTitle1 */) {\n                stateBeforeTitle1(this, c);\n            }\n            else if (this._state === 55 /* BeforeTitle2 */) {\n                stateBeforeTitle2(this, c);\n            }\n            else if (this._state === 56 /* BeforeTitle3 */) {\n                stateBeforeTitle3(this, c);\n            }\n            else if (this._state === 57 /* BeforeTitle4 */) {\n                this.stateBeforeSpecialLast(c, 4 /* Title */);\n            }\n            else if (this._state === 58 /* AfterTitle1 */) {\n                stateAfterTitle1(this, c);\n            }\n            else if (this._state === 59 /* AfterTitle2 */) {\n                stateAfterTitle2(this, c);\n            }\n            else if (this._state === 60 /* AfterTitle3 */) {\n                stateAfterTitle3(this, c);\n            }\n            else if (this._state === 61 /* AfterTitle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 17 /* InProcessingInstruction */) {\n                this.stateInProcessingInstruction(c);\n            }\n            else if (this._state === 64 /* InNamedEntity */) {\n                this.stateInNamedEntity(c);\n            }\n            else if (this._state === 23 /* BeforeCdata1 */) {\n                stateBeforeCdata1(this, c);\n            }\n            else if (this._state === 62 /* BeforeEntity */) {\n                stateBeforeEntity(this, c);\n            }\n            else if (this._state === 24 /* BeforeCdata2 */) {\n                stateBeforeCdata2(this, c);\n            }\n            else if (this._state === 25 /* BeforeCdata3 */) {\n                stateBeforeCdata3(this, c);\n            }\n            else if (this._state === 30 /* AfterCdata1 */) {\n                this.stateAfterCdata1(c);\n            }\n            else if (this._state === 31 /* AfterCdata2 */) {\n                this.stateAfterCdata2(c);\n            }\n            else if (this._state === 26 /* BeforeCdata4 */) {\n                stateBeforeCdata4(this, c);\n            }\n            else if (this._state === 27 /* BeforeCdata5 */) {\n                stateBeforeCdata5(this, c);\n            }\n            else if (this._state === 28 /* BeforeCdata6 */) {\n                this.stateBeforeCdata6(c);\n            }\n            else if (this._state === 66 /* InHexEntity */) {\n                this.stateInHexEntity(c);\n            }\n            else if (this._state === 65 /* InNumericEntity */) {\n                this.stateInNumericEntity(c);\n                // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n            }\n            else if (this._state === 63 /* BeforeNumericEntity */) {\n                stateBeforeNumericEntity(this, c);\n            }\n            else {\n                this.cbs.onerror(Error(\"unknown _state\"), this._state);\n            }\n            this._index++;\n        }\n        this.cleanup();\n    };\n    Tokenizer.prototype.finish = function () {\n        // If there is remaining data, emit it in a reasonable way\n        if (this.sectionStart < this._index) {\n            this.handleTrailingData();\n        }\n        this.cbs.onend();\n    };\n    Tokenizer.prototype.handleTrailingData = function () {\n        var data = this.buffer.substr(this.sectionStart);\n        if (this._state === 29 /* InCdata */ ||\n            this._state === 30 /* AfterCdata1 */ ||\n            this._state === 31 /* AfterCdata2 */) {\n            this.cbs.oncdata(data);\n        }\n        else if (this._state === 19 /* InComment */ ||\n            this._state === 21 /* AfterComment1 */ ||\n            this._state === 22 /* AfterComment2 */) {\n            this.cbs.oncomment(data);\n        }\n        else if (this._state === 64 /* InNamedEntity */ && !this.xmlMode) {\n            this.parseLegacyEntity();\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 65 /* InNumericEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(2, 10, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 66 /* InHexEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(3, 16, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state !== 3 /* InTagName */ &&\n            this._state !== 8 /* BeforeAttributeName */ &&\n            this._state !== 11 /* BeforeAttributeValue */ &&\n            this._state !== 10 /* AfterAttributeName */ &&\n            this._state !== 9 /* InAttributeName */ &&\n            this._state !== 13 /* InAttributeValueSq */ &&\n            this._state !== 12 /* InAttributeValueDq */ &&\n            this._state !== 14 /* InAttributeValueNq */ &&\n            this._state !== 6 /* InClosingTagName */) {\n            this.cbs.ontext(data);\n        }\n        /*\n         * Else, ignore remaining data\n         * TODO add a way to remove current tag\n         */\n    };\n    Tokenizer.prototype.getSection = function () {\n        return this.buffer.substring(this.sectionStart, this._index);\n    };\n    Tokenizer.prototype.emitToken = function (name) {\n        this.cbs[name](this.getSection());\n        this.sectionStart = -1;\n    };\n    Tokenizer.prototype.emitPartial = function (value) {\n        if (this.baseState !== 1 /* Text */) {\n            this.cbs.onattribdata(value); // TODO implement the new event\n        }\n        else {\n            this.cbs.ontext(value);\n        }\n    };\n    return Tokenizer;\n}());\nexports.default = Tokenizer;\n"]}