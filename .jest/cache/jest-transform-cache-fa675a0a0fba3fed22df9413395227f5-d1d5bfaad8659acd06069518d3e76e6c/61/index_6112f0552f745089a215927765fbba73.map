{"version":3,"sources":["index.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","default","fsmIterator","initialState","definition","fsm","currentState","done","returnValue","handledReturn","setReturnValue","value","consumeReturnValue","_returnValue","undefined","processResult","result","handlerName","next","errorMessage","Error","previousState","iterator","throw","_throw","e","return","_return","Symbol"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = fsmIterator;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction fsmIterator(initialState, definition) {\n  var fsm = _extends({}, definition);\n\n  var currentState = initialState;\n  var done = false;\n  var returnValue = void 0;\n  var handledReturn = false;\n\n  function setReturnValue(value) {\n    returnValue = { value: value };\n  }\n\n  function consumeReturnValue() {\n    if (returnValue) {\n      var _returnValue = returnValue,\n          value = _returnValue.value;\n\n      returnValue = undefined;\n\n      return value;\n    }\n\n    return undefined;\n  }\n\n  function processResult(result, handlerName) {\n    if (done) {\n      if (returnValue) {\n        return {\n          value: consumeReturnValue(),\n          done: true\n        };\n      }\n\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n\n    if (result.next && result.done) {\n      var errorMessage = 'You supplied a next state while specifying to end ' + 'the iterator. This is more than likely an accident. ' + ('Please check your \"' + handlerName + '\" handler.');\n\n      throw new Error(errorMessage);\n    }\n\n    fsm.previousState = currentState;\n    currentState = result.next || currentState;\n    done = !!result.done;\n\n    if (done && hasOwnProperty.call(result, 'value')) {\n      consumeReturnValue();\n\n      return {\n        value: result.value,\n        done: true\n      };\n    }\n\n    if (done && returnValue) {\n      return {\n        value: consumeReturnValue(),\n        done: true\n      };\n    }\n\n    return {\n      value: result.value,\n      done: done\n    };\n  }\n\n  var iterator = {\n    next: function next(value) {\n      if (!hasOwnProperty.call(fsm, currentState)) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      var result = fsm[currentState](value, fsm);\n      return processResult(result, currentState);\n    },\n    throw: function _throw(e) {\n      if (!hasOwnProperty.call(fsm, 'throw')) {\n        throw e;\n      }\n\n      var result = fsm.throw(e, fsm);\n      return processResult(result, 'throw');\n    },\n    return: function _return(value) {\n      if (!returnValue) {\n        setReturnValue(value);\n      }\n\n      if (!handledReturn && hasOwnProperty.call(fsm, 'return')) {\n        handledReturn = true;\n\n        var result = fsm.return(value, fsm);\n        return processResult(result, 'return');\n      }\n\n      if (returnValue) {\n        return {\n          value: consumeReturnValue(),\n          done: true\n        };\n      }\n\n      return {\n        value: value,\n        done: true\n      };\n    }\n  };\n\n  if (typeof Symbol === 'function' && Symbol.iterator) {\n    iterator[Symbol.iterator] = function () {\n      return iterator;\n    };\n  }\n\n  return iterator;\n}"]}