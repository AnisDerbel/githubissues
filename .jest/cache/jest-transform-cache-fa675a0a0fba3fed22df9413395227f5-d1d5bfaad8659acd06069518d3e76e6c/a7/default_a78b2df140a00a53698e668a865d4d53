53a4e0cada6bb19cf04bbf4fbcf715b5
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _require = require('../common/html'),
    DOCUMENT_MODE = _require.DOCUMENT_MODE;

exports.createDocument = function () {
  return {
    nodeName: '#document',
    mode: DOCUMENT_MODE.NO_QUIRKS,
    childNodes: []
  };
};

exports.createDocumentFragment = function () {
  return {
    nodeName: '#document-fragment',
    childNodes: []
  };
};

exports.createElement = function (tagName, namespaceURI, attrs) {
  return {
    nodeName: tagName,
    tagName: tagName,
    attrs: attrs,
    namespaceURI: namespaceURI,
    childNodes: [],
    parentNode: null
  };
};

exports.createCommentNode = function (data) {
  return {
    nodeName: '#comment',
    data: data,
    parentNode: null
  };
};

var createTextNode = function createTextNode(value) {
  return {
    nodeName: '#text',
    value: value,
    parentNode: null
  };
};

var appendChild = exports.appendChild = function (parentNode, newNode) {
  parentNode.childNodes.push(newNode);
  newNode.parentNode = parentNode;
};

var insertBefore = exports.insertBefore = function (parentNode, newNode, referenceNode) {
  var insertionIdx = parentNode.childNodes.indexOf(referenceNode);
  parentNode.childNodes.splice(insertionIdx, 0, newNode);
  newNode.parentNode = parentNode;
};

exports.setTemplateContent = function (templateElement, contentElement) {
  templateElement.content = contentElement;
};

exports.getTemplateContent = function (templateElement) {
  return templateElement.content;
};

exports.setDocumentType = function (document, name, publicId, systemId) {
  var doctypeNode = null;

  for (var i = 0; i < document.childNodes.length; i++) {
    if (document.childNodes[i].nodeName === '#documentType') {
      doctypeNode = document.childNodes[i];
      break;
    }
  }

  if (doctypeNode) {
    doctypeNode.name = name;
    doctypeNode.publicId = publicId;
    doctypeNode.systemId = systemId;
  } else {
    appendChild(document, {
      nodeName: '#documentType',
      name: name,
      publicId: publicId,
      systemId: systemId
    });
  }
};

exports.setDocumentMode = function (document, mode) {
  document.mode = mode;
};

exports.getDocumentMode = function (document) {
  return document.mode;
};

exports.detachNode = function (node) {
  if (node.parentNode) {
    var idx = node.parentNode.childNodes.indexOf(node);
    node.parentNode.childNodes.splice(idx, 1);
    node.parentNode = null;
  }
};

exports.insertText = function (parentNode, text) {
  if (parentNode.childNodes.length) {
    var prevNode = parentNode.childNodes[parentNode.childNodes.length - 1];

    if (prevNode.nodeName === '#text') {
      prevNode.value += text;
      return;
    }
  }

  appendChild(parentNode, createTextNode(text));
};

exports.insertTextBefore = function (parentNode, text, referenceNode) {
  var prevNode = parentNode.childNodes[parentNode.childNodes.indexOf(referenceNode) - 1];

  if (prevNode && prevNode.nodeName === '#text') {
    prevNode.value += text;
  } else {
    insertBefore(parentNode, createTextNode(text), referenceNode);
  }
};

exports.adoptAttributes = function (recipient, attrs) {
  var recipientAttrsMap = [];

  for (var i = 0; i < recipient.attrs.length; i++) {
    recipientAttrsMap.push(recipient.attrs[i].name);
  }

  for (var j = 0; j < attrs.length; j++) {
    if (recipientAttrsMap.indexOf(attrs[j].name) === -1) {
      recipient.attrs.push(attrs[j]);
    }
  }
};

exports.getFirstChild = function (node) {
  return node.childNodes[0];
};

exports.getChildNodes = function (node) {
  return node.childNodes;
};

exports.getParentNode = function (node) {
  return node.parentNode;
};

exports.getAttrList = function (element) {
  return element.attrs;
};

exports.getTagName = function (element) {
  return element.tagName;
};

exports.getNamespaceURI = function (element) {
  return element.namespaceURI;
};

exports.getTextNodeContent = function (textNode) {
  return textNode.value;
};

exports.getCommentNodeContent = function (commentNode) {
  return commentNode.data;
};

exports.getDocumentTypeNodeName = function (doctypeNode) {
  return doctypeNode.name;
};

exports.getDocumentTypeNodePublicId = function (doctypeNode) {
  return doctypeNode.publicId;
};

exports.getDocumentTypeNodeSystemId = function (doctypeNode) {
  return doctypeNode.systemId;
};

exports.isTextNode = function (node) {
  return node.nodeName === '#text';
};

exports.isCommentNode = function (node) {
  return node.nodeName === '#comment';
};

exports.isDocumentTypeNode = function (node) {
  return node.nodeName === '#documentType';
};

exports.isElementNode = function (node) {
  return !!node.tagName;
};

exports.setNodeSourceCodeLocation = function (node, location) {
  node.sourceCodeLocation = location;
};

exports.getNodeSourceCodeLocation = function (node) {
  return node.sourceCodeLocation;
};

exports.updateNodeSourceCodeLocation = function (node, endLocation) {
  node.sourceCodeLocation = (0, _extends2.default)(node.sourceCodeLocation, endLocation);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlZmF1bHQuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsIkRPQ1VNRU5UX01PREUiLCJleHBvcnRzIiwiY3JlYXRlRG9jdW1lbnQiLCJub2RlTmFtZSIsIm1vZGUiLCJOT19RVUlSS1MiLCJjaGlsZE5vZGVzIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0YWdOYW1lIiwibmFtZXNwYWNlVVJJIiwiYXR0cnMiLCJwYXJlbnROb2RlIiwiY3JlYXRlQ29tbWVudE5vZGUiLCJkYXRhIiwiY3JlYXRlVGV4dE5vZGUiLCJ2YWx1ZSIsImFwcGVuZENoaWxkIiwibmV3Tm9kZSIsInB1c2giLCJpbnNlcnRCZWZvcmUiLCJyZWZlcmVuY2VOb2RlIiwiaW5zZXJ0aW9uSWR4IiwiaW5kZXhPZiIsInNwbGljZSIsInNldFRlbXBsYXRlQ29udGVudCIsInRlbXBsYXRlRWxlbWVudCIsImNvbnRlbnRFbGVtZW50IiwiY29udGVudCIsImdldFRlbXBsYXRlQ29udGVudCIsInNldERvY3VtZW50VHlwZSIsImRvY3VtZW50IiwibmFtZSIsInB1YmxpY0lkIiwic3lzdGVtSWQiLCJkb2N0eXBlTm9kZSIsImkiLCJsZW5ndGgiLCJzZXREb2N1bWVudE1vZGUiLCJnZXREb2N1bWVudE1vZGUiLCJkZXRhY2hOb2RlIiwibm9kZSIsImlkeCIsImluc2VydFRleHQiLCJ0ZXh0IiwicHJldk5vZGUiLCJpbnNlcnRUZXh0QmVmb3JlIiwiYWRvcHRBdHRyaWJ1dGVzIiwicmVjaXBpZW50IiwicmVjaXBpZW50QXR0cnNNYXAiLCJqIiwiZ2V0Rmlyc3RDaGlsZCIsImdldENoaWxkTm9kZXMiLCJnZXRQYXJlbnROb2RlIiwiZ2V0QXR0ckxpc3QiLCJlbGVtZW50IiwiZ2V0VGFnTmFtZSIsImdldE5hbWVzcGFjZVVSSSIsImdldFRleHROb2RlQ29udGVudCIsInRleHROb2RlIiwiZ2V0Q29tbWVudE5vZGVDb250ZW50IiwiY29tbWVudE5vZGUiLCJnZXREb2N1bWVudFR5cGVOb2RlTmFtZSIsImdldERvY3VtZW50VHlwZU5vZGVQdWJsaWNJZCIsImdldERvY3VtZW50VHlwZU5vZGVTeXN0ZW1JZCIsImlzVGV4dE5vZGUiLCJpc0NvbW1lbnROb2RlIiwiaXNEb2N1bWVudFR5cGVOb2RlIiwiaXNFbGVtZW50Tm9kZSIsInNldE5vZGVTb3VyY2VDb2RlTG9jYXRpb24iLCJsb2NhdGlvbiIsInNvdXJjZUNvZGVMb2NhdGlvbiIsImdldE5vZGVTb3VyY2VDb2RlTG9jYXRpb24iLCJ1cGRhdGVOb2RlU291cmNlQ29kZUxvY2F0aW9uIiwiZW5kTG9jYXRpb24iXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7ZUFFMEJBLE9BQU8sQ0FBQyxnQkFBRCxDO0lBQXpCQyxhLFlBQUFBLGE7O0FBR1JDLE9BQU8sQ0FBQ0MsY0FBUixHQUF5QixZQUFXO0FBQ2hDLFNBQU87QUFDSEMsSUFBQUEsUUFBUSxFQUFFLFdBRFA7QUFFSEMsSUFBQUEsSUFBSSxFQUFFSixhQUFhLENBQUNLLFNBRmpCO0FBR0hDLElBQUFBLFVBQVUsRUFBRTtBQUhULEdBQVA7QUFLSCxDQU5EOztBQVFBTCxPQUFPLENBQUNNLHNCQUFSLEdBQWlDLFlBQVc7QUFDeEMsU0FBTztBQUNISixJQUFBQSxRQUFRLEVBQUUsb0JBRFA7QUFFSEcsSUFBQUEsVUFBVSxFQUFFO0FBRlQsR0FBUDtBQUlILENBTEQ7O0FBT0FMLE9BQU8sQ0FBQ08sYUFBUixHQUF3QixVQUFTQyxPQUFULEVBQWtCQyxZQUFsQixFQUFnQ0MsS0FBaEMsRUFBdUM7QUFDM0QsU0FBTztBQUNIUixJQUFBQSxRQUFRLEVBQUVNLE9BRFA7QUFFSEEsSUFBQUEsT0FBTyxFQUFFQSxPQUZOO0FBR0hFLElBQUFBLEtBQUssRUFBRUEsS0FISjtBQUlIRCxJQUFBQSxZQUFZLEVBQUVBLFlBSlg7QUFLSEosSUFBQUEsVUFBVSxFQUFFLEVBTFQ7QUFNSE0sSUFBQUEsVUFBVSxFQUFFO0FBTlQsR0FBUDtBQVFILENBVEQ7O0FBV0FYLE9BQU8sQ0FBQ1ksaUJBQVIsR0FB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QUFuQjtBQUNILENBRkQ7O0FBS0FqQyxPQUFPLENBQUNnRSxVQUFSLEdBQXFCLFVBQVN4QixJQUFULEVBQWU7QUFDaEMsU0FBT0EsSUFBSSxDQUFDdEMsUUFBTCxLQUFrQixPQUF6QjtBQUNILENBRkQ7O0FBSUFGLE9BQU8sQ0FBQ2lFLGFBQVIsR0FBd0IsVUFBU3pCLElBQVQsRUFBZTtBQUNuQyxTQUFPQSxJQUFJLENBQUN0QyxRQUFMLEtBQWtCLFVBQXpCO0FBQ0gsQ0FGRDs7QUFJQUYsT0FBTyxDQUFDa0Usa0JBQVIsR0FBNkIsVUFBUzFCLElBQVQsRUFBZTtBQUN4QyxTQUFPQSxJQUFJLENBQUN0QyxRQUFMLEtBQWtCLGVBQXpCO0FBQ0gsQ0FGRDs7QUFJQUYsT0FBTyxDQUFDbUUsYUFBUixHQUF3QixVQUFTM0IsSUFBVCxFQUFlO0FBQ25DLFNBQU8sQ0FBQyxDQUFDQSxJQUFJLENBQUNoQyxPQUFkO0FBQ0gsQ0FGRDs7QUFLQVIsT0FBTyxDQUFDb0UseUJBQVIsR0FBb0MsVUFBUzVCLElBQVQsRUFBZTZCLFFBQWYsRUFBeUI7QUFDekQ3QixFQUFBQSxJQUFJLENBQUM4QixrQkFBTCxHQUEwQkQsUUFBMUI7QUFDSCxDQUZEOztBQUlBckUsT0FBTyxDQUFDdUUseUJBQVIsR0FBb0MsVUFBUy9CLElBQVQsRUFBZTtBQUMvQyxTQUFPQSxJQUFJLENBQUM4QixrQkFBWjtBQUNILENBRkQ7O0FBSUF0RSxPQUFPLENBQUN3RSw0QkFBUixHQUF1QyxVQUFTaEMsSUFBVCxFQUFlaUMsV0FBZixFQUE0QjtBQUMvRGpDLEVBQUFBLElBQUksQ0FBQzhCLGtCQUFMLEdBQTBCLHVCQUFjOUIsSUFBSSxDQUFDOEIsa0JBQW5CLEVBQXVDRyxXQUF2QyxDQUExQjtBQUNILENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHsgRE9DVU1FTlRfTU9ERSB9ID0gcmVxdWlyZSgnLi4vY29tbW9uL2h0bWwnKTtcblxuLy9Ob2RlIGNvbnN0cnVjdGlvblxuZXhwb3J0cy5jcmVhdGVEb2N1bWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5vZGVOYW1lOiAnI2RvY3VtZW50JyxcbiAgICAgICAgbW9kZTogRE9DVU1FTlRfTU9ERS5OT19RVUlSS1MsXG4gICAgICAgIGNoaWxkTm9kZXM6IFtdXG4gICAgfTtcbn07XG5cbmV4cG9ydHMuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5vZGVOYW1lOiAnI2RvY3VtZW50LWZyYWdtZW50JyxcbiAgICAgICAgY2hpbGROb2RlczogW11cbiAgICB9O1xufTtcblxuZXhwb3J0cy5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24odGFnTmFtZSwgbmFtZXNwYWNlVVJJLCBhdHRycykge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5vZGVOYW1lOiB0YWdOYW1lLFxuICAgICAgICB0YWdOYW1lOiB0YWdOYW1lLFxuICAgICAgICBhdHRyczogYXR0cnMsXG4gICAgICAgIG5hbWVzcGFjZVVSSTogbmFtZXNwYWNlVVJJLFxuICAgICAgICBjaGlsZE5vZGVzOiBbXSxcbiAgICAgICAgcGFyZW50Tm9kZTogbnVsbFxuICAgIH07XG59O1xuXG5leHBvcnRzLmNyZWF0ZUNvbW1lbnROb2RlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5vZGVOYW1lOiAnI2NvbW1lbnQnLFxuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICBwYXJlbnROb2RlOiBudWxsXG4gICAgfTtcbn07XG5cbmNvbnN0IGNyZWF0ZVRleHROb2RlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBub2RlTmFtZTogJyN0ZXh0JyxcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBwYXJlbnROb2RlOiBudWxsXG4gICAgfTtcbn07XG5cbi8vVHJlZSBtdXRhdGlvblxuY29uc3QgYXBwZW5kQ2hpbGQgPSAoZXhwb3J0cy5hcHBlbmRDaGlsZCA9IGZ1bmN0aW9uKHBhcmVudE5vZGUsIG5ld05vZGUpIHtcbiAgICBwYXJlbnROb2RlLmNoaWxkTm9kZXMucHVzaChuZXdOb2RlKTtcbiAgICBuZXdOb2RlLnBhcmVudE5vZGUgPSBwYXJlbnROb2RlO1xufSk7XG5cbmNvbnN0IGluc2VydEJlZm9yZSA9IChleHBvcnRzLmluc2VydEJlZm9yZSA9IGZ1bmN0aW9uKHBhcmVudE5vZGUsIG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpIHtcbiAgICBjb25zdCBpbnNlcnRpb25JZHggPSBwYXJlbnROb2RlLmNoaWxkTm9kZXMuaW5kZXhPZihyZWZlcmVuY2VOb2RlKTtcblxuICAgIHBhcmVudE5vZGUuY2hpbGROb2Rlcy5zcGxpY2UoaW5zZXJ0aW9uSWR4LCAwLCBuZXdOb2RlKTtcbiAgICBuZXdOb2RlLnBhcmVudE5vZGUgPSBwYXJlbnROb2RlO1xufSk7XG5cbmV4cG9ydHMuc2V0VGVtcGxhdGVDb250ZW50ID0gZnVuY3Rpb24odGVtcGxhdGVFbGVtZW50LCBjb250ZW50RWxlbWVudCkge1xuICAgIHRlbXBsYXRlRWxlbWVudC5jb250ZW50ID0gY29udGVudEVsZW1lbnQ7XG59O1xuXG5leHBvcnRzLmdldFRlbXBsYXRlQ29udGVudCA9IGZ1bmN0aW9uKHRlbXBsYXRlRWxlbWVudCkge1xuICAgIHJldHVybiB0ZW1wbGF0ZUVsZW1lbnQuY29udGVudDtcbn07XG5cbmV4cG9ydHMuc2V0RG9jdW1lbnRUeXBlID0gZnVuY3Rpb24oZG9jdW1lbnQsIG5hbWUsIHB1YmxpY0lkLCBzeXN0ZW1JZCkge1xuICAgIGxldCBkb2N0eXBlTm9kZSA9IG51bGw7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRvY3VtZW50LmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmNoaWxkTm9kZXNbaV0ubm9kZU5hbWUgPT09ICcjZG9jdW1lbnRUeXBlJykge1xuICAgICAgICAgICAgZG9jdHlwZU5vZGUgPSBkb2N1bWVudC5jaGlsZE5vZGVzW2ldO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZG9jdHlwZU5vZGUpIHtcbiAgICAgICAgZG9jdHlwZU5vZGUubmFtZSA9IG5hbWU7XG4gICAgICAgIGRvY3R5cGVOb2RlLnB1YmxpY0lkID0gcHVibGljSWQ7XG4gICAgICAgIGRvY3R5cGVOb2RlLnN5c3RlbUlkID0gc3lzdGVtSWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXBwZW5kQ2hpbGQoZG9jdW1lbnQsIHtcbiAgICAgICAgICAgIG5vZGVOYW1lOiAnI2RvY3VtZW50VHlwZScsXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgcHVibGljSWQ6IHB1YmxpY0lkLFxuICAgICAgICAgICAgc3lzdGVtSWQ6IHN5c3RlbUlkXG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbmV4cG9ydHMuc2V0RG9jdW1lbnRNb2RlID0gZnVuY3Rpb24oZG9jdW1lbnQsIG1vZGUpIHtcbiAgICBkb2N1bWVudC5tb2RlID0gbW9kZTtcbn07XG5cbmV4cG9ydHMuZ2V0RG9jdW1lbnRNb2RlID0gZnVuY3Rpb24oZG9jdW1lbnQpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQubW9kZTtcbn07XG5cbmV4cG9ydHMuZGV0YWNoTm9kZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICAgIGNvbnN0IGlkeCA9IG5vZGUucGFyZW50Tm9kZS5jaGlsZE5vZGVzLmluZGV4T2Yobm9kZSk7XG5cbiAgICAgICAgbm9kZS5wYXJlbnROb2RlLmNoaWxkTm9kZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIG5vZGUucGFyZW50Tm9kZSA9IG51bGw7XG4gICAgfVxufTtcblxuZXhwb3J0cy5pbnNlcnRUZXh0ID0gZnVuY3Rpb24ocGFyZW50Tm9kZSwgdGV4dCkge1xuICAgIGlmIChwYXJlbnROb2RlLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHByZXZOb2RlID0gcGFyZW50Tm9kZS5jaGlsZE5vZGVzW3BhcmVudE5vZGUuY2hpbGROb2Rlcy5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAocHJldk5vZGUubm9kZU5hbWUgPT09ICcjdGV4dCcpIHtcbiAgICAgICAgICAgIHByZXZOb2RlLnZhbHVlICs9IHRleHQ7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhcHBlbmRDaGlsZChwYXJlbnROb2RlLCBjcmVhdGVUZXh0Tm9kZSh0ZXh0KSk7XG59O1xuXG5leHBvcnRzLmluc2VydFRleHRCZWZvcmUgPSBmdW5jdGlvbihwYXJlbnROb2RlLCB0ZXh0LCByZWZlcmVuY2VOb2RlKSB7XG4gICAgY29uc3QgcHJldk5vZGUgPSBwYXJlbnROb2RlLmNoaWxkTm9kZXNbcGFyZW50Tm9kZS5jaGlsZE5vZGVzLmluZGV4T2YocmVmZXJlbmNlTm9kZSkgLSAxXTtcblxuICAgIGlmIChwcmV2Tm9kZSAmJiBwcmV2Tm9kZS5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykge1xuICAgICAgICBwcmV2Tm9kZS52YWx1ZSArPSB0ZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGluc2VydEJlZm9yZShwYXJlbnROb2RlLCBjcmVhdGVUZXh0Tm9kZSh0ZXh0KSwgcmVmZXJlbmNlTm9kZSk7XG4gICAgfVxufTtcblxuZXhwb3J0cy5hZG9wdEF0dHJpYnV0ZXMgPSBmdW5jdGlvbihyZWNpcGllbnQsIGF0dHJzKSB7XG4gICAgY29uc3QgcmVjaXBpZW50QXR0cnNNYXAgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVjaXBpZW50LmF0dHJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHJlY2lwaWVudEF0dHJzTWFwLnB1c2gocmVjaXBpZW50LmF0dHJzW2ldLm5hbWUpO1xuICAgIH1cblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXR0cnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKHJlY2lwaWVudEF0dHJzTWFwLmluZGV4T2YoYXR0cnNbal0ubmFtZSkgPT09IC0xKSB7XG4gICAgICAgICAgICByZWNpcGllbnQuYXR0cnMucHVzaChhdHRyc1tqXSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG4vL1RyZWUgdHJhdmVyc2luZ1xuZXhwb3J0cy5nZXRGaXJzdENoaWxkID0gZnVuY3Rpb24obm9kZSkge1xuICAgIHJldHVybiBub2RlLmNoaWxkTm9kZXNbMF07XG59O1xuXG5leHBvcnRzLmdldENoaWxkTm9kZXMgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUuY2hpbGROb2Rlcztcbn07XG5cbmV4cG9ydHMuZ2V0UGFyZW50Tm9kZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS5wYXJlbnROb2RlO1xufTtcblxuZXhwb3J0cy5nZXRBdHRyTGlzdCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudC5hdHRycztcbn07XG5cbi8vTm9kZSBkYXRhXG5leHBvcnRzLmdldFRhZ05hbWUgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQudGFnTmFtZTtcbn07XG5cbmV4cG9ydHMuZ2V0TmFtZXNwYWNlVVJJID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50Lm5hbWVzcGFjZVVSSTtcbn07XG5cbmV4cG9ydHMuZ2V0VGV4dE5vZGVDb250ZW50ID0gZnVuY3Rpb24odGV4dE5vZGUpIHtcbiAgICByZXR1cm4gdGV4dE5vZGUudmFsdWU7XG59O1xuXG5leHBvcnRzLmdldENvbW1lbnROb2RlQ29udGVudCA9IGZ1bmN0aW9uKGNvbW1lbnROb2RlKSB7XG4gICAgcmV0dXJuIGNvbW1lbnROb2RlLmRhdGE7XG59O1xuXG5leHBvcnRzLmdldERvY3VtZW50VHlwZU5vZGVOYW1lID0gZnVuY3Rpb24oZG9jdHlwZU5vZGUpIHtcbiAgICByZXR1cm4gZG9jdHlwZU5vZGUubmFtZTtcbn07XG5cbmV4cG9ydHMuZ2V0RG9jdW1lbnRUeXBlTm9kZVB1YmxpY0lkID0gZnVuY3Rpb24oZG9jdHlwZU5vZGUpIHtcbiAgICByZXR1cm4gZG9jdHlwZU5vZGUucHVibGljSWQ7XG59O1xuXG5leHBvcnRzLmdldERvY3VtZW50VHlwZU5vZGVTeXN0ZW1JZCA9IGZ1bmN0aW9uKGRvY3R5cGVOb2RlKSB7XG4gICAgcmV0dXJuIGRvY3R5cGVOb2RlLnN5c3RlbUlkO1xufTtcblxuLy9Ob2RlIHR5cGVzXG5leHBvcnRzLmlzVGV4dE5vZGUgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUubm9kZU5hbWUgPT09ICcjdGV4dCc7XG59O1xuXG5leHBvcnRzLmlzQ29tbWVudE5vZGUgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUubm9kZU5hbWUgPT09ICcjY29tbWVudCc7XG59O1xuXG5leHBvcnRzLmlzRG9jdW1lbnRUeXBlTm9kZSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS5ub2RlTmFtZSA9PT0gJyNkb2N1bWVudFR5cGUnO1xufTtcblxuZXhwb3J0cy5pc0VsZW1lbnROb2RlID0gZnVuY3Rpb24obm9kZSkge1xuICAgIHJldHVybiAhIW5vZGUudGFnTmFtZTtcbn07XG5cbi8vIFNvdXJjZSBjb2RlIGxvY2F0aW9uXG5leHBvcnRzLnNldE5vZGVTb3VyY2VDb2RlTG9jYXRpb24gPSBmdW5jdGlvbihub2RlLCBsb2NhdGlvbikge1xuICAgIG5vZGUuc291cmNlQ29kZUxvY2F0aW9uID0gbG9jYXRpb247XG59O1xuXG5leHBvcnRzLmdldE5vZGVTb3VyY2VDb2RlTG9jYXRpb24gPSBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUuc291cmNlQ29kZUxvY2F0aW9uO1xufTtcblxuZXhwb3J0cy51cGRhdGVOb2RlU291cmNlQ29kZUxvY2F0aW9uID0gZnVuY3Rpb24obm9kZSwgZW5kTG9jYXRpb24pIHtcbiAgICBub2RlLnNvdXJjZUNvZGVMb2NhdGlvbiA9IE9iamVjdC5hc3NpZ24obm9kZS5zb3VyY2VDb2RlTG9jYXRpb24sIGVuZExvY2F0aW9uKTtcbn07XG4iXX0=