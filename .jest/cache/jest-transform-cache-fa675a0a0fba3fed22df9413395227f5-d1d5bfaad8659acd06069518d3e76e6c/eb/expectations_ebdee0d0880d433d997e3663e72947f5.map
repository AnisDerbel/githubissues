{"version":3,"sources":["expectations.js"],"names":["Object","defineProperty","exports","value","createEffectExpectation","createReturnExpectation","createStoreStateExpectation","createErrorExpectation","_utilInspect","_interopRequireDefault","require","_lodash","_lodash2","_SagaTestError","_serializeEffect","_reportActualEffects","obj","__esModule","default","effectName","expectedEffect","storeKey","like","extractEffect","store","expected","deleted","deleteBy","item","delete","errorMessage","serializedEffect","returnValue","serializedActual","depth","serializedExpected","expectedState","state","storeState","type","errorValue","name","matches","constructor"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createEffectExpectation = createEffectExpectation;\nexports.createReturnExpectation = createReturnExpectation;\nexports.createStoreStateExpectation = createStoreStateExpectation;\nexports.createErrorExpectation = createErrorExpectation;\n\nvar _utilInspect = _interopRequireDefault(require(\"util-inspect\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.ismatch\"));\n\nvar _lodash2 = _interopRequireDefault(require(\"lodash.isequal\"));\n\nvar _SagaTestError = _interopRequireDefault(require(\"../shared/SagaTestError\"));\n\nvar _serializeEffect = _interopRequireDefault(require(\"../shared/serializeEffect\"));\n\nvar _reportActualEffects = _interopRequireDefault(require(\"./reportActualEffects\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction createEffectExpectation({\n  effectName,\n  expectedEffect,\n  storeKey,\n  like,\n  extractEffect,\n  store,\n  expected\n}) {\n  return () => {\n    const deleted = like ? store.deleteBy(item => (0, _lodash.default)(extractEffect(item), expectedEffect)) : store.delete(expectedEffect);\n    let errorMessage = '';\n\n    if (deleted && !expected) {\n      const serializedEffect = (0, _serializeEffect.default)(expectedEffect, storeKey);\n      errorMessage = `\\n${effectName} expectation unmet:` + `\\n\\nNot Expected\\n------------\\n${serializedEffect}\\n`;\n    } else if (!deleted && expected) {\n      const serializedEffect = (0, _serializeEffect.default)(expectedEffect, storeKey);\n      errorMessage = `\\n${effectName} expectation unmet:` + `\\n\\nExpected\\n--------\\n${serializedEffect}\\n`;\n      errorMessage += (0, _reportActualEffects.default)(store, storeKey, effectName);\n    }\n\n    if (errorMessage) {\n      throw new _SagaTestError.default(errorMessage);\n    }\n  };\n}\n\nfunction createReturnExpectation({\n  value,\n  expected\n}) {\n  return ({\n    returnValue\n  }) => {\n    if (expected && !(0, _lodash2.default)(value, returnValue)) {\n      const serializedActual = (0, _utilInspect.default)(returnValue, {\n        depth: 3\n      });\n      const serializedExpected = (0, _utilInspect.default)(value, {\n        depth: 3\n      });\n      const errorMessage = `\nExpected to return:\n-------------------\n${serializedExpected}\n\nBut returned instead:\n---------------------\n${serializedActual}\n`;\n      throw new _SagaTestError.default(errorMessage);\n    } else if (!expected && (0, _lodash2.default)(value, returnValue)) {\n      const serializedExpected = (0, _utilInspect.default)(value, {\n        depth: 3\n      });\n      const errorMessage = `\nDid not expect to return:\n-------------------------\n${serializedExpected}\n`;\n      throw new _SagaTestError.default(errorMessage);\n    }\n  };\n}\n\nfunction createStoreStateExpectation({\n  state: expectedState,\n  expected\n}) {\n  return ({\n    storeState\n  }) => {\n    if (expected && !(0, _lodash2.default)(expectedState, storeState)) {\n      const serializedActual = (0, _utilInspect.default)(storeState, {\n        depth: 3\n      });\n      const serializedExpected = (0, _utilInspect.default)(expectedState, {\n        depth: 3\n      });\n      const errorMessage = `\nExpected to have final store state:\n-----------------------------------\n${serializedExpected}\n\nBut instead had final store state:\n----------------------------------\n${serializedActual}\n`;\n      throw new _SagaTestError.default(errorMessage);\n    } else if (!expected && (0, _lodash2.default)(expectedState, storeState)) {\n      const serializedExpected = (0, _utilInspect.default)(expectedState, {\n        depth: 3\n      });\n      const errorMessage = `\nExpected to not have final store state:\n---------------------------------------\n${serializedExpected}\n`;\n      throw new _SagaTestError.default(errorMessage);\n    }\n  };\n}\n\nfunction createErrorExpectation({\n  type,\n  expected\n}) {\n  return ({\n    errorValue\n  }) => {\n    let serializedExpected = typeof type;\n\n    if (typeof type === 'object') {\n      serializedExpected = (0, _utilInspect.default)(type, {\n        depth: 3\n      });\n    } else if (typeof type === 'function') {\n      serializedExpected = type.name;\n    }\n\n    const matches = () => typeof type === 'object' && (0, _lodash2.default)(type, errorValue) || typeof type === 'function' && errorValue instanceof type;\n\n    if (!expected) {\n      if (typeof errorValue === 'undefined' || !matches()) return;\n      throw new _SagaTestError.default(`\nExpected not to throw:\n----------------------\n${serializedExpected}\n`);\n    } else if (typeof errorValue === 'undefined') {\n      throw new _SagaTestError.default(`\nExpected to throw:\n-------------------\n${serializedExpected}\n\nBut no error thrown\n---------------------\n`);\n    } else if (typeof type === 'object' && !matches()) {\n      const serializedActual = (0, _utilInspect.default)(errorValue, {\n        depth: 3\n      });\n      throw new _SagaTestError.default(`\nExpected to throw:\n-------------------\n${serializedExpected}\n\nBut instead threw:\n---------------------\n${serializedActual}\n`);\n    } else if (typeof type === 'function' && !matches()) {\n      const serializedActual = typeof errorValue === 'function' ? errorValue.constructor.name : typeof errorValue;\n      throw new _SagaTestError.default(`\nExpected to throw error of type:\n--------------------------------\n${serializedExpected}\n\nBut instead threw:\n--------------------------------\n${serializedActual}\n`);\n    }\n  };\n}"]}