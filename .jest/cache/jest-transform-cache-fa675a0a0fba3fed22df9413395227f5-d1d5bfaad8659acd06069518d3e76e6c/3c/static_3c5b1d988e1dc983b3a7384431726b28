d8e566eb34cd18b084639466102dc32e
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var htmlparser2Adapter = require('parse5-htmlparser2-tree-adapter');

var serialize = require('dom-serializer').default;

var defaultOptions = require('./options').default;

var flattenOptions = require('./options').flatten;

var select = require('cheerio-select-tmp').select;

var parse5 = require('parse5');

var parse = require('./parse');

exports.load = function (content, options, isDocument) {
  if (content === null || content === undefined) {
    throw new Error('cheerio.load() expects a string');
  }

  var Cheerio = require('./cheerio');

  options = (0, _extends2.default)({}, defaultOptions, flattenOptions(options));
  if (isDocument === void 0) isDocument = true;
  var root = parse(content, options, isDocument);

  var initialize = function initialize(selector, context, r, opts) {
    if (!(this instanceof initialize)) {
      return new initialize(selector, context, r, opts);
    }

    opts = (0, _extends2.default)({}, options, opts);
    return Cheerio.call(this, selector, context, r || root, opts);
  };

  initialize.prototype = Object.create(Cheerio.prototype);
  initialize.prototype.constructor = initialize;
  initialize.fn = initialize.prototype;
  initialize.prototype._originalRoot = root;
  (0, _extends2.default)(initialize, exports);
  initialize._root = root;
  initialize._options = options;
  return initialize;
};

function render(that, dom, options) {
  if (!dom) {
    if (that._root && that._root.children) {
      dom = that._root.children;
    } else {
      return '';
    }
  } else if (typeof dom === 'string') {
    dom = select(dom, that._root, options);
  }

  if (options.xmlMode || options._useHtmlParser2) {
    return serialize(dom, options);
  }

  var nodes = 'length' in dom ? dom : [dom];

  for (var index = 0; index < nodes.length; index += 1) {
    if (nodes[index].type === 'root') {
      nodes.splice.apply(nodes, [index, 1].concat(nodes[index].children));
    }
  }

  return parse5.serialize({
    children: nodes
  }, {
    treeAdapter: htmlparser2Adapter
  });
}

exports.html = function (dom, options) {
  if (Object.prototype.toString.call(dom) === '[object Object]' && !options && !('length' in dom) && !('type' in dom)) {
    options = dom;
    dom = undefined;
  }

  options = (0, _extends2.default)({}, defaultOptions, this._options, flattenOptions(options || {}));
  return render(this, dom, options);
};

exports.xml = function (dom) {
  var options = (0, _extends2.default)({}, this._options, {
    xmlMode: true
  });
  return render(this, dom, options);
};

exports.text = function (elems) {
  if (!elems) {
    elems = this.root();
  }

  var ret = '';
  var len = elems.length;
  var elem;

  for (var i = 0; i < len; i++) {
    elem = elems[i];
    if (elem.type === 'text') ret += elem.data;else if (elem.children && elem.type !== 'comment' && elem.tagName !== 'script' && elem.tagName !== 'style') {
      ret += exports.text(elem.children);
    }
  }

  return ret;
};

exports.parseHTML = function (data, context, keepScripts) {
  var parsed;

  if (!data || typeof data !== 'string') {
    return null;
  }

  if (typeof context === 'boolean') {
    keepScripts = context;
  }

  parsed = this.load(data, defaultOptions, false);

  if (!keepScripts) {
    parsed('script').remove();
  }

  return parsed.root()[0].children.slice();
};

exports.root = function () {
  return this(this._root);
};

exports.contains = function (container, contained) {
  if (contained === container) {
    return false;
  }

  while (contained && contained !== contained.parent) {
    contained = contained.parent;

    if (contained === container) {
      return true;
    }
  }

  return false;
};

exports.merge = function (arr1, arr2) {
  if (!isArrayLike(arr1) || !isArrayLike(arr2)) {
    return;
  }

  var newLength = arr1.length + arr2.length;

  for (var i = 0; i < arr2.length; i++) {
    arr1[i + arr1.length] = arr2[i];
  }

  arr1.length = newLength;
  return arr1;
};

function isArrayLike(item) {
  if (Array.isArray(item)) {
    return true;
  }

  if (typeof item !== 'object' || !Object.prototype.hasOwnProperty.call(item, 'length') || typeof item.length !== 'number' || item.length < 0) {
    return false;
  }

  for (var i = 0; i < item.length; i++) {
    if (!(i in item)) {
      return false;
    }
  }

  return true;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YXRpYy5qcyJdLCJuYW1lcyI6WyJodG1scGFyc2VyMkFkYXB0ZXIiLCJyZXF1aXJlIiwic2VyaWFsaXplIiwiZGVmYXVsdCIsImRlZmF1bHRPcHRpb25zIiwiZmxhdHRlbk9wdGlvbnMiLCJmbGF0dGVuIiwic2VsZWN0IiwicGFyc2U1IiwicGFyc2UiLCJleHBvcnRzIiwibG9hZCIsImNvbnRlbnQiLCJvcHRpb25zIiwiaXNEb2N1bWVudCIsInVuZGVmaW5lZCIsIkVycm9yIiwiQ2hlZXJpbyIsInJvb3QiLCJpbml0aWFsaXplIiwic2VsZWN0b3IiLCJjb250ZXh0IiwiciIsIm9wdHMiLCJjYWxsIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJmbiIsIl9vcmlnaW5hbFJvb3QiLCJfcm9vdCIsIl9vcHRpb25zIiwicmVuZGVyIiwidGhhdCIsImRvbSIsImNoaWxkcmVuIiwieG1sTW9kZSIsIl91c2VIdG1sUGFyc2VyMiIsIm5vZGVzIiwiaW5kZXgiLCJsZW5ndGgiLCJ0eXBlIiwic3BsaWNlIiwiYXBwbHkiLCJjb25jYXQiLCJ0cmVlQWRhcHRlciIsImh0bWwiLCJ0b1N0cmluZyIsInhtbCIsInRleHQiLCJlbGVtcyIsInJldCIsImxlbiIsImVsZW0iLCJpIiwiZGF0YSIsInRhZ05hbWUiLCJwYXJzZUhUTUwiLCJrZWVwU2NyaXB0cyIsInBhcnNlZCIsInJlbW92ZSIsInNsaWNlIiwiY29udGFpbnMiLCJjb250YWluZXIiLCJjb250YWluZWQiLCJwYXJlbnQiLCJtZXJnZSIsImFycjEiLCJhcnIyIiwiaXNBcnJheUxpa2UiLCJuZXdMZW5ndGgiLCJpdGVtIiwiQXJyYXkiLCJpc0FycmF5IiwiaGFzT3duUHJvcGVydHkiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxJQUFJQSxrQkFBa0IsR0FBR0MsT0FBTyxDQUFDLGlDQUFELENBQWhDOztBQU9BLElBQUlDLFNBQVMsR0FBR0QsT0FBTyxDQUFDLGdCQUFELENBQVAsQ0FB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QSxXQUFPLEtBQVA7QUFDRDs7QUFFRCxPQUFLLElBQUljLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdpQixJQUFJLENBQUMvQixNQUF6QixFQUFpQ2MsQ0FBQyxFQUFsQyxFQUFzQztBQUNwQyxRQUFJLEVBQUVBLENBQUMsSUFBSWlCLElBQVAsQ0FBSixFQUFrQjtBQUNoQixhQUFPLEtBQVA7QUFDRDtBQUNGOztBQUNELFNBQU8sSUFBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGh0bWxwYXJzZXIyQWRhcHRlciA9IHJlcXVpcmUoJ3BhcnNlNS1odG1scGFyc2VyMi10cmVlLWFkYXB0ZXInKTtcblxuLyoqXG4gKiBAbW9kdWxlIGNoZWVyaW8vc3RhdGljXG4gKiBAaWdub3JlXG4gKi9cblxudmFyIHNlcmlhbGl6ZSA9IHJlcXVpcmUoJ2RvbS1zZXJpYWxpemVyJykuZGVmYXVsdDtcbnZhciBkZWZhdWx0T3B0aW9ucyA9IHJlcXVpcmUoJy4vb3B0aW9ucycpLmRlZmF1bHQ7XG52YXIgZmxhdHRlbk9wdGlvbnMgPSByZXF1aXJlKCcuL29wdGlvbnMnKS5mbGF0dGVuO1xudmFyIHNlbGVjdCA9IHJlcXVpcmUoJ2NoZWVyaW8tc2VsZWN0LXRtcCcpLnNlbGVjdDtcbnZhciBwYXJzZTUgPSByZXF1aXJlKCdwYXJzZTUnKTtcbnZhciBwYXJzZSA9IHJlcXVpcmUoJy4vcGFyc2UnKTtcblxuLyoqXG4gKiBDcmVhdGUgYSBxdWVyeWluZyBmdW5jdGlvbiwgYm91bmQgdG8gYSBkb2N1bWVudCBjcmVhdGVkIGZyb20gdGhlIHByb3ZpZGVkXG4gKiBtYXJrdXAuIE5vdGUgdGhhdCBzaW1pbGFyIHRvIHdlYiBicm93c2VyIGNvbnRleHRzLCB0aGlzIG9wZXJhdGlvbiBtYXlcbiAqIGludHJvZHVjZSBgPGh0bWw+YCwgYDxoZWFkPmAsIGFuZCBgPGJvZHk+YCBlbGVtZW50czsgc2V0IGBpc0RvY3VtZW50YCB0byBgZmFsc2VgXG4gKiB0byBzd2l0Y2ggdG8gZnJhZ21lbnQgbW9kZSBhbmQgZGlzYWJsZSB0aGlzLlxuICpcbiAqIFNlZSB0aGUgUkVBRE1FIHNlY3Rpb24gdGl0bGVkIFwiTG9hZGluZ1wiIGZvciBhZGRpdGlvbmFsIHVzYWdlIGluZm9ybWF0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb250ZW50IC0gTWFya3VwIHRvIGJlIGxvYWRlZC5cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBPcHRpb25zIGZvciB0aGUgY3JlYXRlZCBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRG9jdW1lbnRdIC0gQWxsb3dzIHBhcnNlciB0byBiZSBzd2l0Y2hlZCB0byBmcmFnbWVudCBtb2RlLlxuICpcbiAqL1xuZXhwb3J0cy5sb2FkID0gZnVuY3Rpb24gKGNvbnRlbnQsIG9wdGlvbnMsIGlzRG9jdW1lbnQpIHtcbiAgaWYgKGNvbnRlbnQgPT09IG51bGwgfHwgY29udGVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjaGVlcmlvLmxvYWQoKSBleHBlY3RzIGEgc3RyaW5nJyk7XG4gIH1cblxuICB2YXIgQ2hlZXJpbyA9IHJlcXVpcmUoJy4vY2hlZXJpbycpO1xuXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgZmxhdHRlbk9wdGlvbnMob3B0aW9ucykpO1xuXG4gIGlmIChpc0RvY3VtZW50ID09PSB2b2lkIDApIGlzRG9jdW1lbnQgPSB0cnVlO1xuXG4gIHZhciByb290ID0gcGFyc2UoY29udGVudCwgb3B0aW9ucywgaXNEb2N1bWVudCk7XG5cbiAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGNvbnRleHQsIHIsIG9wdHMpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgaW5pdGlhbGl6ZSkpIHtcbiAgICAgIHJldHVybiBuZXcgaW5pdGlhbGl6ZShzZWxlY3RvciwgY29udGV4dCwgciwgb3B0cyk7XG4gICAgfVxuICAgIG9wdHMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCBvcHRzKTtcbiAgICByZXR1cm4gQ2hlZXJpby5jYWxsKHRoaXMsIHNlbGVjdG9yLCBjb250ZXh0LCByIHx8IHJvb3QsIG9wdHMpO1xuICB9O1xuXG4gIC8vIEVuc3VyZSB0aGF0IHNlbGVjdGlvbnMgY3JlYXRlZCBieSB0aGUgXCJsb2FkZWRcIiBgaW5pdGlhbGl6ZWAgZnVuY3Rpb24gYXJlXG4gIC8vIHRydWUgQ2hlZXJpbyBpbnN0YW5jZXMuXG4gIGluaXRpYWxpemUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDaGVlcmlvLnByb3RvdHlwZSk7XG4gIGluaXRpYWxpemUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gaW5pdGlhbGl6ZTtcblxuICAvLyBNaW1pYyBqUXVlcnkncyBwcm90b3R5cGUgYWxpYXMgZm9yIHBsdWdpbiBhdXRob3JzLlxuICBpbml0aWFsaXplLmZuID0gaW5pdGlhbGl6ZS5wcm90b3R5cGU7XG5cbiAgLy8gS2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgdG9wLWxldmVsIHNjb3BlIHNvIHdlIGNhbiBjaGFpbiBtZXRob2RzIHRoYXQgaW1wbGljaXRseVxuICAvLyByZXNvbHZlIHNlbGVjdG9yczsgZS5nLiAkKFwiPHNwYW4+XCIpLihcIi5iYXJcIiksIHdoaWNoIG90aGVyd2lzZSBsb3NlcyAuX3Jvb3RcbiAgaW5pdGlhbGl6ZS5wcm90b3R5cGUuX29yaWdpbmFsUm9vdCA9IHJvb3Q7XG5cbiAgLy8gQWRkIGluIHRoZSBzdGF0aWMgbWV0aG9kc1xuICBPYmplY3QuYXNzaWduKGluaXRpYWxpemUsIGV4cG9ydHMpO1xuXG4gIC8vIEFkZCBpbiB0aGUgcm9vdFxuICBpbml0aWFsaXplLl9yb290ID0gcm9vdDtcbiAgLy8gc3RvcmUgb3B0aW9uc1xuICBpbml0aWFsaXplLl9vcHRpb25zID0gb3B0aW9ucztcblxuICByZXR1cm4gaW5pdGlhbGl6ZTtcbn07XG5cbi8qXG4gKiBIZWxwZXIgZnVuY3Rpb25cbiAqL1xuXG5mdW5jdGlvbiByZW5kZXIodGhhdCwgZG9tLCBvcHRpb25zKSB7XG4gIGlmICghZG9tKSB7XG4gICAgaWYgKHRoYXQuX3Jvb3QgJiYgdGhhdC5fcm9vdC5jaGlsZHJlbikge1xuICAgICAgZG9tID0gdGhhdC5fcm9vdC5jaGlsZHJlbjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfSBlbHNlIGlmICh0eXBlb2YgZG9tID09PSAnc3RyaW5nJykge1xuICAgIGRvbSA9IHNlbGVjdChkb20sIHRoYXQuX3Jvb3QsIG9wdGlvbnMpO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMueG1sTW9kZSB8fCBvcHRpb25zLl91c2VIdG1sUGFyc2VyMikge1xuICAgIHJldHVybiBzZXJpYWxpemUoZG9tLCBvcHRpb25zKTtcbiAgfVxuXG4gIC8vIGBkb20tc2VyaWFsaXplcmAgcGFzc2VzIG92ZXIgdGhlIHNwZWNpYWwgXCJyb290XCIgbm9kZSBhbmQgcmVuZGVycyB0aGVcbiAgLy8gbm9kZSdzIGNoaWxkcmVuIGluIGl0cyBwbGFjZS4gVG8gbWltaWMgdGhpcyBiZWhhdmlvciB3aXRoIGBwYXJzZTVgLCBhblxuICAvLyBlcXVpdmFsZW50IG9wZXJhdGlvbiBtdXN0IGJlIGFwcGxpZWQgdG8gdGhlIGlucHV0IGFycmF5LlxuICB2YXIgbm9kZXMgPSAnbGVuZ3RoJyBpbiBkb20gPyBkb20gOiBbZG9tXTtcbiAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IG5vZGVzLmxlbmd0aDsgaW5kZXggKz0gMSkge1xuICAgIGlmIChub2Rlc1tpbmRleF0udHlwZSA9PT0gJ3Jvb3QnKSB7XG4gICAgICBub2Rlcy5zcGxpY2UuYXBwbHkobm9kZXMsIFtpbmRleCwgMV0uY29uY2F0KG5vZGVzW2luZGV4XS5jaGlsZHJlbikpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwYXJzZTUuc2VyaWFsaXplKFxuICAgIHsgY2hpbGRyZW46IG5vZGVzIH0sXG4gICAgeyB0cmVlQWRhcHRlcjogaHRtbHBhcnNlcjJBZGFwdGVyIH1cbiAgKTtcbn1cblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBkb2N1bWVudC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xjaGVlcmlvfG5vZGV9IFtkb21dIC0gRWxlbWVudCB0byByZW5kZXIuXG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gT3B0aW9ucyBmb3IgdGhlIHJlbmRlcmVyLlxuICovXG5leHBvcnRzLmh0bWwgPSBmdW5jdGlvbiAoZG9tLCBvcHRpb25zKSB7XG4gIC8vIGJlIGZsZXhpYmxlIGFib3V0IHBhcmFtZXRlcnMsIHNvbWV0aW1lcyB3ZSBjYWxsIGh0bWwoKSxcbiAgLy8gd2l0aCBvcHRpb25zIGFzIG9ubHkgcGFyYW1ldGVyXG4gIC8vIGNoZWNrIGRvbSBhcmd1bWVudCBmb3IgZG9tIGVsZW1lbnQgc3BlY2lmaWMgcHJvcGVydGllc1xuICAvLyBhc3N1bWUgdGhlcmUgaXMgbm8gJ2xlbmd0aCcgb3IgJ3R5cGUnIHByb3BlcnRpZXMgaW4gdGhlIG9wdGlvbnMgb2JqZWN0XG4gIGlmIChcbiAgICBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZG9tKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScgJiZcbiAgICAhb3B0aW9ucyAmJlxuICAgICEoJ2xlbmd0aCcgaW4gZG9tKSAmJlxuICAgICEoJ3R5cGUnIGluIGRvbSlcbiAgKSB7XG4gICAgb3B0aW9ucyA9IGRvbTtcbiAgICBkb20gPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvLyBzb21ldGltZXMgJC5odG1sKCkgdXNlZCB3aXRob3V0IHByZWxvYWRpbmcgaHRtbFxuICAvLyBzbyBmYWxsYmFjayBub24gZXhpc3Rpbmcgb3B0aW9ucyB0byB0aGUgZGVmYXVsdCBvbmVzXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKFxuICAgIHt9LFxuICAgIGRlZmF1bHRPcHRpb25zLFxuICAgIHRoaXMuX29wdGlvbnMsXG4gICAgZmxhdHRlbk9wdGlvbnMob3B0aW9ucyB8fCB7fSlcbiAgKTtcblxuICByZXR1cm4gcmVuZGVyKHRoaXMsIGRvbSwgb3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIFJlbmRlciB0aGUgZG9jdW1lbnQgYXMgWE1MLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfGNoZWVyaW98bm9kZX0gW2RvbV0gLSBFbGVtZW50IHRvIHJlbmRlci5cbiAqL1xuZXhwb3J0cy54bWwgPSBmdW5jdGlvbiAoZG9tKSB7XG4gIHZhciBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fb3B0aW9ucywgeyB4bWxNb2RlOiB0cnVlIH0pO1xuXG4gIHJldHVybiByZW5kZXIodGhpcywgZG9tLCBvcHRpb25zKTtcbn07XG5cbi8qKlxuICogUmVuZGVyIHRoZSBkb2N1bWVudCBhcyB0ZXh0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfGNoZWVyaW98bm9kZX0gW2VsZW1zXSAtIEVsZW1lbnRzIHRvIHJlbmRlci5cbiAqL1xuZXhwb3J0cy50ZXh0ID0gZnVuY3Rpb24gKGVsZW1zKSB7XG4gIGlmICghZWxlbXMpIHtcbiAgICBlbGVtcyA9IHRoaXMucm9vdCgpO1xuICB9XG5cbiAgdmFyIHJldCA9ICcnO1xuICB2YXIgbGVuID0gZWxlbXMubGVuZ3RoO1xuICB2YXIgZWxlbTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgZWxlbSA9IGVsZW1zW2ldO1xuICAgIGlmIChlbGVtLnR5cGUgPT09ICd0ZXh0JykgcmV0ICs9IGVsZW0uZGF0YTtcbiAgICBlbHNlIGlmIChcbiAgICAgIGVsZW0uY2hpbGRyZW4gJiZcbiAgICAgIGVsZW0udHlwZSAhPT0gJ2NvbW1lbnQnICYmXG4gICAgICBlbGVtLnRhZ05hbWUgIT09ICdzY3JpcHQnICYmXG4gICAgICBlbGVtLnRhZ05hbWUgIT09ICdzdHlsZSdcbiAgICApIHtcbiAgICAgIHJldCArPSBleHBvcnRzLnRleHQoZWxlbS5jaGlsZHJlbik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJldDtcbn07XG5cbi8qKlxuICogUGFyc2VzIGEgc3RyaW5nIGludG8gYW4gYXJyYXkgb2YgRE9NIG5vZGVzLiBUaGUgYGNvbnRleHRgIGFyZ3VtZW50IGhhcyBub1xuICogbWVhbmluZyBmb3IgQ2hlZXJpbywgYnV0IGl0IGlzIG1haW50YWluZWQgZm9yIEFQSSBjb21wYXRpYmlsaXR5IHdpdGggalF1ZXJ5LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhIC0gTWFya3VwIHRoYXQgd2lsbCBiZSBwYXJzZWQuXG4gKiBAcGFyYW0ge2FueXxib29sZWFufSBbY29udGV4dF0gLSBXaWxsIGJlIGlnbm9yZWQuIElmIGl0IGlzIGEgYm9vbGVhbiBpdCB3aWxsIGJlIHVzZWQgYXMgdGhlIHZhbHVlIG9mIGBrZWVwU2NyaXB0c2AuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtrZWVwU2NyaXB0c10gLSBJZiBmYWxzZSBhbGwgc2NyaXB0cyB3aWxsIGJlIHJlbW92ZWQuXG4gKlxuICogQGFsaWFzIENoZWVyaW8ucGFyc2VIVE1MXG4gKiBAc2VlIHtAbGluayBodHRwczovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5wYXJzZUhUTUwvfVxuICovXG5leHBvcnRzLnBhcnNlSFRNTCA9IGZ1bmN0aW9uIChkYXRhLCBjb250ZXh0LCBrZWVwU2NyaXB0cykge1xuICB2YXIgcGFyc2VkO1xuXG4gIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgY29udGV4dCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAga2VlcFNjcmlwdHMgPSBjb250ZXh0O1xuICB9XG5cbiAgcGFyc2VkID0gdGhpcy5sb2FkKGRhdGEsIGRlZmF1bHRPcHRpb25zLCBmYWxzZSk7XG4gIGlmICgha2VlcFNjcmlwdHMpIHtcbiAgICBwYXJzZWQoJ3NjcmlwdCcpLnJlbW92ZSgpO1xuICB9XG5cbiAgLy8gVGhlIGBjaGlsZHJlbmAgYXJyYXkgaXMgdXNlZCBieSBDaGVlcmlvIGludGVybmFsbHkgdG8gZ3JvdXAgZWxlbWVudHMgdGhhdFxuICAvLyBzaGFyZSB0aGUgc2FtZSBwYXJlbnRzLiBXaGVuIG5vZGVzIGNyZWF0ZWQgdGhyb3VnaCBgcGFyc2VIVE1MYCBhcmVcbiAgLy8gaW5zZXJ0ZWQgaW50byBwcmV2aW91c2x5LWV4aXN0aW5nIERPTSBzdHJ1Y3R1cmVzLCB0aGV5IHdpbGwgYmUgcmVtb3ZlZFxuICAvLyBmcm9tIHRoZSBgY2hpbGRyZW5gIGFycmF5LiBUaGUgcmVzdWx0cyBvZiBgcGFyc2VIVE1MYCBzaG91bGQgcmVtYWluXG4gIC8vIGNvbnN0YW50IGFjcm9zcyB0aGVzZSBvcGVyYXRpb25zLCBzbyBhIHNoYWxsb3cgY29weSBzaG91bGQgYmUgcmV0dXJuZWQuXG4gIHJldHVybiBwYXJzZWQucm9vdCgpWzBdLmNoaWxkcmVuLnNsaWNlKCk7XG59O1xuXG4vKipcbiAqIFNvbWV0aW1lcyB5b3UgbmVlZCB0byB3b3JrIHdpdGggdGhlIHRvcC1sZXZlbCByb290IGVsZW1lbnQuIFRvIHF1ZXJ5IGl0LCB5b3VcbiAqIGNhbiB1c2UgYCQucm9vdCgpYC5cbiAqXG4gKiBAYWxpYXMgQ2hlZXJpby5yb290XG4gKlxuICogQGV4YW1wbGVcbiAqICQucm9vdCgpLmFwcGVuZCgnPHVsIGlkPVwidmVnZXRhYmxlc1wiPjwvdWw+JykuaHRtbCgpO1xuICogLy89PiA8dWwgaWQ9XCJmcnVpdHNcIj4uLi48L3VsPjx1bCBpZD1cInZlZ2V0YWJsZXNcIj48L3VsPlxuICovXG5leHBvcnRzLnJvb3QgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzKHRoaXMuX3Jvb3QpO1xufTtcblxuLyoqXG4gKiBDaGVja3MgdG8gc2VlIGlmIHRoZSBgY29udGFpbmVkYCBET00gZWxlbWVudCBpcyBhIGRlc2NlbmRhbnQgb2YgdGhlXG4gKiBgY29udGFpbmVyYCBET00gZWxlbWVudC5cbiAqXG4gKiBAcGFyYW0ge25vZGV9IGNvbnRhaW5lciAtIFBvdGVudGlhbCBwYXJlbnQgbm9kZS5cbiAqIEBwYXJhbSB7bm9kZX0gY29udGFpbmVkIC0gUG90ZW50aWFsIGNoaWxkIG5vZGUuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAqXG4gKiBAYWxpYXMgQ2hlZXJpby5jb250YWluc1xuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9hcGkuanF1ZXJ5LmNvbS9qUXVlcnkuY29udGFpbnN9XG4gKi9cbmV4cG9ydHMuY29udGFpbnMgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBjb250YWluZWQpIHtcbiAgLy8gQWNjb3JkaW5nIHRvIHRoZSBqUXVlcnkgQVBJLCBhbiBlbGVtZW50IGRvZXMgbm90IFwiY29udGFpblwiIGl0c2VsZlxuICBpZiAoY29udGFpbmVkID09PSBjb250YWluZXIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBTdGVwIHVwIHRoZSBkZXNjZW5kYW50cywgc3RvcHBpbmcgd2hlbiB0aGUgcm9vdCBlbGVtZW50IGlzIHJlYWNoZWRcbiAgLy8gKHNpZ25hbGVkIGJ5IGAucGFyZW50YCByZXR1cm5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgb2JqZWN0KVxuICB3aGlsZSAoY29udGFpbmVkICYmIGNvbnRhaW5lZCAhPT0gY29udGFpbmVkLnBhcmVudCkge1xuICAgIGNvbnRhaW5lZCA9IGNvbnRhaW5lZC5wYXJlbnQ7XG4gICAgaWYgKGNvbnRhaW5lZCA9PT0gY29udGFpbmVyKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqICQubWVyZ2UoKS5cbiAqXG4gKiBAcGFyYW0ge0FycmF5fGNoZWVyaW99IGFycjEgLSBGaXJzdCBhcnJheS5cbiAqIEBwYXJhbSB7QXJyYXl8Y2hlZXJpb30gYXJyMiAtIFNlY29uZCBhcnJheS5cbiAqXG4gKiBAYWxpYXMgQ2hlZXJpby5tZXJnZVxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9hcGkuanF1ZXJ5LmNvbS9qUXVlcnkubWVyZ2V9XG4gKi9cbmV4cG9ydHMubWVyZ2UgPSBmdW5jdGlvbiAoYXJyMSwgYXJyMikge1xuICBpZiAoIWlzQXJyYXlMaWtlKGFycjEpIHx8ICFpc0FycmF5TGlrZShhcnIyKSkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgbmV3TGVuZ3RoID0gYXJyMS5sZW5ndGggKyBhcnIyLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIyLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJyMVtpICsgYXJyMS5sZW5ndGhdID0gYXJyMltpXTtcbiAgfVxuICBhcnIxLmxlbmd0aCA9IG5ld0xlbmd0aDtcbiAgcmV0dXJuIGFycjE7XG59O1xuXG5mdW5jdGlvbiBpc0FycmF5TGlrZShpdGVtKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGl0ZW0pKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpZiAoXG4gICAgdHlwZW9mIGl0ZW0gIT09ICdvYmplY3QnIHx8XG4gICAgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpdGVtLCAnbGVuZ3RoJykgfHxcbiAgICB0eXBlb2YgaXRlbS5sZW5ndGggIT09ICdudW1iZXInIHx8XG4gICAgaXRlbS5sZW5ndGggPCAwXG4gICkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5sZW5ndGg7IGkrKykge1xuICAgIGlmICghKGkgaW4gaXRlbSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG4iXX0=