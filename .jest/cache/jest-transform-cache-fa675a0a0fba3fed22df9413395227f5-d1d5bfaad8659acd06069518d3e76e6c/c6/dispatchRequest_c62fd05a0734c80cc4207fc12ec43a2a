f9f1cfe16c11277475e8422e991fda67
'use strict';

var utils = require('./../utils');

var transformData = require('./transformData');

var isCancel = require('../cancel/isCancel');

var defaults = require('../defaults');

function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }
}

module.exports = function dispatchRequest(config) {
  throwIfCancellationRequested(config);
  config.headers = config.headers || {};
  config.data = transformData(config.data, config.headers, config.transformRequest);
  config.headers = utils.merge(config.headers.common || {}, config.headers[config.method] || {}, config.headers);
  utils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch', 'common'], function cleanHeaderConfig(method) {
    delete config.headers[method];
  });
  var adapter = config.adapter || defaults.adapter;
  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);
    response.data = transformData(response.data, response.headers, config.transformResponse);
    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      if (reason && reason.response) {
        reason.response.data = transformData(reason.response.data, reason.response.headers, config.transformResponse);
      }
    }

    return Promise.reject(reason);
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpc3BhdGNoUmVxdWVzdC5qcyJdLCJuYW1lcyI6WyJ1dGlscyIsInJlcXVpcmUiLCJ0cmFuc2Zvcm1EYXRhIiwiaXNDYW5jZWwiLCJkZWZhdWx0cyIsInRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQiLCJjb25maWciLCJjYW5jZWxUb2tlbiIsInRocm93SWZSZXF1ZXN0ZWQiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGlzcGF0Y2hSZXF1ZXN0IiwiaGVhZGVycyIsImRhdGEiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwibWVyZ2UiLCJjb21tb24iLCJtZXRob2QiLCJmb3JFYWNoIiwiY2xlYW5IZWFkZXJDb25maWciLCJhZGFwdGVyIiwidGhlbiIsIm9uQWRhcHRlclJlc29sdXRpb24iLCJyZXNwb25zZSIsInRyYW5zZm9ybVJlc3BvbnNlIiwib25BZGFwdGVyUmVqZWN0aW9uIiwicmVhc29uIiwiUHJvbWlzZSIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsWUFBRCxDQUFuQjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyxpQkFBRCxDQUEzQjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxvQkFBRCxDQUF0Qjs7QUFDQSxJQUFJRyxRQUFRLEdBQUdILE9BQU8sQ0FBQyxhQUFELENBQXRCOztBQUtBLFNBQVNJLDRCQUFULENBQXNDQyxNQUF0QyxFQUE4QztBQUM1QyxNQUFJQSxNQUFNLENBQUNDLFdBQVgsRUFBd0I7QUFDdEJELElBQUFBLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQkMsZ0JBQW5CO0FBQ0Q7QUFDRjs7QUFRREMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLFNBQVNDLGVBQVQsQ0FBeUJMLE1BQXpCLEVBQWlDO0FBQ2hERCxFQUFBQSw0QkFBNEIsQ0FBQ0MsTUFBRCxDQUE1QjtBQUdBQSxFQUFBQSxNQUFNLENBQUNNLE9BQVAsR0FBaUJOLE1BQU0sQ0FBQ00sT0FBUCxJQUFrQixFQUFuQztBQUdBTixFQUFBQSxNQUFNLENBQUNPLElBQVAsR0FBY1gsYUFBYSxDQUN6QkksTUFBTSxDQUFDTyxJQURrQixFQUV6QlAsTUFBTSxDQUFDTSxPQUZrQixFQUd6Qk4sTUFBTSxDQUFDUSxnQkFIa0IsQ0FBM0I7QUFPQVIsRUFBQUEsTUFBTSxDQUFDTSxPQUFQLEdBQWlCWixLQUFLLENBQUNlLEtBQU4sQ0FDZlQsTUFBTSxDQUFDTSxPQUFQLENBQWVJLE1BQWYsSUFBeUIsRUFEVixFQUVmVixNQUFNLENBQUNNLE9BQVAsQ0FBZU4sTUFBTSxDQUFDVyxNQUF0QixLQUFpQyxFQUZsQixFQUdmWCxNQUFNLENBQUNNLE9BSFEsQ0FBakI7QUFNQVosRUFBQUEsS0FBSyxDQUFDa0IsT0FBTixDQUNFLENBQUMsUUFBRCxFQUFXLEtBQVgsRUFBa0IsTUFBbEIsRUFBMEIsTUFBMUIsRUFBa0MsS0FBbEMsRUFBeUMsT0FBekMsRUFBa0QsUUFBbEQsQ0FERixFQUVFLFNBQVNDLGlCQUFULENBQTJCRixNQUEzQixFQUFtQztBQUNqQyxXQUFPWCxNQUFNLENBQUNNLE9BQVAsQ0FBZUssTUFBZixDQUFQO0FBQ0QsR0FKSDtBQU9BLE1BQUlHLE9BQU8sR0FBR2QsTUFBTSxDQUFDYyxPQUFQLElBQWtCaEIsUUFBUSxDQUFDZ0IsT0FBekM7QUFFQSxTQUFPQSxPQUFPLENBQUNkLE1BQUQsQ0FBUCxDQUFnQmUsSUFBaEIsQ0FBcUIsU0FBU0MsbUJBQVQsQ0FBNkJDLFFBQTdCLEVBQXVDO0FBQ2pFbEIsSUFBQUEsNEJBQTRCLENBQUNDLE1BQUQsQ0FBNUI7QUFHQWlCLElBQUFBLFFBQVEsQ0FBQ1YsSUFBVCxHQUFnQlgsYUFBYSxDQUMzQnFCLFFBQVEsQ0FBQ1YsSUFEa0IsRUFFM0JVLFFBQVEsQ0FBQ1gsT0FGa0IsRUFHM0JOLE1BQU0sQ0FBQ2tCLGlCQUhvQixDQUE3QjtBQU1BLFdBQU9ELFFBQVA7QUFDRCxHQVhNLEVBV0osU0FBU0Usa0JBQVQsQ0FBNEJDLE1BQTVCLEVBQW9DO0FBQ3JDLFFBQUksQ0FBQ3ZCLFFBQVEsQ0FBQ3VCLE1BQUQsQ0FBYixFQUF1QjtBQUNyQnJCLE1BQUFBLDRCQUE0QixDQUFDQyxNQUFELENBQTVCOztBQUdBLFVBQUlvQixNQUFNLElBQUlBLE1BQU0sQ0FBQ0gsUUFBckIsRUFBK0I7QUFDN0JHLFFBQUFBLE1BQU0sQ0FBQ0gsUUFBUCxDQUFnQlYsSUFBaEIsR0FBdUJYLGFBQWEsQ0FDbEN3QixNQUFNLENBQUNILFFBQVAsQ0FBZ0JWLElBRGtCLEVBRWxDYSxNQUFNLENBQUNILFFBQVAsQ0FBZ0JYLE9BRmtCLEVBR2xDTixNQUFNLENBQUNrQixpQkFIMkIsQ0FBcEM7QUFLRDtBQUNGOztBQUVELFdBQU9HLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixNQUFmLENBQVA7QUFDRCxHQTFCTSxDQUFQO0FBMkJELENBeEREIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgdHJhbnNmb3JtRGF0YSA9IHJlcXVpcmUoJy4vdHJhbnNmb3JtRGF0YScpO1xudmFyIGlzQ2FuY2VsID0gcmVxdWlyZSgnLi4vY2FuY2VsL2lzQ2FuY2VsJyk7XG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLi9kZWZhdWx0cycpO1xuXG4vKipcbiAqIFRocm93cyBhIGBDYW5jZWxgIGlmIGNhbmNlbGxhdGlvbiBoYXMgYmVlbiByZXF1ZXN0ZWQuXG4gKi9cbmZ1bmN0aW9uIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKSB7XG4gIGlmIChjb25maWcuY2FuY2VsVG9rZW4pIHtcbiAgICBjb25maWcuY2FuY2VsVG9rZW4udGhyb3dJZlJlcXVlc3RlZCgpO1xuICB9XG59XG5cbi8qKlxuICogRGlzcGF0Y2ggYSByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIgdXNpbmcgdGhlIGNvbmZpZ3VyZWQgYWRhcHRlci5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIFRoZSBjb25maWcgdGhhdCBpcyB0byBiZSB1c2VkIGZvciB0aGUgcmVxdWVzdFxuICogQHJldHVybnMge1Byb21pc2V9IFRoZSBQcm9taXNlIHRvIGJlIGZ1bGZpbGxlZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRpc3BhdGNoUmVxdWVzdChjb25maWcpIHtcbiAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gIC8vIEVuc3VyZSBoZWFkZXJzIGV4aXN0XG4gIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG5cbiAgLy8gVHJhbnNmb3JtIHJlcXVlc3QgZGF0YVxuICBjb25maWcuZGF0YSA9IHRyYW5zZm9ybURhdGEoXG4gICAgY29uZmlnLmRhdGEsXG4gICAgY29uZmlnLmhlYWRlcnMsXG4gICAgY29uZmlnLnRyYW5zZm9ybVJlcXVlc3RcbiAgKTtcblxuICAvLyBGbGF0dGVuIGhlYWRlcnNcbiAgY29uZmlnLmhlYWRlcnMgPSB1dGlscy5tZXJnZShcbiAgICBjb25maWcuaGVhZGVycy5jb21tb24gfHwge30sXG4gICAgY29uZmlnLmhlYWRlcnNbY29uZmlnLm1ldGhvZF0gfHwge30sXG4gICAgY29uZmlnLmhlYWRlcnNcbiAgKTtcblxuICB1dGlscy5mb3JFYWNoKFxuICAgIFsnZGVsZXRlJywgJ2dldCcsICdoZWFkJywgJ3Bvc3QnLCAncHV0JywgJ3BhdGNoJywgJ2NvbW1vbiddLFxuICAgIGZ1bmN0aW9uIGNsZWFuSGVhZGVyQ29uZmlnKG1ldGhvZCkge1xuICAgICAgZGVsZXRlIGNvbmZpZy5oZWFkZXJzW21ldGhvZF07XG4gICAgfVxuICApO1xuXG4gIHZhciBhZGFwdGVyID0gY29uZmlnLmFkYXB0ZXIgfHwgZGVmYXVsdHMuYWRhcHRlcjtcblxuICByZXR1cm4gYWRhcHRlcihjb25maWcpLnRoZW4oZnVuY3Rpb24gb25BZGFwdGVyUmVzb2x1dGlvbihyZXNwb25zZSkge1xuICAgIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKTtcblxuICAgIC8vIFRyYW5zZm9ybSByZXNwb25zZSBkYXRhXG4gICAgcmVzcG9uc2UuZGF0YSA9IHRyYW5zZm9ybURhdGEoXG4gICAgICByZXNwb25zZS5kYXRhLFxuICAgICAgcmVzcG9uc2UuaGVhZGVycyxcbiAgICAgIGNvbmZpZy50cmFuc2Zvcm1SZXNwb25zZVxuICAgICk7XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH0sIGZ1bmN0aW9uIG9uQWRhcHRlclJlamVjdGlvbihyZWFzb24pIHtcbiAgICBpZiAoIWlzQ2FuY2VsKHJlYXNvbikpIHtcbiAgICAgIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKTtcblxuICAgICAgLy8gVHJhbnNmb3JtIHJlc3BvbnNlIGRhdGFcbiAgICAgIGlmIChyZWFzb24gJiYgcmVhc29uLnJlc3BvbnNlKSB7XG4gICAgICAgIHJlYXNvbi5yZXNwb25zZS5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICAgICAgICByZWFzb24ucmVzcG9uc2UuZGF0YSxcbiAgICAgICAgICByZWFzb24ucmVzcG9uc2UuaGVhZGVycyxcbiAgICAgICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2VcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVhc29uKTtcbiAgfSk7XG59O1xuIl19