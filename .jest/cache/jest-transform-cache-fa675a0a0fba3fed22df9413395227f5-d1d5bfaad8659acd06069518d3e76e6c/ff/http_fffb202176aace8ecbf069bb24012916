08d4394ea532110515c92982ddb8227e
'use strict';

var utils = require('./../utils');

var settle = require('./../core/settle');

var buildFullPath = require('../core/buildFullPath');

var buildURL = require('./../helpers/buildURL');

var http = require('http');

var https = require('https');

var httpFollow = require('follow-redirects').http;

var httpsFollow = require('follow-redirects').https;

var url = require('url');

var zlib = require('zlib');

var pkg = require('./../../package.json');

var createError = require('../core/createError');

var enhanceError = require('../core/enhanceError');

var isHttps = /https:?/;

function setProxy(options, proxy, location) {
  options.hostname = proxy.host;
  options.host = proxy.host;
  options.port = proxy.port;
  options.path = location;

  if (proxy.auth) {
    var base64 = Buffer.from(proxy.auth.username + ':' + proxy.auth.password, 'utf8').toString('base64');
    options.headers['Proxy-Authorization'] = 'Basic ' + base64;
  }

  options.beforeRedirect = function beforeRedirect(redirection) {
    redirection.headers.host = redirection.host;
    setProxy(redirection, proxy, redirection.href);
  };
}

module.exports = function httpAdapter(config) {
  return new Promise(function dispatchHttpRequest(resolvePromise, rejectPromise) {
    var resolve = function resolve(value) {
      resolvePromise(value);
    };

    var reject = function reject(value) {
      rejectPromise(value);
    };

    var data = config.data;
    var headers = config.headers;

    if (!headers['User-Agent'] && !headers['user-agent']) {
      headers['User-Agent'] = 'axios/' + pkg.version;
    }

    if (data && !utils.isStream(data)) {
      if (Buffer.isBuffer(data)) {} else if (utils.isArrayBuffer(data)) {
        data = Buffer.from(new Uint8Array(data));
      } else if (utils.isString(data)) {
        data = Buffer.from(data, 'utf-8');
      } else {
        return reject(createError('Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream', config));
      }

      headers['Content-Length'] = data.length;
    }

    var auth = undefined;

    if (config.auth) {
      var username = config.auth.username || '';
      var password = config.auth.password || '';
      auth = username + ':' + password;
    }

    var fullPath = buildFullPath(config.baseURL, config.url);
    var parsed = url.parse(fullPath);
    var protocol = parsed.protocol || 'http:';

    if (!auth && parsed.auth) {
      var urlAuth = parsed.auth.split(':');
      var urlUsername = urlAuth[0] || '';
      var urlPassword = urlAuth[1] || '';
      auth = urlUsername + ':' + urlPassword;
    }

    if (auth) {
      delete headers.Authorization;
    }

    var isHttpsRequest = isHttps.test(protocol);
    var agent = isHttpsRequest ? config.httpsAgent : config.httpAgent;
    var options = {
      path: buildURL(parsed.path, config.params, config.paramsSerializer).replace(/^\?/, ''),
      method: config.method.toUpperCase(),
      headers: headers,
      agent: agent,
      agents: {
        http: config.httpAgent,
        https: config.httpsAgent
      },
      auth: auth
    };

    if (config.socketPath) {
      options.socketPath = config.socketPath;
    } else {
      options.hostname = parsed.hostname;
      options.port = parsed.port;
    }

    var proxy = config.proxy;

    if (!proxy && proxy !== false) {
      var proxyEnv = protocol.slice(0, -1) + '_proxy';
      var proxyUrl = process.env[proxyEnv] || process.env[proxyEnv.toUpperCase()];

      if (proxyUrl) {
        var parsedProxyUrl = url.parse(proxyUrl);
        var noProxyEnv = process.env.no_proxy || process.env.NO_PROXY;
        var shouldProxy = true;

        if (noProxyEnv) {
          var noProxy = noProxyEnv.split(',').map(function trim(s) {
            return s.trim();
          });
          shouldProxy = !noProxy.some(function proxyMatch(proxyElement) {
            if (!proxyElement) {
              return false;
            }

            if (proxyElement === '*') {
              return true;
            }

            if (proxyElement[0] === '.' && parsed.hostname.substr(parsed.hostname.length - proxyElement.length) === proxyElement) {
              return true;
            }

            return parsed.hostname === proxyElement;
          });
        }

        if (shouldProxy) {
          proxy = {
            host: parsedProxyUrl.hostname,
            port: parsedProxyUrl.port,
            protocol: parsedProxyUrl.protocol
          };

          if (parsedProxyUrl.auth) {
            var proxyUrlAuth = parsedProxyUrl.auth.split(':');
            proxy.auth = {
              username: proxyUrlAuth[0],
              password: proxyUrlAuth[1]
            };
          }
        }
      }
    }

    if (proxy) {
      options.headers.host = parsed.hostname + (parsed.port ? ':' + parsed.port : '');
      setProxy(options, proxy, protocol + '//' + parsed.hostname + (parsed.port ? ':' + parsed.port : '') + options.path);
    }

    var transport;
    var isHttpsProxy = isHttpsRequest && (proxy ? isHttps.test(proxy.protocol) : true);

    if (config.transport) {
      transport = config.transport;
    } else if (config.maxRedirects === 0) {
      transport = isHttpsProxy ? https : http;
    } else {
      if (config.maxRedirects) {
        options.maxRedirects = config.maxRedirects;
      }

      transport = isHttpsProxy ? httpsFollow : httpFollow;
    }

    if (config.maxBodyLength > -1) {
      options.maxBodyLength = config.maxBodyLength;
    }

    var req = transport.request(options, function handleResponse(res) {
      if (req.aborted) return;
      var stream = res;
      var lastRequest = res.req || req;

      if (res.statusCode !== 204 && lastRequest.method !== 'HEAD' && config.decompress !== false) {
        switch (res.headers['content-encoding']) {
          case 'gzip':
          case 'compress':
          case 'deflate':
            stream = stream.pipe(zlib.createUnzip());
            delete res.headers['content-encoding'];
            break;
        }
      }

      var response = {
        status: res.statusCode,
        statusText: res.statusMessage,
        headers: res.headers,
        config: config,
        request: lastRequest
      };

      if (config.responseType === 'stream') {
        response.data = stream;
        settle(resolve, reject, response);
      } else {
        var responseBuffer = [];
        stream.on('data', function handleStreamData(chunk) {
          responseBuffer.push(chunk);

          if (config.maxContentLength > -1 && Buffer.concat(responseBuffer).length > config.maxContentLength) {
            stream.destroy();
            reject(createError('maxContentLength size of ' + config.maxContentLength + ' exceeded', config, null, lastRequest));
          }
        });
        stream.on('error', function handleStreamError(err) {
          if (req.aborted) return;
          reject(enhanceError(err, config, null, lastRequest));
        });
        stream.on('end', function handleStreamEnd() {
          var responseData = Buffer.concat(responseBuffer);

          if (config.responseType !== 'arraybuffer') {
            responseData = responseData.toString(config.responseEncoding);

            if (!config.responseEncoding || config.responseEncoding === 'utf8') {
              responseData = utils.stripBOM(responseData);
            }
          }

          response.data = responseData;
          settle(resolve, reject, response);
        });
      }
    });
    req.on('error', function handleRequestError(err) {
      if (req.aborted && err.code !== 'ERR_FR_TOO_MANY_REDIRECTS') return;
      reject(enhanceError(err, config, null, req));
    });

    if (config.timeout) {
      req.setTimeout(config.timeout, function handleRequestTimeout() {
        req.abort();
        reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED', req));
      });
    }

    if (config.cancelToken) {
      config.cancelToken.promise.then(function onCanceled(cancel) {
        if (req.aborted) return;
        req.abort();
        reject(cancel);
      });
    }

    if (utils.isStream(data)) {
      data.on('error', function handleStreamError(err) {
        reject(enhanceError(err, config, null, req));
      }).pipe(req);
    } else {
      req.end(data);
    }
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHAuanMiXSwibmFtZXMiOlsidXRpbHMiLCJyZXF1aXJlIiwic2V0dGxlIiwiYnVpbGRGdWxsUGF0aCIsImJ1aWxkVVJMIiwiaHR0cCIsImh0dHBzIiwiaHR0cEZvbGxvdyIsImh0dHBzRm9sbG93IiwidXJsIiwiemxpYiIsInBrZyIsImNyZWF0ZUVycm9yIiwiZW5oYW5jZUVycm9yIiwiaXNIdHRwcyIsInNldFByb3h5Iiwib3B0aW9ucyIsInByb3h5IiwibG9jYXRpb24iLCJob3N0bmFtZSIsImhvc3QiLCJwb3J0IiwicGF0aCIsImF1dGgiLCJiYXNlNjQiLCJCdWZmZXIiLCJmcm9tIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRvU3RyaW5nIiwiaGVhZGVycyIsImJlZm9yZVJlZGlyZWN0IiwicmVkaXJlY3Rpb24iLCJocmVmIiwibW9kdWxlIiwiZXhwb3J0cyIsImh0dHBBZGFwdGVyIiwiY29uZmlnIiwiUHJvbWlzZSIsImRpc3BhdGNoSHR0cFJlcXVlc3QiLCJyZXNvbHZlUHJvbWlzZSIsInJlamVjdFByb21pc2UiLCJyZXNvbHZlIiwidmFsdWUiLCJyZWplY3QiLCJkYXRhIiwidmVyc2lvbiIsImlzU3RyZWFtIiwiaXNCdWZmZXIiLCJpc0FycmF5QnVmZmVyIiwiVWludDhBcnJheSIsImlzU3RyaW5nIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZnVsbFBhdGgiLCJiYXNlVVJMIiwicGFyc2VkIiwicGFyc2UiLCJwcm90b2NvbCIsInVybEF1dGgiLCJzcGxpdCIsInVybFVzZXJuYW1lIiwidXJsUGFzc3dvcmQiLCJBdXRob3JpemF0aW9uIiwiaXNIdHRwc1JlcXVlc3QiLCJ0ZXN0IiwiYWdlbnQiLCJodHRwc0FnZW50IiwiaHR0cEFnZW50IiwicGFyYW1zIiwicGFyYW1zU2VyaWFsaXplciIsInJlcGxhY2UiLCJtZXRob2QiLCJ0b1VwcGVyQ2FzZSIsImFnZW50cyIsInNvY2tldFBhdGgiLCJwcm94eUVudiIsInNsaWNlIiwicHJveHlVcmwiLCJwcm9jZXNzIiwiZW52IiwicGFyc2VkUHJveHlVcmwiLCJub1Byb3h5RW52Iiwibm9fcHJveHkiLCJOT19QUk9YWSIsInNob3VsZFByb3h5Iiwibm9Qcm94eSIsIm1hcCIsInRyaW0iLCJzIiwic29tZSIsInByb3h5TWF0Y2giLCJwcm94eUVsZW1lbnQiLCJzdWJzdHIiLCJwcm94eVVybEF1dGgiLCJ0cmFuc3BvcnQiLCJpc0h0dHBzUHJveHkiLCJtYXhSZWRpcmVjdHMiLCJtYXhCb2R5TGVuZ3RoIiwicmVxIiwicmVxdWVzdCIsImhhbmRsZVJlc3BvbnNlIiwicmVzIiwiYWJvcnRlZCIsInN0cmVhbSIsImxhc3RSZXF1ZXN0Iiwic3RhdHVzQ29kZSIsImRlY29tcHJlc3MiLCJwaXBlIiwiY3JlYXRlVW56aXAiLCJyZXNwb25zZSIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJzdGF0dXNNZXNzYWdlIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2VCdWZmZXIiLCJvbiIsImhhbmRsZVN0cmVhbURhdGEiLCJjaHVuayIsInB1c2giLCJtYXhDb250ZW50TGVuZ3RoIiwiY29uY2F0IiwiZGVzdHJveSIsImhhbmRsZVN0cmVhbUVycm9yIiwiZXJyIiwiaGFuZGxlU3RyZWFtRW5kIiwicmVzcG9uc2VEYXRhIiwicmVzcG9uc2VFbmNvZGluZyIsInN0cmlwQk9NIiwiaGFuZGxlUmVxdWVzdEVycm9yIiwiY29kZSIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiaGFuZGxlUmVxdWVzdFRpbWVvdXQiLCJhYm9ydCIsImNhbmNlbFRva2VuIiwicHJvbWlzZSIsInRoZW4iLCJvbkNhbmNlbGVkIiwiY2FuY2VsIiwiZW5kIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFJQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxZQUFELENBQW5COztBQUNBLElBQUlDLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGtCQUFELENBQXBCOztBQUNBLElBQUlFLGFBQWEsR0FBR0YsT0FBTyxDQUFDLHVCQUFELENBQTNCOztBQUNBLElBQUlHLFFBQVEsR0FBR0gsT0FBTyxDQUFDLHVCQUFELENBQXRCOztBQUNBLElBQUlJLElBQUksR0FBR0osT0FBTyxDQUFDLE1BQUQsQ0FBbEI7O0FBQ0EsSUFBSUssS0FBSyxHQUFHTCxPQUFPLENBQUMsT0FBRCxDQUFuQjs7QUFDQSxJQUFJTSxVQUFVLEdBQUdOLE9BQU8sQ0FBQyxrQkFBRCxDQUFQLENBQTRCSSxJQUE3Qzs7QUFDQSxJQUFJRyxXQUFXLEdBQUdQLE9BQU8sQ0FBQyxrQkFBRCxDQUFQLENBQTRCSyxLQUE5Qzs7QUFDQSxJQUFJRyxHQUFHLEdBQUdSLE9BQU8sQ0FBQyxLQUFELENBQWpCOztBQUNBLElBQUlTLElBQUksR0FBR1QsT0FBTyxDQUFDLE1BQUQsQ0FBbEI7O0FBQ0EsSUFBSVUsR0FBRyxHQUFHVixPQUFPLENBQUMsc0JBQUQsQ0FBakI7O0FBQ0EsSUFBSVcsV0FBVyxHQUFHWCxPQUFPLENBQUMscUJBQUQsQ0FBekI7O0FBQ0EsSUFBSVksWUFBWSxHQUFHWixPQUFPLENBQUMsc0JBQUQsQ0FBMUI7O0FBRUEsSUFBSWEsT0FBTyxHQUFHLFNBQWQ7O0FBUUEsU0FBU0MsUUFBVCxDQUFrQkMsT0FBbEIsRUFBMkJDLEtBQTNCLEVBQWtDQyxRQUFsQyxFQUE0QztBQUMxQ0YsRUFBQUEsT0FBTyxDQUFDRyxRQUFSLEdBQW1CRixLQUFLLENBQUNHLElBQXpCO0FBQ0FKLEVBQUFBLE9BQU8sQ0FBQ0ksSUFBUixHQUFlSCxLQUFLLENBQUNHLElBQXJCO0FBQ0FKLEVBQUFBLE9BQU8sQ0FBQ0ssSUFBUixHQUFlSixLQUFLLENBQUNJLElBQXJCO0FBQ0FMLEVBQUFBLE9BQU8sQ0FBQ00sSUFBUixHQUFlSixRQUFmOztBQUdBLE1BQUlELEtBQUssQ0FBQ00sSUFBVixFQUFnQjtBQUNkLFFBQUlDLE1BQU0sR0FBR0MsTUFBTSxDQUFDQyxJQUFQLENBQVlULEtBQUssQ0FBQ00sSUFBTixDQUFXSSxRQUFYLEdBQXNCLEdBQXRCLEdBQTRCVixLQUFLLENBQUNNLElBQU4sQ0FBV0ssUUFBbkQsRUFBNkQsTUFBN0QsRUFBcUVDLFFBQXJFLENBQThFLFFBQTlFLENBQWI7QUFDQWIsSUFBQUEsT0FBTyxDQUFDYyxPQUFSLENBQWdCLHFCQUFoQixJQUF5QyxXQUFXTixNQUFwRDtBQUNEOztBQUdEUixFQUFBQSxPQUFPLENBQUNlLGNBQVIsR0FBeUIsU0FBU0EsY0FBVCxDQUF3QkMsV0FBeEIsRUFBcUM7QUFDNURBLElBQUFBLFdBQVcsQ0FBQ0YsT0FBWixDQUFvQlYsSUFBcEIsR0FBMkJZLFdBQVcsQ0FBQ1osSUFBdkM7QUFDQUwsSUFBQUEsUUFBUSxDQUFDaUIsV0FBRCxFQUFjZixLQUFkLEVBQXFCZSxXQUFXLENBQUNDLElBQWpDLENBQVI7QUFDRCxHQUhEO0FBSUQ7O0FBR0RDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixTQUFTQyxXQUFULENBQXFCQyxNQUFyQixFQUE2QjtBQUM1QyxTQUFPLElBQUlDLE9BQUosQ0FBWSxTQUFTQyxtQkFBVCxDQUE2QkMsY0FBN0IsRUFBNkNDLGFBQTdDLEVBQTREO0FBQzdFLFFBQUlDLE9BQU8sR0FBRyxTQUFTQSxPQUFULENBQWlCQyxLQUFqQixFQUF3QjtBQUNwQ0gsTUFBQUEsY0FBYyxDQUFDRyxLQUFELENBQWQ7QUFDRCxLQUZEOztBQUdBLFFBQUlDLE1BQU0sR0FBRyxTQUFTQSxNQUFULENBQWdCRCxLQUFoQixFQUF1QjtBQUNsQ0YsTUFBQUEsYUFBYSxDQUFDRSxLQUFELENBQWI7QUFDRCxLQUZEOztBQUdBLFFBQUlFLElBQUksR0FBR1IsTUFBTSxDQUFDUSxJQUFsQjtBQUNBLFFBQUlmLE9BQU8sR0FBR08sTUFBTSxDQUFDUCxPQUFyQjs7QUFLQSxRQUFJLENBQUNBLE9BQU8sQ0FBQyxZQUFELENBQVIsSUFBMEIsQ0FBQ0EsT0FBTyxDQUFDLFlBQUQsQ0FBdEMsRUFBc0Q7QUFDcERBLE1BQUFBLE9BQU8sQ0FBQyxZQUFELENBQVAsR0FBd0IsV0FBV25CLEdBQUcsQ0FBQ21DLE9BQXZDO0FBQ0Q7O0FBRUQsUUFBSUQsSUFBSSxJQUFJLENBQUM3QyxLQUFLLENBQUMrQyxRQUFOLENBQWVGLElBQWYsQ0FBYixFQUFtQztBQUNqQyxVQUFJcEIsTUFBTSxDQUFDdUIsUUFBUCxDQUFnQkgsSUFBaEIsQ0FBSixFQUEyQixDQUUxQixDQUZELE1BRU8sSUFBSTdDLEtBQUssQ0FBQ2lELGFBQU4sQ0FBb0JKLElBQXBCLENBQUosRUFBK0I7QUFDcENBLFFBQUFBLElBQUksR0FBR3BCLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZLElBQUl3QixVQUFKLENBQWVMLElBQWYsQ0FBWixDQUFQO0FBQ0QsT0FGTSxNQUVBLElBQUk3QyxLQUFLLENBQUNtRCxRQUFOLENBQWVOLElBQWYsQ0FBSixFQUEwQjtBQUMvQkEsUUFBQUEsSUFBSSxHQUFHcEIsTUFBTSxDQUFDQyxJQUFQLENBQVltQixJQUFaLEVBQWtCLE9BQWxCLENBQVA7QUFDRCxPQUZNLE1BRUE7QUFDTCxlQUFPRCxNQUFNLENBQUNoQyxXQUFXLENBQ3ZCLG1GQUR1QixFQUV2QnlCLE1BRnVCLENBQVosQ0FBYjtBQUlEOztBQUdEUCxNQUFBQSxPQUFPLENBQUMsZ0JBQUQsQ0FBUCxHQUE0QmUsSUFBSSxDQUFDTyxNQUFqQztBQUNEOztBQUdELFFBQUk3QixJQUFJLEdBQUc4QixTQUFYOztBQUNBLFFBQUloQixNQUFNLENBQUNkLElBQVgsRUFBaUI7QUFDZixVQUFJSSxRQUFRLEdBQUdVLE1BQU0sQ0FBQ2QsSUFBUCxDQUFZSSxRQUFaLElBQXdCLEVBQXZDO0FBQ0EsVUFBSUMsUUFBUSxHQUFHUyxNQUFNLENBQUNkLElBQVAsQ0FBWUssUUFBWixJQUF3QixFQUF2QztBQUNBTCxNQUFBQSxJQUFJLEdBQUdJLFFBQVEsR0FBRyxHQUFYLEdBQWlCQyxRQUF4QjtBQUNEOztBQUdELFFBQUkwQixRQUFRLEdBQUduRCxhQUFhLENBQUNrQyxNQUFNLENBQUNrQixPQUFSLEVBQWlCbEIsTUFBTSxDQUFDNUIsR0FBeEIsQ0FBNUI7QUFDQSxRQUFJK0MsTUFBTSxHQUFHL0MsR0FBRyxDQUFDZ0QsS0FBSixDQUFVSCxRQUFWLENBQWI7QUFDQSxRQUFJSSxRQUFRLEdBQUdGLE1BQU0sQ0FBQ0UsUUFBUCxJQUFtQixPQUFsQzs7QUFFQSxRQUFJLENBQUNuQyxJQUFELElBQVNpQyxNQUFNLENBQUNqQyxJQUFwQixFQUEwQjtBQUN4QixVQUFJb0MsT0FBTyxHQUFHSCxNQUFNLENBQUNqQyxJQUFQLENBQVlxQyxLQUFaLENBQWtCLEdBQWxCLENBQWQ7QUFDQSxVQUFJQyxXQUFXLEdBQUdGLE9BQU8sQ0FBQyxDQUFELENBQVAsSUFBYyxFQUFoQztBQUNBLFVBQUlHLFdBQVcsR0FBR0gsT0FBTyxDQUFDLENBQUQsQ0FBUCxJQUFjLEVBQWhDO0FBQ0FwQyxNQUFBQSxJQUFJLEdBQUdzQyxXQUFXLEdBQUcsR0FBZCxHQUFvQkMsV0FBM0I7QUFDRDs7QUFFRCxRQUFJdkMsSUFBSixFQUFVO0FBQ1IsYUFBT08sT0FBTyxDQUFDaUMsYUFBZjtBQUNEOztBQUVELFFBQUlDLGNBQWMsR0FBR2xELE9BQU8sQ0FBQ21ELElBQVIsQ0FBYVAsUUFBYixDQUFyQjtBQUNBLFFBQUlRLEtBQUssR0FBR0YsY0FBYyxHQUFHM0IsTUFBTSxDQUFDOEIsVUFBVixHQUF1QjlCLE1BQU0sQ0FBQytCLFNBQXhEO0FBRUEsUUFBSXBELE9BQU8sR0FBRztBQUNaTSxNQUFBQSxJQUFJLEVBQUVsQixRQUFRLENBQUNvRCxNQUFNLENBQUNsQyxJQUFSLEVBQWNlLE1BQU0sQ0FBQ2dDLE1BQXJCLEVBQTZCaEMsTUFBTSxDQUFDaUMsZ0JBQXBDLENBQVIsQ0FBOERDLE9BQTlELENBQXNFLEtBQXRFLEVBQTZFLEVBQTdFLENBRE07QUFFWkMsTUFBQUEsTUFBTSxFQUFFbkMsTUFBTSxDQUFDbUMsTUFBUCxDQUFjQyxXQUFkLEVBRkk7QUFHWjNDLE1BQUFBLE9BQU8sRUFBRUEsT0FIRztBQUlab0MsTUFBQUEsS0FBSyxFQUFFQSxLQUpLO0FBS1pRLE1BQUFBLE1BQU0sRUFBRTtBQUFFckUsUUFBQUEsSUFBSSxFQUFFZ0MsTUFBTSxDQUFDK0IsU0FBZjtBQUEwQjlELFFBQUFBLEtBQUssRUFBRStCLE1BQU0sQ0FBQzhCO0FBQXhDLE9BTEk7QUFNWjVDLE1BQUFBLElBQUksRUFBRUE7QUFOTSxLQUFkOztBQVNBLFFBQUljLE1BQU0sQ0FBQ3NDLFVBQVgsRUFBdUI7QUFDckIzRCxNQUFBQSxPQUFPLENBQUMyRCxVQUFSLEdBQXFCdEMsTUFBTSxDQUFDc0MsVUFBNUI7QUFDRCxLQUZELE1BRU87QUFDTDNELE1BQUFBLE9BQU8sQ0FBQ0csUUFBUixHQUFtQnFDLE1BQU0sQ0FBQ3JDLFFBQTFCO0FBQ0FILE1BQUFBLE9BQU8sQ0FBQ0ssSUFBUixHQUFlbUMsTUFBTSxDQUFDbkMsSUFBdEI7QUFDRDs7QUFFRCxRQUFJSixLQUFLLEdBQUdvQixNQUFNLENBQUNwQixLQUFuQjs7QUFDQSxRQUFJLENBQUNBLEtBQUQsSUFBVUEsS0FBSyxLQUFLLEtBQXhCLEVBQStCO0FBQzdCLFVBQUkyRCxRQUFRLEdBQUdsQixRQUFRLENBQUNtQixLQUFULENBQWUsQ0FBZixFQUFrQixDQUFDLENBQW5CLElBQXdCLFFBQXZDO0FBQ0EsVUFBSUMsUUFBUSxHQUFHQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUosUUFBWixLQUF5QkcsT0FBTyxDQUFDQyxHQUFSLENBQVlKLFFBQVEsQ0FBQ0gsV0FBVCxFQUFaLENBQXhDOztBQUNBLFVBQUlLLFFBQUosRUFBYztBQUNaLFlBQUlHLGNBQWMsR0FBR3hFLEdBQUcsQ0FBQ2dELEtBQUosQ0FBVXFCLFFBQVYsQ0FBckI7QUFDQSxZQUFJSSxVQUFVLEdBQUdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZRyxRQUFaLElBQXdCSixPQUFPLENBQUNDLEdBQVIsQ0FBWUksUUFBckQ7QUFDQSxZQUFJQyxXQUFXLEdBQUcsSUFBbEI7O0FBRUEsWUFBSUgsVUFBSixFQUFnQjtBQUNkLGNBQUlJLE9BQU8sR0FBR0osVUFBVSxDQUFDdEIsS0FBWCxDQUFpQixHQUFqQixFQUFzQjJCLEdBQXRCLENBQTBCLFNBQVNDLElBQVQsQ0FBY0MsQ0FBZCxFQUFpQjtBQUN2RCxtQkFBT0EsQ0FBQyxDQUFDRCxJQUFGLEVBQVA7QUFDRCxXQUZhLENBQWQ7QUFJQUgsVUFBQUEsV0FBVyxHQUFHLENBQUNDLE9BQU8sQ0FBQ0ksSUFBUixDQUFhLFNBQVNDLFVBQVQsQ0FBb0JDLFlBQXBCLEVBQWtDO0FBQzVELGdCQUFJLENBQUNBLFlBQUwsRUFBbUI7QUFDakIscUJBQU8sS0FBUDtBQUNEOztBQUNELGdCQUFJQSxZQUFZLEtBQUssR0FBckIsRUFBMEI7QUFDeEIscUJBQU8sSUFBUDtBQUNEOztBQUNELGdCQUFJQSxZQUFZLENBQUMsQ0FBRCxDQUFaLEtBQW9CLEdBQXBCLElBQ0FwQyxNQUFNLENBQUNyQyxRQUFQLENBQWdCMEUsTUFBaEIsQ0FBdUJyQyxNQUFNLENBQUNyQyxRQUFQLENBQWdCaUMsTUFBaEIsR0FBeUJ3QyxZQUFZLENBQUN4QyxNQUE3RCxNQUF5RXdDLFlBRDdFLEVBQzJGO0FBQ3pGLHFCQUFPLElBQVA7QUFDRDs7QUFFRCxtQkFBT3BDLE1BQU0sQ0FBQ3JDLFFBQVAsS0FBb0J5RSxZQUEzQjtBQUNELFdBYmMsQ0FBZjtBQWNEOztBQUVELFlBQUlQLFdBQUosRUFBaUI7QUFDZnBFLFVBQUFBLEtBQUssR0FBRztBQUNORyxZQUFBQSxJQUFJLEVBQUU2RCxjQUFjLENBQUM5RCxRQURmO0FBRU5FLFlBQUFBLElBQUksRUFBRTRELGNBQWMsQ0FBQzVELElBRmY7QUFHTnFDLFlBQUFBLFFBQVEsRUFBRXVCLGNBQWMsQ0FBQ3ZCO0FBSG5CLFdBQVI7O0FBTUEsY0FBSXVCLGNBQWMsQ0FBQzFELElBQW5CLEVBQXlCO0FBQ3ZCLGdCQUFJdUUsWUFBWSxHQUFHYixjQUFjLENBQUMxRCxJQUFmLENBQW9CcUMsS0FBcEIsQ0FBMEIsR0FBMUIsQ0FBbkI7QUFDQTNDLFlBQUFBLEtBQUssQ0FBQ00sSUFBTixHQUFhO0FBQ1hJLGNBQUFBLFFBQVEsRUFBRW1FLFlBQVksQ0FBQyxDQUFELENBRFg7QUFFWGxFLGNBQUFBLFFBQVEsRUFBRWtFLFlBQVksQ0FBQyxDQUFEO0FBRlgsYUFBYjtBQUlEO0FBQ0Y7QUFDRjtBQUNGOztBQUVELFFBQUk3RSxLQUFKLEVBQVc7QUFDVEQsTUFBQUEsT0FBTyxDQUFDYyxPQUFSLENBQWdCVixJQUFoQixHQUF1Qm9DLE1BQU0sQ0FBQ3JDLFFBQVAsSUFBbUJxQyxNQUFNLENBQUNuQyxJQUFQLEdBQWMsTUFBTW1DLE1BQU0sQ0FBQ25DLElBQTNCLEdBQWtDLEVBQXJELENBQXZCO0FBQ0FOLE1BQUFBLFFBQVEsQ0FBQ0MsT0FBRCxFQUFVQyxLQUFWLEVBQWlCeUMsUUFBUSxHQUFHLElBQVgsR0FBa0JGLE1BQU0sQ0FBQ3JDLFFBQXpCLElBQXFDcUMsTUFBTSxDQUFDbkMsSUFBUCxHQUFjLE1BQU1tQyxNQUFNLENBQUNuQyxJQUEzQixHQUFrQyxFQUF2RSxJQUE2RUwsT0FBTyxDQUFDTSxJQUF0RyxDQUFSO0FBQ0Q7O0FBRUQsUUFBSXlFLFNBQUo7QUFDQSxRQUFJQyxZQUFZLEdBQUdoQyxjQUFjLEtBQUsvQyxLQUFLLEdBQUdILE9BQU8sQ0FBQ21ELElBQVIsQ0FBYWhELEtBQUssQ0FBQ3lDLFFBQW5CLENBQUgsR0FBa0MsSUFBNUMsQ0FBakM7O0FBQ0EsUUFBSXJCLE1BQU0sQ0FBQzBELFNBQVgsRUFBc0I7QUFDcEJBLE1BQUFBLFNBQVMsR0FBRzFELE1BQU0sQ0FBQzBELFNBQW5CO0FBQ0QsS0FGRCxNQUVPLElBQUkxRCxNQUFNLENBQUM0RCxZQUFQLEtBQXdCLENBQTVCLEVBQStCO0FBQ3BDRixNQUFBQSxTQUFTLEdBQUdDLFlBQVksR0FBRzFGLEtBQUgsR0FBV0QsSUFBbkM7QUFDRCxLQUZNLE1BRUE7QUFDTCxVQUFJZ0MsTUFBTSxDQUFDNEQsWUFBWCxFQUF5QjtBQUN2QmpGLFFBQUFBLE9BQU8sQ0FBQ2lGLFlBQVIsR0FBdUI1RCxNQUFNLENBQUM0RCxZQUE5QjtBQUNEOztBQUNERixNQUFBQSxTQUFTLEdBQUdDLFlBQVksR0FBR3hGLFdBQUgsR0FBaUJELFVBQXpDO0FBQ0Q7O0FBRUQsUUFBSThCLE1BQU0sQ0FBQzZELGFBQVAsR0FBdUIsQ0FBQyxDQUE1QixFQUErQjtBQUM3QmxGLE1BQUFBLE9BQU8sQ0FBQ2tGLGFBQVIsR0FBd0I3RCxNQUFNLENBQUM2RCxhQUEvQjtBQUNEOztBQUdELFFBQUlDLEdBQUcsR0FBR0osU0FBUyxDQUFDSyxPQUFWLENBQWtCcEYsT0FBbEIsRUFBMkIsU0FBU3FGLGNBQVQsQ0FBd0JDLEdBQXhCLEVBQTZCO0FBQ2hFLFVBQUlILEdBQUcsQ0FBQ0ksT0FBUixFQUFpQjtBQUdqQixVQUFJQyxNQUFNLEdBQUdGLEdBQWI7QUFHQSxVQUFJRyxXQUFXLEdBQUdILEdBQUcsQ0FBQ0gsR0FBSixJQUFXQSxHQUE3Qjs7QUFJQSxVQUFJRyxHQUFHLENBQUNJLFVBQUosS0FBbUIsR0FBbkIsSUFBMEJELFdBQVcsQ0FBQ2pDLE1BQVosS0FBdUIsTUFBakQsSUFBMkRuQyxNQUFNLENBQUNzRSxVQUFQLEtBQXNCLEtBQXJGLEVBQTRGO0FBQzFGLGdCQUFRTCxHQUFHLENBQUN4RSxPQUFKLENBQVksa0JBQVosQ0FBUjtBQUVBLGVBQUssTUFBTDtBQUNBLGVBQUssVUFBTDtBQUNBLGVBQUssU0FBTDtBQUVFMEUsWUFBQUEsTUFBTSxHQUFHQSxNQUFNLENBQUNJLElBQVAsQ0FBWWxHLElBQUksQ0FBQ21HLFdBQUwsRUFBWixDQUFUO0FBR0EsbUJBQU9QLEdBQUcsQ0FBQ3hFLE9BQUosQ0FBWSxrQkFBWixDQUFQO0FBQ0E7QUFWRjtBQVlEOztBQUVELFVBQUlnRixRQUFRLEdBQUc7QUFDYkMsUUFBQUEsTUFBTSxFQUFFVCxHQUFHLENBQUNJLFVBREM7QUFFYk0sUUFBQUEsVUFBVSxFQUFFVixHQUFHLENBQUNXLGFBRkg7QUFHYm5GLFFBQUFBLE9BQU8sRUFBRXdFLEdBQUcsQ0FBQ3hFLE9BSEE7QUFJYk8sUUFBQUEsTUFBTSxFQUFFQSxNQUpLO0FBS2IrRCxRQUFBQSxPQUFPLEVBQUVLO0FBTEksT0FBZjs7QUFRQSxVQUFJcEUsTUFBTSxDQUFDNkUsWUFBUCxLQUF3QixRQUE1QixFQUFzQztBQUNwQ0osUUFBQUEsUUFBUSxDQUFDakUsSUFBVCxHQUFnQjJELE1BQWhCO0FBQ0F0RyxRQUFBQSxNQUFNLENBQUN3QyxPQUFELEVBQVVFLE1BQVYsRUFBa0JrRSxRQUFsQixDQUFOO0FBQ0QsT0FIRCxNQUdPO0FBQ0wsWUFBSUssY0FBYyxHQUFHLEVBQXJCO0FBQ0FYLFFBQUFBLE1BQU0sQ0FBQ1ksRUFBUCxDQUFVLE1BQVYsRUFBa0IsU0FBU0MsZ0JBQVQsQ0FBMEJDLEtBQTFCLEVBQWlDO0FBQ2pESCxVQUFBQSxjQUFjLENBQUNJLElBQWYsQ0FBb0JELEtBQXBCOztBQUdBLGNBQUlqRixNQUFNLENBQUNtRixnQkFBUCxHQUEwQixDQUFDLENBQTNCLElBQWdDL0YsTUFBTSxDQUFDZ0csTUFBUCxDQUFjTixjQUFkLEVBQThCL0QsTUFBOUIsR0FBdUNmLE1BQU0sQ0FBQ21GLGdCQUFsRixFQUFvRztBQUNsR2hCLFlBQUFBLE1BQU0sQ0FBQ2tCLE9BQVA7QUFDQTlFLFlBQUFBLE1BQU0sQ0FBQ2hDLFdBQVcsQ0FBQyw4QkFBOEJ5QixNQUFNLENBQUNtRixnQkFBckMsR0FBd0QsV0FBekQsRUFDaEJuRixNQURnQixFQUNSLElBRFEsRUFDRm9FLFdBREUsQ0FBWixDQUFOO0FBRUQ7QUFDRixTQVREO0FBV0FELFFBQUFBLE1BQU0sQ0FBQ1ksRUFBUCxDQUFVLE9BQVYsRUFBbUIsU0FBU08saUJBQVQsQ0FBMkJDLEdBQTNCLEVBQWdDO0FBQ2pELGNBQUl6QixHQUFHLENBQUNJLE9BQVIsRUFBaUI7QUFDakIzRCxVQUFBQSxNQUFNLENBQUMvQixZQUFZLENBQUMrRyxHQUFELEVBQU12RixNQUFOLEVBQWMsSUFBZCxFQUFvQm9FLFdBQXBCLENBQWIsQ0FBTjtBQUNELFNBSEQ7QUFLQUQsUUFBQUEsTUFBTSxDQUFDWSxFQUFQLENBQVUsS0FBVixFQUFpQixTQUFTUyxlQUFULEdBQTJCO0FBQzFDLGNBQUlDLFlBQVksR0FBR3JHLE1BQU0sQ0FBQ2dHLE1BQVAsQ0FBY04sY0FBZCxDQUFuQjs7QUFDQSxjQUFJOUUsTUFBTSxDQUFDNkUsWUFBUCxLQUF3QixhQUE1QixFQUEyQztBQUN6Q1ksWUFBQUEsWUFBWSxHQUFHQSxZQUFZLENBQUNqRyxRQUFiLENBQXNCUSxNQUFNLENBQUMwRixnQkFBN0IsQ0FBZjs7QUFDQSxnQkFBSSxDQUFDMUYsTUFBTSxDQUFDMEYsZ0JBQVIsSUFBNEIxRixNQUFNLENBQUMwRixnQkFBUCxLQUE0QixNQUE1RCxFQUFvRTtBQUNsRUQsY0FBQUEsWUFBWSxHQUFHOUgsS0FBSyxDQUFDZ0ksUUFBTixDQUFlRixZQUFmLENBQWY7QUFDRDtBQUNGOztBQUVEaEIsVUFBQUEsUUFBUSxDQUFDakUsSUFBVCxHQUFnQmlGLFlBQWhCO0FBQ0E1SCxVQUFBQSxNQUFNLENBQUN3QyxPQUFELEVBQVVFLE1BQVYsRUFBa0JrRSxRQUFsQixDQUFOO0FBQ0QsU0FYRDtBQVlEO0FBQ0YsS0FwRVMsQ0FBVjtBQXVFQVgsSUFBQUEsR0FBRyxDQUFDaUIsRUFBSixDQUFPLE9BQVAsRUFBZ0IsU0FBU2Esa0JBQVQsQ0FBNEJMLEdBQTVCLEVBQWlDO0FBQy9DLFVBQUl6QixHQUFHLENBQUNJLE9BQUosSUFBZXFCLEdBQUcsQ0FBQ00sSUFBSixLQUFhLDJCQUFoQyxFQUE2RDtBQUM3RHRGLE1BQUFBLE1BQU0sQ0FBQy9CLFlBQVksQ0FBQytHLEdBQUQsRUFBTXZGLE1BQU4sRUFBYyxJQUFkLEVBQW9COEQsR0FBcEIsQ0FBYixDQUFOO0FBQ0QsS0FIRDs7QUFNQSxRQUFJOUQsTUFBTSxDQUFDOEYsT0FBWCxFQUFvQjtBQU1sQmhDLE1BQUFBLEdBQUcsQ0FBQ2lDLFVBQUosQ0FBZS9GLE1BQU0sQ0FBQzhGLE9BQXRCLEVBQStCLFNBQVNFLG9CQUFULEdBQWdDO0FBQzdEbEMsUUFBQUEsR0FBRyxDQUFDbUMsS0FBSjtBQUNBMUYsUUFBQUEsTUFBTSxDQUFDaEMsV0FBVyxDQUFDLGdCQUFnQnlCLE1BQU0sQ0FBQzhGLE9BQXZCLEdBQWlDLGFBQWxDLEVBQWlEOUYsTUFBakQsRUFBeUQsY0FBekQsRUFBeUU4RCxHQUF6RSxDQUFaLENBQU47QUFDRCxPQUhEO0FBSUQ7O0FBRUQsUUFBSTlELE1BQU0sQ0FBQ2tHLFdBQVgsRUFBd0I7QUFFdEJsRyxNQUFBQSxNQUFNLENBQUNrRyxXQUFQLENBQW1CQyxPQUFuQixDQUEyQkMsSUFBM0IsQ0FBZ0MsU0FBU0MsVUFBVCxDQUFvQkMsTUFBcEIsRUFBNEI7QUFDMUQsWUFBSXhDLEdBQUcsQ0FBQ0ksT0FBUixFQUFpQjtBQUVqQkosUUFBQUEsR0FBRyxDQUFDbUMsS0FBSjtBQUNBMUYsUUFBQUEsTUFBTSxDQUFDK0YsTUFBRCxDQUFOO0FBQ0QsT0FMRDtBQU1EOztBQUdELFFBQUkzSSxLQUFLLENBQUMrQyxRQUFOLENBQWVGLElBQWYsQ0FBSixFQUEwQjtBQUN4QkEsTUFBQUEsSUFBSSxDQUFDdUUsRUFBTCxDQUFRLE9BQVIsRUFBaUIsU0FBU08saUJBQVQsQ0FBMkJDLEdBQTNCLEVBQWdDO0FBQy9DaEYsUUFBQUEsTUFBTSxDQUFDL0IsWUFBWSxDQUFDK0csR0FBRCxFQUFNdkYsTUFBTixFQUFjLElBQWQsRUFBb0I4RCxHQUFwQixDQUFiLENBQU47QUFDRCxPQUZELEVBRUdTLElBRkgsQ0FFUVQsR0FGUjtBQUdELEtBSkQsTUFJTztBQUNMQSxNQUFBQSxHQUFHLENBQUN5QyxHQUFKLENBQVEvRixJQUFSO0FBQ0Q7QUFDRixHQWhRTSxDQUFQO0FBaVFELENBbFFEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgc2V0dGxlID0gcmVxdWlyZSgnLi8uLi9jb3JlL3NldHRsZScpO1xudmFyIGJ1aWxkRnVsbFBhdGggPSByZXF1aXJlKCcuLi9jb3JlL2J1aWxkRnVsbFBhdGgnKTtcbnZhciBidWlsZFVSTCA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9idWlsZFVSTCcpO1xudmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XG52YXIgaHR0cHMgPSByZXF1aXJlKCdodHRwcycpO1xudmFyIGh0dHBGb2xsb3cgPSByZXF1aXJlKCdmb2xsb3ctcmVkaXJlY3RzJykuaHR0cDtcbnZhciBodHRwc0ZvbGxvdyA9IHJlcXVpcmUoJ2ZvbGxvdy1yZWRpcmVjdHMnKS5odHRwcztcbnZhciB1cmwgPSByZXF1aXJlKCd1cmwnKTtcbnZhciB6bGliID0gcmVxdWlyZSgnemxpYicpO1xudmFyIHBrZyA9IHJlcXVpcmUoJy4vLi4vLi4vcGFja2FnZS5qc29uJyk7XG52YXIgY3JlYXRlRXJyb3IgPSByZXF1aXJlKCcuLi9jb3JlL2NyZWF0ZUVycm9yJyk7XG52YXIgZW5oYW5jZUVycm9yID0gcmVxdWlyZSgnLi4vY29yZS9lbmhhbmNlRXJyb3InKTtcblxudmFyIGlzSHR0cHMgPSAvaHR0cHM6Py87XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7aHR0cC5DbGllbnRSZXF1ZXN0QXJnc30gb3B0aW9uc1xuICogQHBhcmFtIHtBeGlvc1Byb3h5Q29uZmlnfSBwcm94eVxuICogQHBhcmFtIHtzdHJpbmd9IGxvY2F0aW9uXG4gKi9cbmZ1bmN0aW9uIHNldFByb3h5KG9wdGlvbnMsIHByb3h5LCBsb2NhdGlvbikge1xuICBvcHRpb25zLmhvc3RuYW1lID0gcHJveHkuaG9zdDtcbiAgb3B0aW9ucy5ob3N0ID0gcHJveHkuaG9zdDtcbiAgb3B0aW9ucy5wb3J0ID0gcHJveHkucG9ydDtcbiAgb3B0aW9ucy5wYXRoID0gbG9jYXRpb247XG5cbiAgLy8gQmFzaWMgcHJveHkgYXV0aG9yaXphdGlvblxuICBpZiAocHJveHkuYXV0aCkge1xuICAgIHZhciBiYXNlNjQgPSBCdWZmZXIuZnJvbShwcm94eS5hdXRoLnVzZXJuYW1lICsgJzonICsgcHJveHkuYXV0aC5wYXNzd29yZCwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgb3B0aW9ucy5oZWFkZXJzWydQcm94eS1BdXRob3JpemF0aW9uJ10gPSAnQmFzaWMgJyArIGJhc2U2NDtcbiAgfVxuXG4gIC8vIElmIGEgcHJveHkgaXMgdXNlZCwgYW55IHJlZGlyZWN0cyBtdXN0IGFsc28gcGFzcyB0aHJvdWdoIHRoZSBwcm94eVxuICBvcHRpb25zLmJlZm9yZVJlZGlyZWN0ID0gZnVuY3Rpb24gYmVmb3JlUmVkaXJlY3QocmVkaXJlY3Rpb24pIHtcbiAgICByZWRpcmVjdGlvbi5oZWFkZXJzLmhvc3QgPSByZWRpcmVjdGlvbi5ob3N0O1xuICAgIHNldFByb3h5KHJlZGlyZWN0aW9uLCBwcm94eSwgcmVkaXJlY3Rpb24uaHJlZik7XG4gIH07XG59XG5cbi8qZXNsaW50IGNvbnNpc3RlbnQtcmV0dXJuOjAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBodHRwQWRhcHRlcihjb25maWcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIGRpc3BhdGNoSHR0cFJlcXVlc3QocmVzb2x2ZVByb21pc2UsIHJlamVjdFByb21pc2UpIHtcbiAgICB2YXIgcmVzb2x2ZSA9IGZ1bmN0aW9uIHJlc29sdmUodmFsdWUpIHtcbiAgICAgIHJlc29sdmVQcm9taXNlKHZhbHVlKTtcbiAgICB9O1xuICAgIHZhciByZWplY3QgPSBmdW5jdGlvbiByZWplY3QodmFsdWUpIHtcbiAgICAgIHJlamVjdFByb21pc2UodmFsdWUpO1xuICAgIH07XG4gICAgdmFyIGRhdGEgPSBjb25maWcuZGF0YTtcbiAgICB2YXIgaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xuXG4gICAgLy8gU2V0IFVzZXItQWdlbnQgKHJlcXVpcmVkIGJ5IHNvbWUgc2VydmVycylcbiAgICAvLyBPbmx5IHNldCBoZWFkZXIgaWYgaXQgaGFzbid0IGJlZW4gc2V0IGluIGNvbmZpZ1xuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhpb3MvYXhpb3MvaXNzdWVzLzY5XG4gICAgaWYgKCFoZWFkZXJzWydVc2VyLUFnZW50J10gJiYgIWhlYWRlcnNbJ3VzZXItYWdlbnQnXSkge1xuICAgICAgaGVhZGVyc1snVXNlci1BZ2VudCddID0gJ2F4aW9zLycgKyBwa2cudmVyc2lvbjtcbiAgICB9XG5cbiAgICBpZiAoZGF0YSAmJiAhdXRpbHMuaXNTdHJlYW0oZGF0YSkpIHtcbiAgICAgIGlmIChCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIHtcbiAgICAgICAgLy8gTm90aGluZyB0byBkby4uLlxuICAgICAgfSBlbHNlIGlmICh1dGlscy5pc0FycmF5QnVmZmVyKGRhdGEpKSB7XG4gICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgICB9IGVsc2UgaWYgKHV0aWxzLmlzU3RyaW5nKGRhdGEpKSB7XG4gICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShkYXRhLCAndXRmLTgnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZWplY3QoY3JlYXRlRXJyb3IoXG4gICAgICAgICAgJ0RhdGEgYWZ0ZXIgdHJhbnNmb3JtYXRpb24gbXVzdCBiZSBhIHN0cmluZywgYW4gQXJyYXlCdWZmZXIsIGEgQnVmZmVyLCBvciBhIFN0cmVhbScsXG4gICAgICAgICAgY29uZmlnXG4gICAgICAgICkpO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgQ29udGVudC1MZW5ndGggaGVhZGVyIGlmIGRhdGEgZXhpc3RzXG4gICAgICBoZWFkZXJzWydDb250ZW50LUxlbmd0aCddID0gZGF0YS5sZW5ndGg7XG4gICAgfVxuXG4gICAgLy8gSFRUUCBiYXNpYyBhdXRoZW50aWNhdGlvblxuICAgIHZhciBhdXRoID0gdW5kZWZpbmVkO1xuICAgIGlmIChjb25maWcuYXV0aCkge1xuICAgICAgdmFyIHVzZXJuYW1lID0gY29uZmlnLmF1dGgudXNlcm5hbWUgfHwgJyc7XG4gICAgICB2YXIgcGFzc3dvcmQgPSBjb25maWcuYXV0aC5wYXNzd29yZCB8fCAnJztcbiAgICAgIGF1dGggPSB1c2VybmFtZSArICc6JyArIHBhc3N3b3JkO1xuICAgIH1cblxuICAgIC8vIFBhcnNlIHVybFxuICAgIHZhciBmdWxsUGF0aCA9IGJ1aWxkRnVsbFBhdGgoY29uZmlnLmJhc2VVUkwsIGNvbmZpZy51cmwpO1xuICAgIHZhciBwYXJzZWQgPSB1cmwucGFyc2UoZnVsbFBhdGgpO1xuICAgIHZhciBwcm90b2NvbCA9IHBhcnNlZC5wcm90b2NvbCB8fCAnaHR0cDonO1xuXG4gICAgaWYgKCFhdXRoICYmIHBhcnNlZC5hdXRoKSB7XG4gICAgICB2YXIgdXJsQXV0aCA9IHBhcnNlZC5hdXRoLnNwbGl0KCc6Jyk7XG4gICAgICB2YXIgdXJsVXNlcm5hbWUgPSB1cmxBdXRoWzBdIHx8ICcnO1xuICAgICAgdmFyIHVybFBhc3N3b3JkID0gdXJsQXV0aFsxXSB8fCAnJztcbiAgICAgIGF1dGggPSB1cmxVc2VybmFtZSArICc6JyArIHVybFBhc3N3b3JkO1xuICAgIH1cblxuICAgIGlmIChhdXRoKSB7XG4gICAgICBkZWxldGUgaGVhZGVycy5BdXRob3JpemF0aW9uO1xuICAgIH1cblxuICAgIHZhciBpc0h0dHBzUmVxdWVzdCA9IGlzSHR0cHMudGVzdChwcm90b2NvbCk7XG4gICAgdmFyIGFnZW50ID0gaXNIdHRwc1JlcXVlc3QgPyBjb25maWcuaHR0cHNBZ2VudCA6IGNvbmZpZy5odHRwQWdlbnQ7XG5cbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIHBhdGg6IGJ1aWxkVVJMKHBhcnNlZC5wYXRoLCBjb25maWcucGFyYW1zLCBjb25maWcucGFyYW1zU2VyaWFsaXplcikucmVwbGFjZSgvXlxcPy8sICcnKSxcbiAgICAgIG1ldGhvZDogY29uZmlnLm1ldGhvZC50b1VwcGVyQ2FzZSgpLFxuICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgIGFnZW50OiBhZ2VudCxcbiAgICAgIGFnZW50czogeyBodHRwOiBjb25maWcuaHR0cEFnZW50LCBodHRwczogY29uZmlnLmh0dHBzQWdlbnQgfSxcbiAgICAgIGF1dGg6IGF1dGhcbiAgICB9O1xuXG4gICAgaWYgKGNvbmZpZy5zb2NrZXRQYXRoKSB7XG4gICAgICBvcHRpb25zLnNvY2tldFBhdGggPSBjb25maWcuc29ja2V0UGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0aW9ucy5ob3N0bmFtZSA9IHBhcnNlZC5ob3N0bmFtZTtcbiAgICAgIG9wdGlvbnMucG9ydCA9IHBhcnNlZC5wb3J0O1xuICAgIH1cblxuICAgIHZhciBwcm94eSA9IGNvbmZpZy5wcm94eTtcbiAgICBpZiAoIXByb3h5ICYmIHByb3h5ICE9PSBmYWxzZSkge1xuICAgICAgdmFyIHByb3h5RW52ID0gcHJvdG9jb2wuc2xpY2UoMCwgLTEpICsgJ19wcm94eSc7XG4gICAgICB2YXIgcHJveHlVcmwgPSBwcm9jZXNzLmVudltwcm94eUVudl0gfHwgcHJvY2Vzcy5lbnZbcHJveHlFbnYudG9VcHBlckNhc2UoKV07XG4gICAgICBpZiAocHJveHlVcmwpIHtcbiAgICAgICAgdmFyIHBhcnNlZFByb3h5VXJsID0gdXJsLnBhcnNlKHByb3h5VXJsKTtcbiAgICAgICAgdmFyIG5vUHJveHlFbnYgPSBwcm9jZXNzLmVudi5ub19wcm94eSB8fCBwcm9jZXNzLmVudi5OT19QUk9YWTtcbiAgICAgICAgdmFyIHNob3VsZFByb3h5ID0gdHJ1ZTtcblxuICAgICAgICBpZiAobm9Qcm94eUVudikge1xuICAgICAgICAgIHZhciBub1Byb3h5ID0gbm9Qcm94eUVudi5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbiB0cmltKHMpIHtcbiAgICAgICAgICAgIHJldHVybiBzLnRyaW0oKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHNob3VsZFByb3h5ID0gIW5vUHJveHkuc29tZShmdW5jdGlvbiBwcm94eU1hdGNoKHByb3h5RWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKCFwcm94eUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3h5RWxlbWVudCA9PT0gJyonKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3h5RWxlbWVudFswXSA9PT0gJy4nICYmXG4gICAgICAgICAgICAgICAgcGFyc2VkLmhvc3RuYW1lLnN1YnN0cihwYXJzZWQuaG9zdG5hbWUubGVuZ3RoIC0gcHJveHlFbGVtZW50Lmxlbmd0aCkgPT09IHByb3h5RWxlbWVudCkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlZC5ob3N0bmFtZSA9PT0gcHJveHlFbGVtZW50O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNob3VsZFByb3h5KSB7XG4gICAgICAgICAgcHJveHkgPSB7XG4gICAgICAgICAgICBob3N0OiBwYXJzZWRQcm94eVVybC5ob3N0bmFtZSxcbiAgICAgICAgICAgIHBvcnQ6IHBhcnNlZFByb3h5VXJsLnBvcnQsXG4gICAgICAgICAgICBwcm90b2NvbDogcGFyc2VkUHJveHlVcmwucHJvdG9jb2xcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgaWYgKHBhcnNlZFByb3h5VXJsLmF1dGgpIHtcbiAgICAgICAgICAgIHZhciBwcm94eVVybEF1dGggPSBwYXJzZWRQcm94eVVybC5hdXRoLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICBwcm94eS5hdXRoID0ge1xuICAgICAgICAgICAgICB1c2VybmFtZTogcHJveHlVcmxBdXRoWzBdLFxuICAgICAgICAgICAgICBwYXNzd29yZDogcHJveHlVcmxBdXRoWzFdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm94eSkge1xuICAgICAgb3B0aW9ucy5oZWFkZXJzLmhvc3QgPSBwYXJzZWQuaG9zdG5hbWUgKyAocGFyc2VkLnBvcnQgPyAnOicgKyBwYXJzZWQucG9ydCA6ICcnKTtcbiAgICAgIHNldFByb3h5KG9wdGlvbnMsIHByb3h5LCBwcm90b2NvbCArICcvLycgKyBwYXJzZWQuaG9zdG5hbWUgKyAocGFyc2VkLnBvcnQgPyAnOicgKyBwYXJzZWQucG9ydCA6ICcnKSArIG9wdGlvbnMucGF0aCk7XG4gICAgfVxuXG4gICAgdmFyIHRyYW5zcG9ydDtcbiAgICB2YXIgaXNIdHRwc1Byb3h5ID0gaXNIdHRwc1JlcXVlc3QgJiYgKHByb3h5ID8gaXNIdHRwcy50ZXN0KHByb3h5LnByb3RvY29sKSA6IHRydWUpO1xuICAgIGlmIChjb25maWcudHJhbnNwb3J0KSB7XG4gICAgICB0cmFuc3BvcnQgPSBjb25maWcudHJhbnNwb3J0O1xuICAgIH0gZWxzZSBpZiAoY29uZmlnLm1heFJlZGlyZWN0cyA9PT0gMCkge1xuICAgICAgdHJhbnNwb3J0ID0gaXNIdHRwc1Byb3h5ID8gaHR0cHMgOiBodHRwO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY29uZmlnLm1heFJlZGlyZWN0cykge1xuICAgICAgICBvcHRpb25zLm1heFJlZGlyZWN0cyA9IGNvbmZpZy5tYXhSZWRpcmVjdHM7XG4gICAgICB9XG4gICAgICB0cmFuc3BvcnQgPSBpc0h0dHBzUHJveHkgPyBodHRwc0ZvbGxvdyA6IGh0dHBGb2xsb3c7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5tYXhCb2R5TGVuZ3RoID4gLTEpIHtcbiAgICAgIG9wdGlvbnMubWF4Qm9keUxlbmd0aCA9IGNvbmZpZy5tYXhCb2R5TGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB0aGUgcmVxdWVzdFxuICAgIHZhciByZXEgPSB0cmFuc3BvcnQucmVxdWVzdChvcHRpb25zLCBmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXMpIHtcbiAgICAgIGlmIChyZXEuYWJvcnRlZCkgcmV0dXJuO1xuXG4gICAgICAvLyB1bmNvbXByZXNzIHRoZSByZXNwb25zZSBib2R5IHRyYW5zcGFyZW50bHkgaWYgcmVxdWlyZWRcbiAgICAgIHZhciBzdHJlYW0gPSByZXM7XG5cbiAgICAgIC8vIHJldHVybiB0aGUgbGFzdCByZXF1ZXN0IGluIGNhc2Ugb2YgcmVkaXJlY3RzXG4gICAgICB2YXIgbGFzdFJlcXVlc3QgPSByZXMucmVxIHx8IHJlcTtcblxuXG4gICAgICAvLyBpZiBubyBjb250ZW50LCBpcyBIRUFEIHJlcXVlc3Qgb3IgZGVjb21wcmVzcyBkaXNhYmxlZCB3ZSBzaG91bGQgbm90IGRlY29tcHJlc3NcbiAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSAhPT0gMjA0ICYmIGxhc3RSZXF1ZXN0Lm1ldGhvZCAhPT0gJ0hFQUQnICYmIGNvbmZpZy5kZWNvbXByZXNzICE9PSBmYWxzZSkge1xuICAgICAgICBzd2l0Y2ggKHJlcy5oZWFkZXJzWydjb250ZW50LWVuY29kaW5nJ10pIHtcbiAgICAgICAgLyplc2xpbnQgZGVmYXVsdC1jYXNlOjAqL1xuICAgICAgICBjYXNlICdnemlwJzpcbiAgICAgICAgY2FzZSAnY29tcHJlc3MnOlxuICAgICAgICBjYXNlICdkZWZsYXRlJzpcbiAgICAgICAgLy8gYWRkIHRoZSB1bnppcHBlciB0byB0aGUgYm9keSBzdHJlYW0gcHJvY2Vzc2luZyBwaXBlbGluZVxuICAgICAgICAgIHN0cmVhbSA9IHN0cmVhbS5waXBlKHpsaWIuY3JlYXRlVW56aXAoKSk7XG5cbiAgICAgICAgICAvLyByZW1vdmUgdGhlIGNvbnRlbnQtZW5jb2RpbmcgaW4gb3JkZXIgdG8gbm90IGNvbmZ1c2UgZG93bnN0cmVhbSBvcGVyYXRpb25zXG4gICAgICAgICAgZGVsZXRlIHJlcy5oZWFkZXJzWydjb250ZW50LWVuY29kaW5nJ107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHJlc3BvbnNlID0ge1xuICAgICAgICBzdGF0dXM6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXMuc3RhdHVzTWVzc2FnZSxcbiAgICAgICAgaGVhZGVyczogcmVzLmhlYWRlcnMsXG4gICAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgICByZXF1ZXN0OiBsYXN0UmVxdWVzdFxuICAgICAgfTtcblxuICAgICAgaWYgKGNvbmZpZy5yZXNwb25zZVR5cGUgPT09ICdzdHJlYW0nKSB7XG4gICAgICAgIHJlc3BvbnNlLmRhdGEgPSBzdHJlYW07XG4gICAgICAgIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXNwb25zZUJ1ZmZlciA9IFtdO1xuICAgICAgICBzdHJlYW0ub24oJ2RhdGEnLCBmdW5jdGlvbiBoYW5kbGVTdHJlYW1EYXRhKGNodW5rKSB7XG4gICAgICAgICAgcmVzcG9uc2VCdWZmZXIucHVzaChjaHVuayk7XG5cbiAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhlIGNvbnRlbnQgbGVuZ3RoIGlzIG5vdCBvdmVyIHRoZSBtYXhDb250ZW50TGVuZ3RoIGlmIHNwZWNpZmllZFxuICAgICAgICAgIGlmIChjb25maWcubWF4Q29udGVudExlbmd0aCA+IC0xICYmIEJ1ZmZlci5jb25jYXQocmVzcG9uc2VCdWZmZXIpLmxlbmd0aCA+IGNvbmZpZy5tYXhDb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgICAgICAgICAgcmVqZWN0KGNyZWF0ZUVycm9yKCdtYXhDb250ZW50TGVuZ3RoIHNpemUgb2YgJyArIGNvbmZpZy5tYXhDb250ZW50TGVuZ3RoICsgJyBleGNlZWRlZCcsXG4gICAgICAgICAgICAgIGNvbmZpZywgbnVsbCwgbGFzdFJlcXVlc3QpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN0cmVhbS5vbignZXJyb3InLCBmdW5jdGlvbiBoYW5kbGVTdHJlYW1FcnJvcihlcnIpIHtcbiAgICAgICAgICBpZiAocmVxLmFib3J0ZWQpIHJldHVybjtcbiAgICAgICAgICByZWplY3QoZW5oYW5jZUVycm9yKGVyciwgY29uZmlnLCBudWxsLCBsYXN0UmVxdWVzdCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzdHJlYW0ub24oJ2VuZCcsIGZ1bmN0aW9uIGhhbmRsZVN0cmVhbUVuZCgpIHtcbiAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gQnVmZmVyLmNvbmNhdChyZXNwb25zZUJ1ZmZlcik7XG4gICAgICAgICAgaWYgKGNvbmZpZy5yZXNwb25zZVR5cGUgIT09ICdhcnJheWJ1ZmZlcicpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IHJlc3BvbnNlRGF0YS50b1N0cmluZyhjb25maWcucmVzcG9uc2VFbmNvZGluZyk7XG4gICAgICAgICAgICBpZiAoIWNvbmZpZy5yZXNwb25zZUVuY29kaW5nIHx8IGNvbmZpZy5yZXNwb25zZUVuY29kaW5nID09PSAndXRmOCcpIHtcbiAgICAgICAgICAgICAgcmVzcG9uc2VEYXRhID0gdXRpbHMuc3RyaXBCT00ocmVzcG9uc2VEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXNwb25zZS5kYXRhID0gcmVzcG9uc2VEYXRhO1xuICAgICAgICAgIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBIYW5kbGUgZXJyb3JzXG4gICAgcmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uIGhhbmRsZVJlcXVlc3RFcnJvcihlcnIpIHtcbiAgICAgIGlmIChyZXEuYWJvcnRlZCAmJiBlcnIuY29kZSAhPT0gJ0VSUl9GUl9UT09fTUFOWV9SRURJUkVDVFMnKSByZXR1cm47XG4gICAgICByZWplY3QoZW5oYW5jZUVycm9yKGVyciwgY29uZmlnLCBudWxsLCByZXEpKTtcbiAgICB9KTtcblxuICAgIC8vIEhhbmRsZSByZXF1ZXN0IHRpbWVvdXRcbiAgICBpZiAoY29uZmlnLnRpbWVvdXQpIHtcbiAgICAgIC8vIFNvbWV0aW1lLCB0aGUgcmVzcG9uc2Ugd2lsbCBiZSB2ZXJ5IHNsb3csIGFuZCBkb2VzIG5vdCByZXNwb25kLCB0aGUgY29ubmVjdCBldmVudCB3aWxsIGJlIGJsb2NrIGJ5IGV2ZW50IGxvb3Agc3lzdGVtLlxuICAgICAgLy8gQW5kIHRpbWVyIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQsIGFuZCBhYm9ydCgpIHdpbGwgYmUgaW52b2tlZCBiZWZvcmUgY29ubmVjdGlvbiwgdGhlbiBnZXQgXCJzb2NrZXQgaGFuZyB1cFwiIGFuZCBjb2RlIEVDT05OUkVTRVQuXG4gICAgICAvLyBBdCB0aGlzIHRpbWUsIGlmIHdlIGhhdmUgYSBsYXJnZSBudW1iZXIgb2YgcmVxdWVzdCwgbm9kZWpzIHdpbGwgaGFuZyB1cCBzb21lIHNvY2tldCBvbiBiYWNrZ3JvdW5kLiBhbmQgdGhlIG51bWJlciB3aWxsIHVwIGFuZCB1cC5cbiAgICAgIC8vIEFuZCB0aGVuIHRoZXNlIHNvY2tldCB3aGljaCBiZSBoYW5nIHVwIHdpbGwgZGV2b3JpbmcgQ1BVIGxpdHRsZSBieSBsaXR0bGUuXG4gICAgICAvLyBDbGllbnRSZXF1ZXN0LnNldFRpbWVvdXQgd2lsbCBiZSBmaXJlZCBvbiB0aGUgc3BlY2lmeSBtaWxsaXNlY29uZHMsIGFuZCBjYW4gbWFrZSBzdXJlIHRoYXQgYWJvcnQoKSB3aWxsIGJlIGZpcmVkIGFmdGVyIGNvbm5lY3QuXG4gICAgICByZXEuc2V0VGltZW91dChjb25maWcudGltZW91dCwgZnVuY3Rpb24gaGFuZGxlUmVxdWVzdFRpbWVvdXQoKSB7XG4gICAgICAgIHJlcS5hYm9ydCgpO1xuICAgICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ3RpbWVvdXQgb2YgJyArIGNvbmZpZy50aW1lb3V0ICsgJ21zIGV4Y2VlZGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJywgcmVxKSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmNhbmNlbFRva2VuKSB7XG4gICAgICAvLyBIYW5kbGUgY2FuY2VsbGF0aW9uXG4gICAgICBjb25maWcuY2FuY2VsVG9rZW4ucHJvbWlzZS50aGVuKGZ1bmN0aW9uIG9uQ2FuY2VsZWQoY2FuY2VsKSB7XG4gICAgICAgIGlmIChyZXEuYWJvcnRlZCkgcmV0dXJuO1xuXG4gICAgICAgIHJlcS5hYm9ydCgpO1xuICAgICAgICByZWplY3QoY2FuY2VsKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFNlbmQgdGhlIHJlcXVlc3RcbiAgICBpZiAodXRpbHMuaXNTdHJlYW0oZGF0YSkpIHtcbiAgICAgIGRhdGEub24oJ2Vycm9yJywgZnVuY3Rpb24gaGFuZGxlU3RyZWFtRXJyb3IoZXJyKSB7XG4gICAgICAgIHJlamVjdChlbmhhbmNlRXJyb3IoZXJyLCBjb25maWcsIG51bGwsIHJlcSkpO1xuICAgICAgfSkucGlwZShyZXEpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXEuZW5kKGRhdGEpO1xuICAgIH1cbiAgfSk7XG59O1xuIl19