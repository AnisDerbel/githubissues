b5f6d91b57ca86741e45a17c31f55e5d
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports["default"] = void 0;

var _isPromise = _interopRequireDefault(require("is-promise"));

var asyncValidation = function asyncValidation(fn, start, stop, field) {
  start(field);
  var promise = fn();

  if (!(0, _isPromise["default"])(promise)) {
    throw new Error('asyncValidate function passed to reduxForm must return a promise');
  }

  var handleErrors = function handleErrors(rejected) {
    return function (errors) {
      if (rejected) {
        if (errors && Object.keys(errors).length) {
          stop(errors);
          return errors;
        } else {
          stop();
          throw new Error('Asynchronous validation promise was rejected without errors.');
        }
      }

      stop();
      return Promise.resolve();
    };
  };

  return promise.then(handleErrors(false), handleErrors(true));
};

var _default = asyncValidation;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jVmFsaWRhdGlvbi5qcyJdLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiX2lzUHJvbWlzZSIsImFzeW5jVmFsaWRhdGlvbiIsImZuIiwic3RhcnQiLCJzdG9wIiwiZmllbGQiLCJwcm9taXNlIiwiRXJyb3IiLCJoYW5kbGVFcnJvcnMiLCJyZWplY3RlZCIsImVycm9ycyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJfZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBRCxDQUFwQzs7QUFFQUMsT0FBTyxDQUFDQyxVQUFSLEdBQXFCLElBQXJCO0FBQ0FELE9BQU8sQ0FBQyxTQUFELENBQVAsR0FBcUIsS0FBSyxDQUExQjs7QUFFQSxJQUFJRSxVQUFVLEdBQUdKLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFSLENBQXZDOztBQUVBLElBQUlJLGVBQWUsR0FBRyxTQUFTQSxlQUFULENBQXlCQyxFQUF6QixFQUE2QkMsS0FBN0IsRUFBb0NDLElBQXBDLEVBQTBDQyxLQUExQyxFQUFpRDtBQUNyRUYsRUFBQUEsS0FBSyxDQUFDRSxLQUFELENBQUw7QUFDQSxNQUFJQyxPQUFPLEdBQUdKLEVBQUUsRUFBaEI7O0FBRUEsTUFBSSxDQUFDLENBQUMsR0FBR0YsVUFBVSxDQUFDLFNBQUQsQ0FBZCxFQUEyQk0sT0FBM0IsQ0FBTCxFQUEwQztBQUN4QyxVQUFNLElBQUlDLEtBQUosQ0FBVSxrRUFBVixDQUFOO0FBQ0Q7O0FBRUQsTUFBSUMsWUFBWSxHQUFHLFNBQVNBLFlBQVQsQ0FBc0JDLFFBQXRCLEVBQWdDO0FBQ2pELFdBQU8sVUFBVUMsTUFBVixFQUFrQjtBQUN2QixVQUFJRCxRQUFKLEVBQWM7QUFDWixZQUFJQyxNQUFNLElBQUlDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZRixNQUFaLEVBQW9CRyxNQUFsQyxFQUEwQztBQUN4Q1QsVUFBQUEsSUFBSSxDQUFDTSxNQUFELENBQUo7QUFDQSxpQkFBT0EsTUFBUDtBQUNELFNBSEQsTUFHTztBQUNMTixVQUFBQSxJQUFJO0FBQ0osZ0JBQU0sSUFBSUcsS0FBSixDQUFVLDhEQUFWLENBQU47QUFDRDtBQUNGOztBQUVESCxNQUFBQSxJQUFJO0FBQ0osYUFBT1UsT0FBTyxDQUFDQyxPQUFSLEVBQVA7QUFDRCxLQWJEO0FBY0QsR0FmRDs7QUFpQkEsU0FBT1QsT0FBTyxDQUFDVSxJQUFSLENBQWFSLFlBQVksQ0FBQyxLQUFELENBQXpCLEVBQWtDQSxZQUFZLENBQUMsSUFBRCxDQUE5QyxDQUFQO0FBQ0QsQ0ExQkQ7O0FBNEJBLElBQUlTLFFBQVEsR0FBR2hCLGVBQWY7QUFDQUgsT0FBTyxDQUFDLFNBQUQsQ0FBUCxHQUFxQm1CLFFBQXJCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB2b2lkIDA7XG5cbnZhciBfaXNQcm9taXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiaXMtcHJvbWlzZVwiKSk7XG5cbnZhciBhc3luY1ZhbGlkYXRpb24gPSBmdW5jdGlvbiBhc3luY1ZhbGlkYXRpb24oZm4sIHN0YXJ0LCBzdG9wLCBmaWVsZCkge1xuICBzdGFydChmaWVsZCk7XG4gIHZhciBwcm9taXNlID0gZm4oKTtcblxuICBpZiAoISgwLCBfaXNQcm9taXNlW1wiZGVmYXVsdFwiXSkocHJvbWlzZSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2FzeW5jVmFsaWRhdGUgZnVuY3Rpb24gcGFzc2VkIHRvIHJlZHV4Rm9ybSBtdXN0IHJldHVybiBhIHByb21pc2UnKTtcbiAgfVxuXG4gIHZhciBoYW5kbGVFcnJvcnMgPSBmdW5jdGlvbiBoYW5kbGVFcnJvcnMocmVqZWN0ZWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGVycm9ycykge1xuICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgIGlmIChlcnJvcnMgJiYgT2JqZWN0LmtleXMoZXJyb3JzKS5sZW5ndGgpIHtcbiAgICAgICAgICBzdG9wKGVycm9ycyk7XG4gICAgICAgICAgcmV0dXJuIGVycm9ycztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdG9wKCk7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBc3luY2hyb25vdXMgdmFsaWRhdGlvbiBwcm9taXNlIHdhcyByZWplY3RlZCB3aXRob3V0IGVycm9ycy4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzdG9wKCk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfTtcbiAgfTtcblxuICByZXR1cm4gcHJvbWlzZS50aGVuKGhhbmRsZUVycm9ycyhmYWxzZSksIGhhbmRsZUVycm9ycyh0cnVlKSk7XG59O1xuXG52YXIgX2RlZmF1bHQgPSBhc3luY1ZhbGlkYXRpb247XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IF9kZWZhdWx0OyJdfQ==